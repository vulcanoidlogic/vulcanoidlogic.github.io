{"version":3,"sources":["k2-mui-core/K2FlatButton.tsx","k2-mui-core/K2AppbarButton.tsx","foundry/models/foPubSub.ts","foundry/models/foGeometry2D.ts","foundry/drivers/canvasDriver.ts","foundry/models/foTools.ts","Canvas.tsx","CanvasHook.ts","core/foRenderer.tsx","k2-core/K2Render.ts","park-theatre-page/park-theatre.render.tsx","foundry/models/foMatrix2D.ts","foundry/models/foLifecycle.ts","foundry/models/foObject.model.ts","foundry/models/foShape2D.model.ts","foundry/models/foGlyph2D.model.ts","foundry/models/foCollection.model.ts","shared/foTools.ts","foundry/models/foBuffer.ts","foundry/models/foPage.model.ts","foundry/models/foImage2D.model.ts","models/iobt-canvas-shape2D.ts","shared/model-base.ts","shared/foEnvConfig.ts","environments/environment.ts","shared/service-locator.ts","models/UDTO-message.ts","models/mapview-entity.ts","shared/K2PubSub.ts","k2-core/Toast.ts","services/topic.service.ts","shared/app-http.service.ts","services/central-model.service.ts","park-theatre-page/park-theatre-message.model.ts","assets/images/park-theatre/theatre-floor-plan.png","assets/images/air-force-logo.jpg","assets/images/army-logo.png","assets/images/marines-logo.png","assets/images/nasa-logo.png","assets/images/space-force-logo.png","assets/images/faa-logo.png","assets/images/vip-logo.png","assets/images/contractor.png","park-theatre-page/park-theatre-canvas.model.ts","k2-mui-core/K2TextButtonItem.tsx","shared/command.ts","park-theatre-page/park-theatre-command.model.ts","park-theatre-page/park-theatre.container.ts","shared/WindowResizeHook.ts","display-logos-page/display-logos.render.tsx","display-logos-page/display-logos.container.ts","layout/DefaultLayout.tsx","services/app.service.ts","index.tsx"],"names":["useStyles","makeStyles","theme","root","whiteSpace","K2FlatButton","children","fullWidth","isHidden","props","classes","Button","className","cx","K2AppbarButton","color","PubSub","registry","name","args","this","forEach","fn","apply","push","cPoint2D","x","y","myName","Vector2","p","radius","Math","abs","pt","sqrt","atan2","mag","s","cFrame","source","x1","y1","x2","y2","point","obj","min","max","ctx","fill","width","height","fillRect","rect","cMargin","left","top","right","bottom","size","Screen2D","_request","stopped","canvas","context","requestAnimation","window","requestAnimationFrame","webkitRequestAnimationFrame","cancelAnimation","cancelAnimationFrame","render","doAnimate","next","go","stop","clearRect","nativeElement","getContext","resizeRoot","lineWidth","lineCap","strokeStyle","pubMouseEvents","calculateCurrentPos","clientX","clientY","getBoundingClientRect","setValues","getMousePos","event","getKeys","e","code","keyCode","shift","shiftKey","ctrl","ctrlKey","alt","altKey","meta","metaKey","getButton","button","ownerDocument","addEventListener","keys","Pub","preventDefault","loc","touches","zoom","deltaX","detail","g","offsetX","offsetY","changedTouches","foNames","Canvas","draw","rest","canvasRef","useRef","useEffect","animationFrameId","current","setRoot","useCanvas2D","setMouseLoc","useState","undefined","forceRefresh","Sub","Date","getTime","Box","title","ref","ToJSON","JSON","stringify","EmptyRender","K2Render","Component","createElement","ParkTheatreRender","model","actionButtons","platformJSON","display","flexWrap","canvas2Params","Hidden","only","asPlatform","Tools","hasOwnProperty","Object","prototype","funct","ret","toString","substr","length","indexOf","trim","d","replace","c","r","random","floor","target","result","parse","deep","resolveReference","value","asReference","constructor","resolveCircular","key","map","item","startsWith","id","primitive","typeId","split","namespace","myNamespace","myType","low","high","b","str1","str2","toLocaleLowerCase","charAt","toUpperCase","slice","matches","AT","THIS","SELF","Array","isArray","call","isInstanceOf","str","substring","filename","string","toLowerCase","host","fullpath","path","foTools","spec","Reflect","set","getOwnPropertyDescriptor","keyMap","intersect","func","defineProperty","enumerable","configurable","get","list","m","mapOverKeyValue","mapFunc","body","forEachKeyValue","k","v","isFunction","properties","defineCalculatedProperty","ex","console","log","distinct","pluckBy","dictionary","Matrix2D","matrix","a","tx","ty","copy","a1","b1","c1","d1","tx1","append","prepend","scaleX","scaleY","rotation","skewX","skewY","regX","regY","DEG_TO_RAD","cos","sin","angle","n","invert","invertCopy","transformPoint","PI","LifecycleEventTypes","counter","foLifecycleEvent","cmd","count","object","myGuid","foLifecycleEventLock","_processLock","guid","isLocked","addLock","error","unLock","foLifecycle","debouce","mute","observable","emit","debounced","Subject","asObservable","pipe","debounceTime","subscribe","broadcast","eventName","action","params","method","Lifecycle","shape2DNames","foObject","parent","_myGuid","UNKNOWN","myParent","_isVisible","_isHitable","myClass","_displayName","override","ignore","generateUUID","short","generateName","ROOT","member","Boolean","hasAncestor","hasParent","newParent","time","setTimeout","i","overrideComputed","extendComputed","names","getOwnPropertyNames","filter","property","self","obj1","data","toJson","asJson","isEmpty","json","Audio","play","alert","foGlyph2D","opacity","isSelected","_x","_y","_width","_height","rotationZ","doubleClick","openEditor","closeEditor","drawHover","setupHoverEnterDraw","setupHoverExitDraw","setupOverlapEnterDraw","setupOverlapExitDraw","sendKeys","preDraw","postDraw","_matrix","_invMatrix","_boundry","isDragable","getOffset","getLocation","z","setLocation","localHitTest","hit","globalToLocal","hitTest","isHitable","isVisible","overlapTest","frame","globalToLocalFrame","localContains","afterRender","save","drawBoundry","restore","drawTextCircle","text","start","textAlign","textBaseline","translate","rotate","len","letterAngle","measureText","fillText","drawText","drawSelected","drawOutline","drawPin","fillStyle","smash","mtx","getGlobalMatrix","init","minmax","computeBoundry","beginPath","setLineDash","boundryFrame","stroke","mixin","Number","NaN","changed","isNaN","initialize","to","easeTween","didLocationChange","dropped","moved","offset","move","getMatrix","transform","globalAlpha","prependMatrix","appendTransform","inv","localToGlobal","pinLocation","isInvisible","updateContext","fontFamily","align","base","font","arc","moveTo","lineTo","foCollection","_members","isSelectable","addMember","find","members","removeMember","index","splice","isPublic","unshift","hasMembers","local","foShape2D","_angle","_subcomponents","pinX","pinY","drawBackground","Vector3","pin","pinVector","foSelectionBuffer","lastFound","exclude","unselect","clearAll","clear","isMember","found","findSelected","foPage","_isDirty","gridSizeX","gridSizeY","showBoundry","selections","_marginX","_marginY","_scaleX","_scaleY","mouseLoc","onItemHoverEnter","shape","onItemHoverExit","onItemChangedPosition","onMouseLocationChanged","state","drawGrid","drawAxis","drawPage","subcomponents","getMember","findObjectUnderPoint","pt1","globalToLocalPoint","zoomBy","pt2","shapeUnder","hovershape","findHitShape","moveToTop","addSelection","moveComplete","zoomToCenter","marginX","marginY","strokeText","drawName","markAsClean","foImage2D","_loaded","margin","_image","_imageURL","_background","background","drawImage","Image","onload","src","imageURL","IobtCanvasShape2D","randomInt","things","capitalizeFirstLetter","removeSpecial","removeSpaces","g1","g2","item1","item2","toISOString","getFullYear","number","round","targetLength","padStart","_","require","ModelBase","writable","dataToRetrieve","propertyName","asArray","getter","getPropertyValue","join","setter","defaultData","defaultLabel","remove","pull","labelForAdd","defaultDataForAdd","assign","isME","minReq","getEnumValues","complete","mutuallyExclusive","minRequiredSelections","EnvConfig","production","baseURL","rootAPIPath","apiVersion","localMockPath","version","envVars","services","featureflags","Environment","tag","localDebug","mesh","defaultLatLng","ServiceLocator","serviceKey","endpoint","localDataPath","localMockData","forceLocalMock","warn","longPath","url","encodeURI","Objective","UDTO_Base","sourceGuid","timeStamp","personId","ownKeys","lat1","lon1","lat2","lon2","dLat","toRad","dLon","lat1Rad","lat2Rad","ang","x0","y0","r0","r1","dx","dy","h","rx","ry","messageType","user","geometry","coordinates","BoundingBox","units","depth","pinZ","UDTO_Generic","topic","UDTO_ChatMessage","message","UDTO_Status","device","ammo","heartrate","ip_address","battery","notes","UDTO_Command","targetGuid","command","uniqueGuid","Location","lat","lng","turf","distance","bearing","steps","Units","w2","d2","line","bbox","radius1","radius2","UDTO_Position","speed","heading","UDTO_HighResPosition","xLoc","yLoc","zLoc","xAng","yAng","zAng","UDTO_Body","platformName","bodyName","position","boundingBox","UDTO_Platform","UDTO_Objective","type","note","UDTO_Observation","isTarget","range","circlePolygon","r2","cosang","toDeg","acos","brg","destination","b2","ClientHub","ChatMessage","Command","Generic","Observation","Position","Platform","Status","Body","GeolocationHelper","coords","latitude","longitude","altitude","accuracy","altitudeAccuracy","MapviewHelper","mapLayerColors","DivIcon","html","objective","evt","getLatLng","observation","platform","getScalableRectangleBBox","getScalableCircleBBox","startPoint","endPoint","getZoom","startPixelPoint","project","endPixelPoint","pxW","toFixed","pxH","fontSize","containerStyles","textStyles","iconAnchor","randomMoves","videoSpec","content","options","minWidth","maxHeight","Topic","Toast","toast","TopicService","connection","sourceGUID","lastLat","lastLng","pongSubject","subjects","Map","randomName","resetPosition","done","navigator","geolocation","getCurrentPosition","warning","deltaLat","deltaLng","getClientHubUrl","info","signalR","withUrl","withCredentials","skipNegotiation","transport","WebSockets","configureLogging","Debug","build","success","failure","establishHubConnection","then","catch","stack","onclose","has","on","MessageType","msg","getNowIsoDate","invoke","Estabish$","getBaseData","cloneCoords","sendPosition","_behaviorSubject","BehaviorSubject","DEFAULT","_subject","_subjectPayload","ids","payload","payloadHandler","successResponse","res","response","AppHttpService","mapToModel","status","warningMessage","request","of","errorResponse","mapErrorResponse","dateTime","hasError","payloadType","metadata","serviceOptions","additionalHeaders","subject","getAPIUrl","headers","AppHttpServiceClass","makeHeaders","ajax","post","switchMap","ajaxRes","catchError","first","aValue","encodeURIComponent","getUrl","put","responce","get$","getAnySuccess","contentType","CentralModelService","http","sharedModel","personModel","refreshedModel","isDisplayChatToast","tService","summary","addPropertyToTarget","currentGuid","observations","establishObservation","establishPlatform","objectives","establishSource","establishObjective","sources","addToSource","objKey","objValue","addObjective","addObservation","RECEIVED_COP_UPDATE","doStart","Pong$","receivePing","Generic$","receiveGeneric","ChatMessage$","receiveChatMessage","Position$","receivePosition","Objective$","receiveObjective","Observation$","receiveObservation","Platform$","receivePlatform","Body$","receiveBody","Status$","receiveStatus","Command$","receiveCommand","processCommand","broadcastToLateObservers","SIGNAL_R_CONNECTION_ESTABLISHED","register","SIGNAL_R_CONNECTION_UNAVAILABLE","doStop","sendStatus","unregisterSource","sendCommand","keepObjectives","POSSIBLE_TARGET","removeSource","removeObjective","removeObservation","RECEIVED_ZOOM_IN_COMMAND","RECEIVED_ZOOM_OUT_COMMAND","RECEIVED_HIDE_MAP_COMMAND","RECEIVED_SHOW_MAP_COMMAND","getAny$","processAllSourceData","doPing","addProperty","doPingPong","sendGeneric","sendChatMessageMesh","broadcastPayload","RECEIVED_CHAT_MESSAGE","sendObjective","sendObservation","sendPlatform","addPlatform","sendBody","retrievePlatform","establishBody","sort","obs1","j","obs2","computeObjective","objName","asLat","asLng","obj2","pts","intersection","p1","createPossableTarget","movePosition","ParkTheatreMessage","Logo","imagePath","scale","parentPinX","parentPinY","bBox","hiresPos","scaleStageHorizontally","scaleStageVertically","IobtCanvasImage2D","AirForce","airForceLogoImg","Army","armyLogoImg","Navy","Marines","marinesLogoImg","NASA","nasaLogoImg","SpaceForce","spaceForceLogoImg","FAA","faaLogoImg","VIP","vipLogoImg","Contractor","contractorLogoImg","ParkTheatreCanvasPage","messageHandler","stageImageURL","stageImg","stageImageWidth","stageImageHeight","logoTypes","logos","theatreWidth","theatreHeight","theatreDepth","subHandle","drawHighlight","setName","setupMouseEvents","setEventSubscriptions","canvasLifecycleEvent","logo","asBody","K2PubSub","sendPlatformMessage","isIncludeBodies","values","finalize","getAvailableScreenWidth","stageImageScale","stage","createLogos","dropAt","createStyles","iconButton","border","padding","spacing","borderRadius","cursor","alignItems","buttonWithLabel","typography","backgroundColor","indigo","paddingRight","palette","common","white","disabledIconButton","K2TextButtonItemComponents","default","forwardRef","option","useTheme","MuiIcon","director","muiIcon","FaIcon","faIcon","label","clsx","onClick","icon","ml","tooltip","Tooltip","arrow","placement","disabled","stopPropagation","CommandItem","execute","DialogPageCommand","pathname","dialogProps","onOk","onCancel","DISPLAY_OVERLAY_PAGE","ok","cancel","SynchronousCommand","ASynchronousCommand","TimeoutCommand","delayMs","CommandListDirector","isLog","commands","iterator","getRender","existsWhenFunc","add","yieldValue","conditionalRender","addTimeout","actionDirector","propertyValue","Error","coroutine","endVal","return","ParkTheatreCommand","page","maxAllowedLogoCount","currentLogoCount","getInstance","renderRule","componentsContainer","addSync","dropLogo","commandListDirectors","itemComponents","generateOptions","directors","directDropLogo","generateTextButtonActions","ParkTheatre","windowSize","innerWidth","innerHeight","setWindowSize","handleResize","removeEventListener","useWindowSize","setRefreshMs","Render","useMemo","getTextButtons","sendPing","breakpoints","containerMaxWidthBreakpoint","pubSub$","DisplayLogosRender","cService","DisplayLogos","menuButton","marginRight","flexGrow","marginTop","paddingLeft","DefaultLayout","AppBar","Toolbar","variant","Typography","Container","maxWidth","AppService","localSubject","health","unsubscribe","config","configDevelopment","configProduction","createMuiTheme","loadConfiguration$","ReactDOM","CssBaseline","autoClose","ThemeProvider","document","getElementById"],"mappings":"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","file":"static/js/main.bb4b68dd.chunk.js","sourcesContent":["import { Fragment, FunctionComponent, ReactElement } from 'react';\r\nimport { Button, ButtonProps } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport cx from 'classnames';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        whiteSpace: 'nowrap'\r\n    }\r\n}));\r\n\r\ninterface K2FlatButtonExtendedProps {\r\n    isHidden?: boolean;\r\n}\r\n\r\nexport type K2FlatButtonProps = K2FlatButtonExtendedProps & ButtonProps;\r\n\r\nexport const K2FlatButton: FunctionComponent<K2FlatButtonProps> = ({ children, fullWidth = false, isHidden = false, ...props }): ReactElement => {\r\n    const classes = useStyles();\r\n    if (isHidden) {\r\n        return <Fragment />;\r\n    } else {\r\n        return (\r\n            <Button {...props} fullWidth={fullWidth} className={cx(classes.root, props.className)}>\r\n                {children}\r\n            </Button>\r\n        );\r\n    }\r\n};\r\n","import { FunctionComponent, ReactElement } from 'react';\r\nimport { K2FlatButton, K2FlatButtonProps } from './K2FlatButton';\r\n\r\nexport const K2AppbarButton: FunctionComponent<K2FlatButtonProps> = (props): ReactElement => {\r\n    return <K2FlatButton {...props} color=\"inherit\" />;\r\n};\r\n","export type ISubscription = (...args: any[]) => void;\r\n\r\nexport interface IDictionary {\r\n    [name: string]: ISubscription[];\r\n}\r\n\r\nexport class foPubSub {\r\n    private registry: IDictionary = {};\r\n\r\n    Pub(name: string, ...args: any[]) {\r\n        if (!this.registry[name]) {\r\n            return;\r\n        }\r\n        this.registry[name].forEach((fn) => {\r\n            fn.apply(null, args);\r\n        });\r\n        return this;\r\n    }\r\n\r\n    Sub(name: string, fn: ISubscription) {\r\n        if (!this.registry[name]) {\r\n            this.registry[name] = [];\r\n        }\r\n        this.registry[name].push(fn);\r\n        return this;\r\n    }\r\n\r\n    Unsub(name: string, fn: ISubscription) {\r\n        if (this.registry[name]) {\r\n            delete this.registry[name];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    Clear() {\r\n        this.registry = {};\r\n        return this;\r\n    }\r\n}\r\n\r\nexport let PubSub: foPubSub = new foPubSub();\r\n","import { iPoint2D, iRect, iBox, iMargin, iFrame } from './foInterface';\r\nimport { Vector2 } from 'three';\r\nexport { Vector2, Matrix3 } from 'three';\r\n\r\nexport class cPoint2D extends Vector2 implements iPoint2D {\r\n    public myName: string;\r\n    public x: number;\r\n    public y: number;\r\n\r\n    constructor(x: number = 0, y: number = 0, name?: string) {\r\n        super(x, y);\r\n        this.myName = name || '';\r\n    }\r\n\r\n    asVector(): Vector2 {\r\n        return new Vector2(this.x, this.y);\r\n    }\r\n\r\n    setValues(x: number = 0, y: number = 0) {\r\n        this.x = x;\r\n        this.y = y;\r\n        return this;\r\n    }\r\n\r\n    clonePoint(): cPoint2D {\r\n        return new cPoint2D(this.x, this.y, this.myName);\r\n    }\r\n\r\n    isEqualTo(p: cPoint2D): boolean {\r\n        return this.x === p.x && this.y === p.y;\r\n    }\r\n\r\n    isNear(p: cPoint2D, radius: number): boolean {\r\n        const dx = Math.abs(p.x - this.x);\r\n        if (dx > radius) {\r\n            return false;\r\n        }\r\n\r\n        const dy = Math.abs(p.y - this.y);\r\n        if (dy > radius) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    addPoint(x: number = 0, y: number = 0): cPoint2D {\r\n        this.x += x;\r\n        this.y += y;\r\n        return this;\r\n    }\r\n\r\n    subtractPoint(x: number = 0, y: number = 0): cPoint2D {\r\n        this.x -= x;\r\n        this.y -= y;\r\n        return this;\r\n    }\r\n\r\n    midPoint(pt: cPoint2D): cPoint2D {\r\n        const x = (this.x + pt.x) / 2;\r\n        const y = (this.y + pt.y) / 2;\r\n        return new cPoint2D(x, y, 'midpoint');\r\n    }\r\n\r\n    mag(): number {\r\n        return Math.sqrt(this.x * this.x + this.y * this.y);\r\n    }\r\n\r\n    atan(): number {\r\n        return Math.atan2(this.y, this.x);\r\n    }\r\n\r\n    normal(): cPoint2D {\r\n        let mag = this.mag();\r\n        mag = mag ? mag : 1.0; //if zero set to 1 you get the same result\r\n        return new cPoint2D(this.x / mag, this.y / mag, 'normal');\r\n    }\r\n\r\n    sum(p: cPoint2D): cPoint2D {\r\n        this.x += p.x;\r\n        this.y += p.y;\r\n        return this;\r\n    }\r\n\r\n    sumTo(p: cPoint2D): cPoint2D {\r\n        p.x += this.x;\r\n        p.y += this.y;\r\n        return p;\r\n    }\r\n\r\n    setTo(p: cPoint2D): cPoint2D {\r\n        p.x = this.x;\r\n        p.y = this.y;\r\n        return p;\r\n    }\r\n\r\n    subtract(p: cPoint2D): cPoint2D {\r\n        this.x -= p.x;\r\n        this.y -= p.y;\r\n        return this;\r\n    }\r\n\r\n    deltaBetween(pt: cPoint2D): cPoint2D {\r\n        const x = this.x - pt.x;\r\n        const y = this.y - pt.y;\r\n        return new cPoint2D(x, y, 'delta');\r\n    }\r\n\r\n    scale(s: number): cPoint2D {\r\n        this.x *= s;\r\n        this.y *= s;\r\n        return this;\r\n    }\r\n}\r\n\r\nexport class cRect implements iRect {\r\n    public x: number;\r\n    public y: number;\r\n    public width: number;\r\n    public height: number;\r\n    public myName: string;\r\n\r\n    constructor(x: number, y: number, width: number, height: number, name?: string) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.myName = name || '';\r\n    }\r\n\r\n    moveBy(x: number = 0, y: number = 0): iRect {\r\n        this.x += x;\r\n        this.y += y;\r\n        return this;\r\n    }\r\n\r\n    moveTo(x: number = 0, y: number = 0): iRect {\r\n        this.x = x;\r\n        this.y = y;\r\n        return this;\r\n    }\r\n\r\n    sizeBy(width: number, height: number): iRect {\r\n        this.width += width;\r\n        this.height += height;\r\n        return this;\r\n    }\r\n\r\n    sizeTo(width: number, height: number): iRect {\r\n        this.width = width;\r\n        this.height = height;\r\n        return this;\r\n    }\r\n\r\n    set(x: number, y: number, width: number, height: number): iRect {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.height = height;\r\n        return this;\r\n    }\r\n\r\n    contains(x: number, y: number) {\r\n        return this.x <= x && x <= this.x + this.width && this.y <= y && y <= this.y + this.height;\r\n    }\r\n\r\n    localContains(x: number, y: number): boolean {\r\n        return 0 <= x && x <= this.width && 0 <= y && y <= this.height;\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, fill?: boolean) {\r\n        if (fill) {\r\n            ctx.fillRect(this.x, this.y, this.width, this.height);\r\n        } else {\r\n            ctx.rect(this.x, this.y, this.width, this.height);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n\r\nexport class cFrame implements iFrame {\r\n    public x1: number;\r\n    public y1: number;\r\n    public x2: number;\r\n    public y2: number;\r\n\r\n    public point: cPoint2D = new cPoint2D();\r\n    public source: any;\r\n\r\n    constructor(source?: any) {\r\n        this.source = source;\r\n    }\r\n\r\n    set(x1: number, y1: number, x2: number, y2: number): iFrame {\r\n        this.x1 = x1;\r\n        this.y1 = y1;\r\n        this.x2 = x2;\r\n        this.y2 = y2;\r\n        return this;\r\n    }\r\n\r\n    width(): number {\r\n        return this.x2 - this.x1;\r\n    }\r\n\r\n    heigth(): number {\r\n        return this.y2 - this.y1;\r\n    }\r\n\r\n    centerX(): number {\r\n        return (this.x2 + this.x1) / 2.0;\r\n    }\r\n\r\n    centerY(): number {\r\n        return (this.y2 + this.y1) / 2.0;\r\n    }\r\n\r\n    init(obj: iPoint2D): iFrame {\r\n        this.x1 = obj.x;\r\n        this.y1 = obj.y;\r\n        this.x2 = obj.x;\r\n        this.y2 = obj.y;\r\n        return this;\r\n    }\r\n\r\n    merge(obj: iFrame): iFrame {\r\n        this.x1 = Math.min(this.x1, obj.x1, obj.x2);\r\n        this.y1 = Math.min(this.y1, obj.y1, obj.y2);\r\n        this.x2 = Math.max(this.x2, obj.x2, obj.x1);\r\n        this.y2 = Math.max(this.y2, obj.y2, obj.y1);\r\n        return this;\r\n    }\r\n\r\n    minmax(obj: iPoint2D): iFrame {\r\n        this.x1 = Math.min(this.x1, obj.x);\r\n        this.y1 = Math.min(this.y1, obj.y);\r\n        this.x2 = Math.max(this.x2, obj.x);\r\n        this.y2 = Math.max(this.y2, obj.y);\r\n        return this;\r\n    }\r\n\r\n    contains(x: number, y: number) {\r\n        return this.x1 <= x && x <= this.x2 && this.y1 <= y && y <= this.y2;\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D, fill?: boolean) {\r\n        const width = this.x2 - this.x1;\r\n        const height = this.y2 - this.y1;\r\n        if (fill) {\r\n            ctx.fillRect(this.x1, this.y1, width, height);\r\n        } else {\r\n            ctx.rect(this.x1, this.y1, width, height);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n\r\nexport class cMargin implements iMargin {\r\n    public left: number = 0;\r\n    public top: number = 0;\r\n    public right: number = 0;\r\n    public bottom: number = 0;\r\n\r\n    constructor(left: number = 0, top: number = 0, right: number = 0, bottom: number = 0) {\r\n        this.left = left;\r\n        this.top = top;\r\n        this.right = right;\r\n        this.bottom = bottom;\r\n    }\r\n\r\n    setAll(size: number = 0) {\r\n        this.left = size;\r\n        this.top = size;\r\n        this.right = size;\r\n        this.bottom = size;\r\n        return this;\r\n    }\r\n\r\n    get width() {\r\n        return this.left + this.right;\r\n    }\r\n    get height() {\r\n        return this.top + this.bottom;\r\n    }\r\n}\r\n\r\nexport class cBox extends cRect implements iBox {\r\n    // constructor(x: number, y: number, width: number, height: number, name?: string) {\r\n    //     super(x, y, width, height, name);\r\n    // }\r\n\r\n    pinX(): number {\r\n        return 0 * this.width;\r\n    }\r\n\r\n    pinY(): number {\r\n        return 0 * this.height;\r\n    }\r\n\r\n    // draw(ctx: CanvasRenderingContext2D, fill?: boolean) {\r\n    //     if (fill) {\r\n    //         ctx.fillRect(this.x, this.y, this.width, this.height);\r\n    //     } else {\r\n    //         ctx.rect(this.x, this.y, this.width, this.height);\r\n    //     }\r\n    //     return this;\r\n    // }\r\n}\r\n","import { PubSub } from '../models/foPubSub';\r\nimport { cPoint2D } from '../models/foGeometry2D';\r\n\r\nexport class Screen2D {\r\n    private _request: any;\r\n    private stopped: boolean = true;\r\n    canvas: HTMLCanvasElement;\r\n    context: CanvasRenderingContext2D;\r\n\r\n    //https://developer.mozilla.org/en-US/docs/Web/API/Window/cancelAnimationFrame\r\n    requestAnimation = window.requestAnimationFrame || window.webkitRequestAnimationFrame;\r\n    cancelAnimation = window.cancelAnimationFrame; // || window.mozCancelAnimationFrame;\r\n\r\n    render: (context: CanvasRenderingContext2D) => void;\r\n\r\n    public doAnimate = (): void => {\r\n        this.render(this.context);\r\n        this._request = this.requestAnimation(this.doAnimate);\r\n    };\r\n\r\n    go(next?: () => {}) {\r\n        this.stopped = false;\r\n        this.doAnimate();\r\n        next && next();\r\n    }\r\n\r\n    stop(next?: () => {}) {\r\n        this.stopped = true;\r\n        this.cancelAnimation(this._request);\r\n        next && next();\r\n    }\r\n\r\n    toggleOnOff(): boolean {\r\n        this.stopped ? this.go() : this.stop();\r\n        return this.stopped;\r\n    }\r\n\r\n    clear() {\r\n        this.context && this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n    resizeRoot(width: number, height: number): HTMLCanvasElement {\r\n        // set the width and height\r\n        if (this.canvas) {\r\n            this.canvas.width = width;\r\n            this.canvas.height = height;\r\n        }\r\n        return this.canvas;\r\n    }\r\n\r\n    setRoot(nativeElement: HTMLCanvasElement, width: number, height: number) {\r\n        this.canvas = nativeElement;\r\n        this.context = this.canvas.getContext('2d');\r\n\r\n        // set the width and height\r\n        this.resizeRoot(width, height);\r\n\r\n        // set some default properties about the line\r\n        this.context.lineWidth = 1;\r\n        this.context.lineCap = 'round';\r\n        this.context.strokeStyle = '#000';\r\n\r\n        this.pubMouseEvents(this.canvas);\r\n    }\r\n\r\n    pubMouseEvents(canvas: HTMLCanvasElement) {\r\n        let pt = new cPoint2D();\r\n\r\n        function calculateCurrentPos(clientX: number, clientY: number) {\r\n            let rect = canvas.getBoundingClientRect();\r\n            let x = rect.left;\r\n            let y = rect.top;\r\n            return pt.setValues(clientX - x, clientY - y);\r\n        }\r\n\r\n        function getMousePos(event: MouseEvent): cPoint2D {\r\n            let rect = canvas.getBoundingClientRect();\r\n            let x = rect.left; // + 0.0 * window.scrollX;  scroll is not necessary\r\n            let y = rect.top; // + 0.0 * window.scrollY;\r\n            return pt.setValues(event.clientX - x, event.clientY - y);\r\n        }\r\n\r\n        function getKeys(e: KeyboardEvent) {\r\n            let keys = {\r\n                code: e.keyCode,\r\n                shift: e.shiftKey,\r\n                ctrl: e.ctrlKey,\r\n                alt: e.altKey,\r\n                meta: e.metaKey\r\n            };\r\n            return keys;\r\n        }\r\n        canvas.ownerDocument.addEventListener('keypress', (e: KeyboardEvent) => {\r\n            //e.preventDefault();\r\n            let keys = getKeys(e);\r\n            PubSub.Pub('onkeypress', e, keys);\r\n        });\r\n\r\n        canvas.ownerDocument.addEventListener('keydown', (e: KeyboardEvent) => {\r\n            //e.preventDefault();\r\n            let keys = getKeys(e);\r\n            PubSub.Pub('onkeydown', e, keys);\r\n        });\r\n\r\n        canvas.ownerDocument.addEventListener('keyup', (e: KeyboardEvent) => {\r\n            //e.preventDefault();\r\n            let keys = getKeys(e);\r\n            PubSub.Pub('onkeyup', e, keys);\r\n        });\r\n\r\n        function getButton(e: MouseEvent) {\r\n            let keys = {\r\n                shift: e.shiftKey,\r\n                ctrl: e.ctrlKey,\r\n                alt: e.altKey,\r\n                button: e.button\r\n            };\r\n            return keys;\r\n        }\r\n\r\n        canvas.addEventListener('mousedown', (e: MouseEvent) => {\r\n            e.preventDefault();\r\n            const loc = getMousePos(e);\r\n            const keys = getButton(e);\r\n            PubSub.Pub('mousedown', loc, e, keys);\r\n        });\r\n\r\n        canvas.addEventListener('touchstart', (e: TouchEvent) => {\r\n            e.preventDefault();\r\n            const loc = calculateCurrentPos(e.touches[0].clientX, e.touches[0].clientY);\r\n            PubSub.Pub('mousedown', loc, e, {});\r\n        });\r\n\r\n        canvas.addEventListener('mousemove', (e: MouseEvent) => {\r\n            e.preventDefault();\r\n            const loc = getMousePos(e);\r\n            const keys = getButton(e);\r\n            PubSub.Pub('mousemove', loc, e, keys);\r\n        });\r\n\r\n        canvas.addEventListener('touchmove', (e: TouchEvent) => {\r\n            e.preventDefault();\r\n            const loc = calculateCurrentPos(e.touches[0].clientX, e.touches[0].clientY);\r\n            PubSub.Pub('mousemove', loc, e, {});\r\n        });\r\n\r\n        canvas.addEventListener('wheel', (e: WheelEvent) => {\r\n            e.preventDefault();\r\n            let loc = getMousePos(e);\r\n            let keys = getButton(e);\r\n\r\n            let scale = 1.1;\r\n            let zoom = Math.max(-1, Math.min(1, e.deltaX || -e.detail)) > 0 ? scale : 1 / scale;\r\n\r\n            let g = new cPoint2D(e.offsetX, e.offsetY);\r\n\r\n            PubSub.Pub('wheel', loc, g, zoom, e, keys);\r\n        });\r\n\r\n        canvas.addEventListener('dblclick', (e: MouseEvent) => {\r\n            e.preventDefault();\r\n            let loc = getMousePos(e);\r\n            let keys = getButton(e);\r\n            PubSub.Pub('dblclick', loc, e, keys);\r\n        });\r\n\r\n        canvas.addEventListener('click', (e: MouseEvent) => {\r\n            e.preventDefault();\r\n            let loc = getMousePos(e);\r\n            let keys = getButton(e);\r\n            PubSub.Pub('click', loc, e, keys);\r\n        });\r\n\r\n        canvas.addEventListener('mouseup', (e: MouseEvent) => {\r\n            e.preventDefault();\r\n            const loc = getMousePos(e);\r\n            const keys = getButton(e);\r\n            PubSub.Pub('mouseup', loc, e, keys);\r\n        });\r\n\r\n        canvas.addEventListener('touchend', (e: TouchEvent) => {\r\n            e.preventDefault();\r\n            const loc = calculateCurrentPos(e.changedTouches[0].clientX, e.changedTouches[0].clientY);\r\n            PubSub.Pub('mouseup', loc, e, {});\r\n        });\r\n\r\n        canvas.addEventListener('mouseover', (e: MouseEvent) => {\r\n            e.preventDefault();\r\n            let loc = getMousePos(e);\r\n            let keys = getButton(e);\r\n            PubSub.Pub('mouseover', loc, e, keys);\r\n        });\r\n\r\n        canvas.addEventListener('mouseout', (e: MouseEvent) => {\r\n            e.preventDefault();\r\n            let loc = getMousePos(e);\r\n            let keys = getButton(e);\r\n            PubSub.Pub('mouseout', loc, e, keys);\r\n        });\r\n    }\r\n}\r\n","export enum foNames {\r\n    UNKNOWN = 'unknown',\r\n    AT = '@',\r\n    THIS = 'this',\r\n    SELF = 'self',\r\n    ROOT = 'root'\r\n}\r\n\r\n// Converts numeric degrees to radians\r\n// if (typeof (Number.prototype.toRad) === \"undefined\") {\r\n//     Number.prototype.toRad = function () {\r\n//         return this * Math.PI / 180;\r\n//     }\r\n// }\r\n// if (typeof (Number.prototype.toDeg) === \"undefined\") {\r\n//     Number.prototype.toDeg = function () {\r\n//         return this * 180 / Math.PI;\r\n//     }\r\n// }\r\n\r\nexport class foTools {\r\n    // Speed up calls to hasOwnProperty\r\n    private hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\r\n    //constructor() {}\r\n\r\n    /**\r\n     * http://stackoverflow.com/questions/6588977/how-to-to-extract-a-javascript-function-from-a-javascript-file\r\n     * @param funct\r\n     */\r\n    getFunctionName(funct: Function) {\r\n        let ret = funct.toString(); //do with regx\r\n        ret = ret.substr('function '.length);\r\n        ret = ret.substr(0, ret.indexOf('('));\r\n        return ret.trim();\r\n    }\r\n\r\n    //http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript\r\n    generateUUID() {\r\n        let d = new Date().getTime();\r\n        const uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n            // tslint:disable-next-line:no-bitwise\r\n            const r = (d + Math.random() * 16) % 16 | 0;\r\n            d = Math.floor(d / 16);\r\n            // tslint:disable-next-line:no-bitwise\r\n            return (c === 'x' ? r : (r & 0x7) | 0x8).toString(16);\r\n        });\r\n        return uuid;\r\n    }\r\n\r\n    asJson(target: any) {\r\n        const result = this.stringify(target);\r\n        return JSON.parse(result);\r\n    }\r\n\r\n    stringify(target: any, func: any = undefined, deep = 3) {\r\n        function resolveReference(value: any) {\r\n            if (value && value.asReference) {\r\n                return 'resolveRef(' + value.asReference() + ',' + value.constructor.name + ')';\r\n            }\r\n            return value;\r\n        }\r\n        function resolveCircular(key: string, value: any) {\r\n            switch (key) {\r\n                case 'myParent':\r\n                    return resolveReference(value);\r\n                case 'myMembers':\r\n                    return value\r\n                        ? value.map(function (item: any) {\r\n                              return resolveReference(item);\r\n                          })\r\n                        : value;\r\n                case '_subcomponents':\r\n                    return value;\r\n                case '_lookup':\r\n                    return value;\r\n                case '_members':\r\n                    return value;\r\n            }\r\n            if (key.startsWith('_')) {\r\n                return;\r\n            }\r\n            //if (this.isCustomLinkName(key)) {\r\n            //    return resolveReference(value);\r\n            //}\r\n\r\n            return value;\r\n        }\r\n\r\n        return JSON.stringify(target, resolveCircular, deep);\r\n    }\r\n\r\n    splitNamespaceType(id: string, primitive?: string) {\r\n        const typeId = id.split('::');\r\n        let result = { namespace: '', name: id };\r\n        if (typeId.length === 2) {\r\n            result = {\r\n                namespace: typeId[0],\r\n                name: typeId[1]\r\n            };\r\n        } else if (primitive) {\r\n            result = {\r\n                namespace: typeId[0],\r\n                name: primitive\r\n            };\r\n        }\r\n        return result;\r\n    }\r\n\r\n    getNamespace(obj: any) {\r\n        let myNamespace = obj.myType ? obj.myType.split('::') : [''];\r\n        myNamespace = myNamespace[0];\r\n        return myNamespace;\r\n    }\r\n\r\n    getType(obj: any): string {\r\n        let myType = obj.myType ? obj.myType.split('::') : [''];\r\n        myType = myType.length === 2 ? myType[1] : myType[0];\r\n        return myType;\r\n    }\r\n\r\n    namespace(namespace: string, name: string) {\r\n        return `${namespace}::${name}`;\r\n    }\r\n\r\n    randomInt(low: number, high: number) {\r\n        return low + Math.floor(Math.random() * (high - low + 1));\r\n    }\r\n\r\n    random(low: number, high: number) {\r\n        return low + Math.random() * (high - low);\r\n    }\r\n\r\n    randomRGBColor() {\r\n        // tslint:disable-next-line:no-bitwise\r\n        const r = (255 * Math.random()) | 0;\r\n        // tslint:disable-next-line:no-bitwise\r\n        const g = (255 * Math.random()) | 0;\r\n        // tslint:disable-next-line:no-bitwise\r\n        const b = (255 * Math.random()) | 0;\r\n        return `rgb(${r},${g},${b})`;\r\n    }\r\n\r\n    matches(str1: string, str2: string) {\r\n        if (str1 === str2) {\r\n            return true;\r\n        }\r\n        return str1 && str2 && str1.toLocaleLowerCase() === str2.toLocaleLowerCase();\r\n    }\r\n\r\n    startsWith(str1: string, str2: string) {\r\n        if (str1 === str2) {\r\n            return true;\r\n        }\r\n        return str1 && str2 && str1.toLocaleLowerCase().startsWith(str2.toLocaleLowerCase());\r\n    }\r\n\r\n    capitalizeFirstLetter(str1: string) {\r\n        return str1.charAt(0).toUpperCase() + str1.slice(1);\r\n    }\r\n\r\n    isSelf(ref: any) {\r\n        return this.matches(ref, foNames.AT) || this.matches(ref, foNames.THIS) || this.matches(ref, foNames.SELF);\r\n    }\r\n\r\n    isArray(obj: any) {\r\n        if (Array.isArray) {\r\n            return Array.isArray(obj);\r\n        }\r\n        return Object.prototype.toString.call(obj) === '[object Array]' ? true : false;\r\n    }\r\n\r\n    isFunction(obj: any) {\r\n        return typeof obj === 'function';\r\n    }\r\n\r\n    isString(obj: any) {\r\n        return typeof obj === 'string';\r\n    }\r\n\r\n    isNumber(obj: any) {\r\n        return typeof obj === 'number';\r\n    }\r\n\r\n    isDate(obj: any) {\r\n        return obj instanceof Date;\r\n    }\r\n\r\n    isObject(obj: any) {\r\n        return obj && typeof obj === 'object'; //prevents typeOf null === 'object'\r\n    }\r\n\r\n    isCustomLinkName(key: any) {\r\n        return false;\r\n    }\r\n\r\n    isTyped(obj: any) {\r\n        return obj && obj.isInstanceOf;\r\n    }\r\n\r\n    isEmpty(obj: any) {\r\n        // null and undefined are \"empty\"\r\n        if (obj == null) {\r\n            return true;\r\n        }\r\n\r\n        // Assume if it has a length property with a non-zero value\r\n        // that that property is correct.\r\n        if (obj.length > 0) {\r\n            return false;\r\n        }\r\n        if (obj.length === 0) {\r\n            return true;\r\n        }\r\n\r\n        // If it isn't an object at this point\r\n        // it is empty, but it can't be anything *but* empty\r\n        // Is it empty?  Depends on your application.\r\n        if (typeof obj !== 'object') {\r\n            return true;\r\n        }\r\n\r\n        // Otherwise, does it have any properties of its own?\r\n        // Note that this doesn't handle\r\n        // toString and valueOf enumeration bugs in IE < 9\r\n        // tslint:disable-next-line:prefer-const\r\n        for (let key in obj) {\r\n            if (this.hasOwnProperty.call(obj, key)) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    removeDQ(str: string): string {\r\n        return str.replace(/^\"(.*)\"$/, '$1');\r\n    }\r\n\r\n    unwrap(str: string): string {\r\n        return str.substring(1, str.length - 1);\r\n    }\r\n\r\n    wrapDQ(str: string): string {\r\n        return `\"${str}\"`;\r\n    }\r\n\r\n    wrapSQ(str: string): string {\r\n        return `'${str}'`;\r\n    }\r\n\r\n    decomposeHostPath(filename: string) {\r\n        let string = filename.toLowerCase();\r\n        string = string.replace('http://', '');\r\n        string = string.replace('https://', '');\r\n\r\n        const host = string.split('/')[0];\r\n        const path = string.replace(host, '');\r\n        return {\r\n            fullpath: filename,\r\n            host: host,\r\n            path: path\r\n        };\r\n    }\r\n\r\n    extend(target: any, source: any) {\r\n        if (!source) {\r\n            return target;\r\n        }\r\n        // tslint:disable-next-line:prefer-const\r\n        for (let key in source) {\r\n            if (this.hasOwnProperty.call(source, key)) {\r\n                target[key] = source[key];\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n\r\n    mixin(target: any, source: any) {\r\n        if (!source) {\r\n            return target;\r\n        }\r\n        if (!target) {\r\n            return source;\r\n        }\r\n\r\n        for (const key of source) {\r\n            target[key] = source[key];\r\n        }\r\n        return target;\r\n    }\r\n\r\n    mixExact(target: any, source: any) {\r\n        if (!source) {\r\n            return target;\r\n        }\r\n        if (!target) {\r\n            return source;\r\n        }\r\n        for (const key in source) {\r\n            if (foTools.hasOwnProperty.call(target, key)) {\r\n                target[key] = source[key];\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n\r\n    mixout(target: any, source: any) {\r\n        if (!source) {\r\n            return target;\r\n        }\r\n        if (!target) {\r\n            return source;\r\n        }\r\n        for (const key in source) {\r\n            if (this.hasOwnProperty.call(target, key)) {\r\n                delete target[key];\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n\r\n    extract(target: any, keys?: string[]) {\r\n        const spec = {};\r\n        keys &&\r\n            keys.forEach((key) => {\r\n                Reflect.set(spec, key, Reflect.getOwnPropertyDescriptor(target, key).value);\r\n                // spec[key] = target[key];\r\n            });\r\n        return spec;\r\n    }\r\n\r\n    mixMap(target: any, source: any) {\r\n        if (!source) {\r\n            return target;\r\n        }\r\n\r\n        let result = {};\r\n        for (let key in target) {\r\n            const keyMap = source[key] || key;\r\n            Reflect.set(result, keyMap, Reflect.getOwnPropertyDescriptor(target, key).value);\r\n            // result[keyMap] = target[key];\r\n        }\r\n        return result;\r\n    }\r\n\r\n    intersect(target: any, source: any) {\r\n        if (!source) {\r\n            return target;\r\n        }\r\n        if (!target) {\r\n            return source;\r\n        }\r\n        const intersect = {};\r\n        for (const key in target) {\r\n            if (this.hasOwnProperty.call(source, key)) {\r\n                Reflect.set(intersect, key, Reflect.getOwnPropertyDescriptor(source, key).value);\r\n                // intersect[key] = source[key];\r\n            } else {\r\n                Reflect.set(intersect, key, Reflect.getOwnPropertyDescriptor(target, key).value);\r\n                // intersect[key] = target[key];\r\n            }\r\n        }\r\n        return intersect;\r\n    }\r\n\r\n    union(target: any, source: any) {\r\n        const result = {};\r\n        if (target) {\r\n            for (let key in target) {\r\n                Reflect.set(result, key, Reflect.getOwnPropertyDescriptor(target, key).value);\r\n                // result[key] = target[key];\r\n            }\r\n        }\r\n        if (source) {\r\n            for (let key in source) {\r\n                Reflect.set(result, key, Reflect.getOwnPropertyDescriptor(source, key).value);\r\n                // result[key] = source[key];\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    defineComputeOnlyProperty(target: any, name: string, func: () => any) {\r\n        //var self = target;\r\n        Object.defineProperty(target, name, {\r\n            enumerable: true,\r\n            configurable: true,\r\n            get: func\r\n        });\r\n        return target;\r\n    }\r\n\r\n    defineCalculatedProperty(target: any, name: string, func: () => any) {\r\n        //var self = target;\r\n        Object.defineProperty(target, name, {\r\n            enumerable: true,\r\n            configurable: true,\r\n            get: func, //.call(self, self),\r\n            set: function (value) {\r\n                this[`_${name}`] = value;\r\n            }\r\n        });\r\n        return target;\r\n    }\r\n\r\n    getMethods(obj: any) {\r\n        const list = [];\r\n        for (const m in obj.prototype) {\r\n            if (typeof obj[m] === 'function') {\r\n                list.push(m);\r\n            }\r\n        }\r\n        return list;\r\n    }\r\n\r\n    asArray(obj: any, funct?: (key: string, value: any) => any) {\r\n        if (this.isArray(obj)) {\r\n            return obj;\r\n        }\r\n        return this.mapOverKeyValue(obj, function (key: string, value: any) {\r\n            return funct ? funct(key, value) : value;\r\n        });\r\n    }\r\n\r\n    applyOverKeyValue(obj: any, mapFunc: (key: string, value: any) => any) {\r\n        //funct has 2 args.. key,value\r\n        const body = {};\r\n        const keys = obj ? Object.keys(obj) : [];\r\n        keys.forEach((key) => {\r\n            if (this.hasOwnProperty.call(obj, key)) {\r\n                const value = obj[key];\r\n                const result = mapFunc(key, value);\r\n                if (result) {\r\n                    Reflect.set(body, key, result);\r\n                    // body[key] = result;\r\n                }\r\n            }\r\n        });\r\n        return body;\r\n    }\r\n\r\n    mapOverKeyValue(obj: any, mapFunc: (key: string, value: any) => any) {\r\n        //funct has 2 args.. key,value\r\n        const list: any[] = [];\r\n        const keys = obj ? Object.keys(obj) : [];\r\n        keys.forEach((key) => {\r\n            if (this.hasOwnProperty.call(obj, key)) {\r\n                const value = obj[key];\r\n                const result = mapFunc(key, value);\r\n                if (result) {\r\n                    list.push(result);\r\n                }\r\n            }\r\n        });\r\n        return list;\r\n    }\r\n\r\n    forEachKeyValue(obj: any, mapFunc: (key: string, value: any) => any) {\r\n        //funct has 2 args.. key,value\r\n        const keys = obj ? Object.keys(obj) : [];\r\n        keys.forEach((key) => {\r\n            if (this.hasOwnProperty.call(obj, key)) {\r\n                const value = obj[key];\r\n                mapFunc(key, value);\r\n            }\r\n        });\r\n    }\r\n\r\n    findKeyForValue(obj: any, key: string) {\r\n        for (const name in obj) {\r\n            if (this.hasOwnProperty.call(obj, key)) {\r\n                if (obj[name].matches(key)) {\r\n                    return name;\r\n                }\r\n            }\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    extractReadWriteKeys(spec: any) {\r\n        const keys: string[] = [];\r\n        Tools.forEachKeyValue(spec, (k, v) => {\r\n            if (!Tools.isFunction(v)) {\r\n                keys.push(k);\r\n            }\r\n        });\r\n        return keys;\r\n    }\r\n\r\n    extractComputedKeys(spec: any) {\r\n        const keys: string[] = [];\r\n        Tools.forEachKeyValue(spec, (k, v) => {\r\n            if (Tools.isFunction(v)) {\r\n                keys.push(k);\r\n            }\r\n        });\r\n        return keys;\r\n    }\r\n\r\n    overrideComputed(obj: any, properties: any) {\r\n        Tools.forEachKeyValue(properties, (key, value) => {\r\n            try {\r\n                if (Tools.isFunction(value)) {\r\n                    Tools.defineCalculatedProperty(obj, key, value);\r\n                } else {\r\n                    obj[key] = value;\r\n                }\r\n            } catch (ex) {\r\n                console.log(ex);\r\n            }\r\n        });\r\n    }\r\n\r\n    extendComputed(obj: any, properties: any) {\r\n        Tools.forEachKeyValue(properties, (key, value) => {\r\n            try {\r\n                if (!obj[key]) {\r\n                    if (Tools.isFunction(value)) {\r\n                        Tools.defineCalculatedProperty(obj, key, value);\r\n                    } else {\r\n                        obj[key] = value;\r\n                    }\r\n                }\r\n            } catch (ex) {\r\n                console.log(ex);\r\n            }\r\n        });\r\n    }\r\n\r\n    pluck(name: string) {\r\n        return function (x: any) {\r\n            return x[name];\r\n        };\r\n    }\r\n\r\n    distinctItems(list: any[]) {\r\n        const distinct = {};\r\n        list.forEach((item) => {\r\n            Reflect.set(distinct, item, item);\r\n            // distinct[item] = item;\r\n        });\r\n        return Object.keys(distinct);\r\n    }\r\n\r\n    groupBy(pluckBy: Function, list: any[]) {\r\n        const dictionary = {};\r\n        list.forEach((item) => {\r\n            const key = pluckBy(item);\r\n            let v = (Reflect.getOwnPropertyDescriptor(dictionary, key).value as Array<any>) || [];\r\n            v.push(item);\r\n        });\r\n        return dictionary;\r\n    }\r\n\r\n    //add this to new service to dynamicaly load javascript,  maybe over signalR\r\n\r\n    // xmlHttpGet(url:string, onComplete, onFailure) {\r\n    //     let xmlHttp = new window.XMLHttpRequest();\r\n    //     xmlHttp.onload = function () {\r\n    //        let result = xmlHttp.responseText;\r\n    //         onComplete && onComplete(result, xmlHttp);\r\n    //     };\r\n    //     try {\r\n    //         xmlHttp.open(\"GET\", url, false);  //this may give chrome some problems\r\n    //         xmlHttp.send(null);\r\n    //     }\r\n    //     catch (ex) {\r\n    //         onFailure && onFailure(ex, xmlHttp);\r\n    //     }\r\n    // }\r\n    // loadAsScript(url:string, onComplete) {\r\n    //     this.xmlHttpGet(url, function (text, xhr) {\r\n    //         if (xhr.status == 200 || xhr.status == 304) {\r\n    //            let head = document.getElementsByTagName(\"head\")[0];\r\n    //            let script = document.createElement('script');\r\n    //             script.innerHTML = text;\r\n    //             head.appendChild(script);\r\n    //             onComplete && onComplete(script);\r\n    //         }\r\n    //     });\r\n    //}\r\n}\r\n\r\nexport let Tools: foTools = new foTools();\r\n","// https://medium.com/@pdx.lucasm/canvas-with-react-js-32e133c05258\r\n\r\nimport { FunctionComponent, ReactElement, useState, useEffect } from 'react';\r\nimport { useCanvas2D } from 'CanvasHook';\r\nimport { PubSub } from './foundry/models/foPubSub';\r\nimport { cPoint2D } from 'foundry/models/foGeometry2D';\r\nimport { Box } from '@material-ui/core';\r\n\r\nexport const Canvas: FunctionComponent<any> = (props: any): ReactElement => {\r\n    const { draw, ...rest } = props;\r\n    const canvasRef = useCanvas2D(props);\r\n    const setMouseLoc = useState<any>(undefined)[1];\r\n    const forceRefresh = useState<any>(0)[1];\r\n\r\n    useEffect(() => {\r\n        PubSub.Sub('mousemove', (loc: cPoint2D, e: MouseEvent, keys: any) => {\r\n            forceRefresh(new Date().getTime());\r\n            setMouseLoc(loc);\r\n        });\r\n    }, [setMouseLoc, forceRefresh]);\r\n\r\n    return (\r\n        <Box>\r\n            <h1>{props.title}</h1>\r\n            {/* <div>X: {mouseLoc?.x}</div>\r\n            <div>Y: {mouseLoc?.y}</div> */}\r\n            <canvas ref={canvasRef} {...rest} />\r\n        </Box>\r\n    );\r\n};\r\n","import { Screen2D } from 'foundry/drivers/canvasDriver';\r\nimport { useRef, useEffect } from 'react';\r\n\r\nexport function useCanvas2D(props: any) {\r\n    const draw = props.draw;\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n\r\n    // <div>MouseLoc: {JSON.stringify(model.mouseLoc)}</div>\r\n    // <div>Mouse State: {model.mouseLoc.state}</div>\r\n    // <div>Mouse Keys: {JSON.stringify(model.mouseLoc.keys)}</div>\r\n\r\n    useEffect(() => {\r\n        let animationFrameId: number = 0;\r\n\r\n        if (canvasRef.current) {\r\n            const canvas: HTMLCanvasElement = canvasRef.current;\r\n            const context: CanvasRenderingContext2D | null = canvas.getContext('2d');\r\n            const screen2D: Screen2D = new Screen2D();\r\n            screen2D.setRoot(canvas, props.width, props.height);\r\n\r\n            const render = () => {\r\n                if (context) {\r\n                    // console.log('props=', props.model.mouseLoc);\r\n\r\n                    draw(context, animationFrameId);\r\n                    animationFrameId = window.requestAnimationFrame(render);\r\n                }\r\n            };\r\n            render();\r\n        }\r\n\r\n        return () => {\r\n            window.cancelAnimationFrame(animationFrameId);\r\n        };\r\n    }, [draw, props]);\r\n\r\n    return canvasRef;\r\n}\r\n","import React, { FunctionComponent, ReactElement, createElement, useMemo } from 'react';\r\nimport { Constructable } from './runtime-type';\r\n\r\nexport const ToJSON: FunctionComponent<any> = (props: any): ReactElement => {\r\n    return <pre>{JSON.stringify(props.children, undefined, 3)} </pre>;\r\n};\r\n\r\nexport const EmptyRender: FunctionComponent = (): ReactElement => {\r\n    return <div>Empty component displayed if no component is available in FoRender class</div>;\r\n};\r\n\r\nexport interface IfoRenderViewModel {}\r\n\r\nexport class foRender<T extends IfoRenderViewModel> {\r\n    props: T = {} as T;\r\n    Component: React.FunctionComponent<T> = EmptyRender;\r\n\r\n    display(props?: T) {\r\n        if (props) {\r\n            this.props = { ...this.props, ...props };\r\n        }\r\n        return createElement(this.Component, this.props);\r\n    }\r\n}\r\n\r\nexport interface IfoComponentViewModel {}\r\n\r\nexport class foComponent<T extends IfoComponentViewModel> {\r\n    props: T = {} as T;\r\n    Component: React.FunctionComponent<T> = EmptyRender;\r\n\r\n    display(props?: T) {\r\n        if (props) {\r\n            this.props = { ...this.props, ...props };\r\n        }\r\n        return createElement(this.Component, this.props);\r\n    }\r\n}\r\n\r\nexport const useComponentClass = <S, T extends foComponent<S>>(Implementation: Constructable<T>, props: S): ReactElement => {\r\n    return useMemo(() => new Implementation(), [Implementation]).display(props);\r\n};\r\n\r\nexport const useRenderClass = <T extends foRender<any>>(Implementation: Constructable<T>): foRender<any> => {\r\n    return useMemo(() => {\r\n        return new Implementation();\r\n    }, [Implementation]);\r\n};\r\n","import { EmptyRender } from 'core/foRenderer';\r\nimport { createElement } from 'react';\r\n\r\nexport class K2Render<T> {\r\n    props: T = {} as T;\r\n    Component: React.FunctionComponent<T> = EmptyRender;\r\n\r\n    display(props?: T) {\r\n        if (props) {\r\n            this.props = props;\r\n        }\r\n        return createElement(this.Component, this.props);\r\n    }\r\n}\r\n\r\nexport class K2Container<T> extends K2Render<T> {}\r\n","import { Fragment, FunctionComponent, ReactElement } from 'react';\r\nimport { Canvas } from 'Canvas';\r\nimport { K2Render } from 'k2-core/K2Render';\r\nimport { ParkTheatreCanvasPage } from './park-theatre-canvas.model';\r\nimport { Box } from '@material-ui/core';\r\nimport Hidden from '@material-ui/core/Hidden';\r\nimport { ToJSON } from 'core/foRenderer';\r\n\r\nclass ViewModel {}\r\nexport class ParkTheatreRender<T extends ViewModel> extends K2Render<T> {\r\n    model: typeof ParkTheatreCanvasPage;\r\n    actionButtons: ReactElement[];\r\n    platformJSON: any;\r\n    Component: FunctionComponent<T> = (props): ReactElement => {\r\n        return (\r\n            <Fragment>\r\n                <Box display=\"flex\" flexWrap=\"wrap\">\r\n                    {this.actionButtons}\r\n                </Box>\r\n                <Canvas {...this.model.canvas2Params} />\r\n\r\n                <Hidden only=\"xs\">\r\n                    <ToJSON>{this.model.asPlatform(true)}</ToJSON>\r\n                </Hidden>\r\n            </Fragment>\r\n        );\r\n    };\r\n}\r\n","/**\r\n * Represents an affine transformation matrix, and provides tools for constructing and concatenating matrices.\r\n *\r\n * This matrix can be visualized as:\r\n *\r\n * \t[ a  c  tx\r\n * \t  b  d  ty\r\n * \t  0  0  1  ]\r\n *\r\n * Note the locations of b and c.\r\n *\r\n * @class Matrix2D\r\n * @param {Number} [a=1] Specifies the a property for the new matrix.\r\n * @param {Number} [b=0] Specifies the b property for the new matrix.\r\n * @param {Number} [c=0] Specifies the c property for the new matrix.\r\n * @param {Number} [d=1] Specifies the d property for the new matrix.\r\n * @param {Number} [tx=0] Specifies the tx property for the new matrix.\r\n * @param {Number} [ty=0] Specifies the ty property for the new matrix.\r\n * @constructor\r\n **/\r\n\r\nimport { cPoint2D } from './foGeometry2D';\r\n\r\nexport class Matrix2D {\r\n    static DEG_TO_RAD: number = Math.PI / 180;\r\n\r\n    public a: number = 1; //Position (0, 0) in a 3x3 affine transformation matrix.\r\n    public b: number = 0; //Position (0, 1) in a 3x3 affine transformation matrix.\r\n    public c: number = 0; //Position (1, 0) in a 3x3 affine transformation matrix.\r\n    public d: number = 1; //Position (1, 1) in a 3x3 affine transformation matrix.\r\n    public tx: number = 0; //Position (2, 0) in a 3x3 affine transformation matrix.\r\n    public ty: number = 0; //Position (2, 1) in a 3x3 affine transformation matrix.\r\n\r\n    constructor(matrix?: Matrix2D) {\r\n        if (matrix) {\r\n            this.copy(matrix);\r\n        }\r\n    }\r\n\r\n    append(a: number, b: number, c: number, d: number, tx: number, ty: number) {\r\n        let a1 = this.a;\r\n        let b1 = this.b;\r\n        let c1 = this.c;\r\n        let d1 = this.d;\r\n        if (a !== 1 || b !== 0 || c !== 0 || d !== 1) {\r\n            this.a = a1 * a + c1 * b;\r\n            this.b = b1 * a + d1 * b;\r\n            this.c = a1 * c + c1 * d;\r\n            this.d = b1 * c + d1 * d;\r\n        }\r\n        this.tx = a1 * tx + c1 * ty + this.tx;\r\n        this.ty = b1 * tx + d1 * ty + this.ty;\r\n        return this;\r\n    }\r\n\r\n    prepend(a: number, b: number, c: number, d: number, tx: number, ty: number) {\r\n        var a1 = this.a;\r\n        var c1 = this.c;\r\n        var tx1 = this.tx;\r\n\r\n        this.a = a * a1 + c * this.b;\r\n        this.b = b * a1 + d * this.b;\r\n        this.c = a * c1 + c * this.d;\r\n        this.d = b * c1 + d * this.d;\r\n        this.tx = a * tx1 + c * this.ty + tx;\r\n        this.ty = b * tx1 + d * this.ty + ty;\r\n        return this;\r\n    }\r\n\r\n    set(a: number, b: number, c: number, d: number, tx: number, ty: number) {\r\n        this.a = a;\r\n        this.b = b;\r\n        this.c = c;\r\n        this.d = d;\r\n        this.tx = tx;\r\n        this.ty = ty;\r\n        return this;\r\n    }\r\n\r\n    appendMatrix(matrix: Matrix2D) {\r\n        return this.append(matrix.a, matrix.b, matrix.c, matrix.d, matrix.tx, matrix.ty);\r\n    }\r\n\r\n    prependMatrix(matrix: Matrix2D) {\r\n        return this.prepend(matrix.a, matrix.b, matrix.c, matrix.d, matrix.tx, matrix.ty);\r\n    }\r\n\r\n    appendTransform(x: number, y: number, scaleX: number, scaleY: number, rotation: number, skewX: number, skewY: number, regX: number, regY: number) {\r\n        if (rotation % 360) {\r\n            var r = rotation * Matrix2D.DEG_TO_RAD;\r\n            var cos = Math.cos(r);\r\n            var sin = Math.sin(r);\r\n        } else {\r\n            cos = 1;\r\n            sin = 0;\r\n        }\r\n\r\n        if (skewX || skewY) {\r\n            // TODO: can this be combined into a single append operation?\r\n            skewX *= Matrix2D.DEG_TO_RAD;\r\n            skewY *= Matrix2D.DEG_TO_RAD;\r\n            this.append(Math.cos(skewY), Math.sin(skewY), -Math.sin(skewX), Math.cos(skewX), x, y);\r\n            this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, 0, 0);\r\n        } else {\r\n            this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, x, y);\r\n        }\r\n\r\n        if (regX || regY) {\r\n            // append the registration offset:\r\n            this.tx -= regX * this.a + regY * this.c;\r\n            this.ty -= regX * this.b + regY * this.d;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    prependTransform(x: number, y: number, scaleX: number, scaleY: number, rotation: number, skewX: number, skewY: number, regX: number, regY: number) {\r\n        if (rotation % 360) {\r\n            var r = rotation * Matrix2D.DEG_TO_RAD;\r\n            var cos = Math.cos(r);\r\n            var sin = Math.sin(r);\r\n        } else {\r\n            cos = 1;\r\n            sin = 0;\r\n        }\r\n\r\n        if (regX || regY) {\r\n            // prepend the registration offset:\r\n            this.tx -= regX;\r\n            this.ty -= regY;\r\n        }\r\n        if (skewX || skewY) {\r\n            // TODO: can this be combined into a single prepend operation?\r\n            skewX *= Matrix2D.DEG_TO_RAD;\r\n            skewY *= Matrix2D.DEG_TO_RAD;\r\n            this.prepend(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, 0, 0);\r\n            this.prepend(Math.cos(skewY), Math.sin(skewY), -Math.sin(skewX), Math.cos(skewX), x, y);\r\n        } else {\r\n            this.prepend(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, x, y);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    rotate(angle: number) {\r\n        angle = angle * Matrix2D.DEG_TO_RAD;\r\n        var cos = Math.cos(angle);\r\n        var sin = Math.sin(angle);\r\n\r\n        var a1 = this.a;\r\n        var b1 = this.b;\r\n\r\n        this.a = a1 * cos + this.c * sin;\r\n        this.b = b1 * cos + this.d * sin;\r\n        this.c = -a1 * sin + this.c * cos;\r\n        this.d = -b1 * sin + this.d * cos;\r\n        return this;\r\n    }\r\n\r\n    skew(skewX: number, skewY: number) {\r\n        skewX = skewX * Matrix2D.DEG_TO_RAD;\r\n        skewY = skewY * Matrix2D.DEG_TO_RAD;\r\n        this.append(Math.cos(skewY), Math.sin(skewY), -Math.sin(skewX), Math.cos(skewX), 0, 0);\r\n        return this;\r\n    }\r\n\r\n    scale(x: number, y: number) {\r\n        this.a *= x;\r\n        this.b *= x;\r\n        this.c *= y;\r\n        this.d *= y;\r\n        return this;\r\n    }\r\n\r\n    translate(x: number, y: number) {\r\n        this.tx += this.a * x + this.c * y;\r\n        this.ty += this.b * x + this.d * y;\r\n        return this;\r\n    }\r\n\r\n    identity() {\r\n        this.a = this.d = 1;\r\n        this.b = this.c = this.tx = this.ty = 0;\r\n        return this;\r\n    }\r\n\r\n    invert() {\r\n        let a1 = this.a;\r\n        let b1 = this.b;\r\n        let c1 = this.c;\r\n        let d1 = this.d;\r\n        let tx1 = this.tx;\r\n        //let ty1 = this.ty;\r\n        let n = a1 * d1 - b1 * c1;\r\n\r\n        this.a = d1 / n;\r\n        this.b = -b1 / n;\r\n        this.c = -c1 / n;\r\n        this.d = a1 / n;\r\n        this.tx = (c1 * this.ty - d1 * tx1) / n;\r\n        this.ty = -(a1 * this.ty - b1 * tx1) / n;\r\n        return this;\r\n    }\r\n\r\n    invertCopy() {\r\n        let result = new Matrix2D(this);\r\n        return result.invert();\r\n    }\r\n\r\n    isIdentity() {\r\n        return this.tx === 0 && this.ty === 0 && this.a === 1 && this.b === 0 && this.c === 0 && this.d === 1;\r\n    }\r\n\r\n    equals(matrix: Matrix2D) {\r\n        return this.tx === matrix.tx && this.ty === matrix.ty && this.a === matrix.a && this.b === matrix.b && this.c === matrix.c && this.d === matrix.d;\r\n    }\r\n\r\n    transformPoint(x: number, y: number, pt?: cPoint2D): cPoint2D {\r\n        pt = pt || new cPoint2D();\r\n        pt.x = x * this.a + y * this.c + this.tx;\r\n        pt.y = x * this.b + y * this.d + this.ty;\r\n        return pt;\r\n    }\r\n\r\n    invertPoint(x: number, y: number, pt?: cPoint2D): cPoint2D {\r\n        let inv = this.invertCopy();\r\n        return inv.transformPoint(x, y, pt);\r\n    }\r\n\r\n    decompose(target: any) {\r\n        // TODO: it would be nice to be able to solve for whether the matrix can be decomposed into only scale/rotation even when scale is negative\r\n        if (target == null) {\r\n            target = {};\r\n        }\r\n        target.x = this.tx;\r\n        target.y = this.ty;\r\n        target.scaleX = Math.sqrt(this.a * this.a + this.b * this.b);\r\n        target.scaleY = Math.sqrt(this.c * this.c + this.d * this.d);\r\n\r\n        var skewX = Math.atan2(-this.c, this.d);\r\n        var skewY = Math.atan2(this.b, this.a);\r\n\r\n        var delta = Math.abs(1 - skewX / skewY);\r\n        if (delta < 0.00001) {\r\n            // effectively identical, can use rotation:\r\n            target.rotation = skewY / Matrix2D.DEG_TO_RAD;\r\n            if (this.a < 0 && this.d >= 0) {\r\n                target.rotation += target.rotation <= 0 ? 180 : -180;\r\n            }\r\n            target.skewX = target.skewY = 0;\r\n        } else {\r\n            target.skewX = skewX / Matrix2D.DEG_TO_RAD;\r\n            target.skewY = skewY / Matrix2D.DEG_TO_RAD;\r\n        }\r\n        return target;\r\n    }\r\n\r\n    copy(matrix: Matrix2D) {\r\n        this.a = matrix.a;\r\n        this.b = matrix.b;\r\n        this.c = matrix.c;\r\n        this.d = matrix.d;\r\n        this.tx = matrix.tx;\r\n        this.ty = matrix.ty;\r\n        return this;\r\n    }\r\n\r\n    clone() {\r\n        let matrix = new Matrix2D(this);\r\n        return matrix;\r\n    }\r\n\r\n    toString() {\r\n        return '[Matrix2D (a=' + this.a + ' b=' + this.b + ' c=' + this.c + ' d=' + this.d + ' tx=' + this.tx + ' ty=' + this.ty + ')]';\r\n    }\r\n}\r\n\r\nexport let Identity: Matrix2D = new Matrix2D();\r\n","import { Action } from './foInterface';\r\nimport { foObject } from './foObject.model';\r\nimport { Tools } from './foTools';\r\n\r\n// https://github.com/ReactiveX/rxjs/blob/master/docs_app/content/guide/v6/migration.md\r\nimport { Observable, Subject } from 'rxjs';\r\nimport { debounceTime } from 'rxjs/operators';\r\n\r\nlet counter = 0;\r\nexport enum LifecycleEventTypes {\r\n    primitive,\r\n    defined,\r\n    created,\r\n    destroyed\r\n}\r\n\r\nexport class foLifecycleEvent {\r\n    id: number = 0;\r\n    cmd: string = '';\r\n    object: foObject;\r\n    value: any;\r\n\r\n    get guid() {\r\n        return this.object.myGuid;\r\n    }\r\n    get simpleGuid() {\r\n        return this.object.myGuid.slice(-8);\r\n    }\r\n    get myGuid() {\r\n        return this.object.myGuid;\r\n    }\r\n    get myType() {\r\n        return this.object.myType;\r\n    }\r\n\r\n    get myName() {\r\n        return this.object.myName;\r\n    }\r\n\r\n    isNamed(name: string) {\r\n        return Tools.matches(name, this.myName);\r\n    }\r\n\r\n    isCmd(cmd: string) {\r\n        return Tools.matches(cmd, this.cmd);\r\n    }\r\n\r\n    constructor(cmd: string, obj: foObject, count: number = 0, value?: any) {\r\n        this.id = count;\r\n        this.cmd = cmd;\r\n        this.object = obj;\r\n        this.value = value;\r\n    }\r\n}\r\n\r\n//this is needed to prevent circular communiation\r\n// create => create => create across browsers\r\nexport class foLifecycleEventLock {\r\n    private _processLock: any = {};\r\n\r\n    isLocked(guid: string) {\r\n        return this._processLock[guid] ? true : false;\r\n    }\r\n\r\n    addLock(guid: string) {\r\n        if (!this.isLocked(guid)) {\r\n            this._processLock[guid] = 0;\r\n        }\r\n        this._processLock[guid] += 1;\r\n    }\r\n\r\n    unLock(guid: string) {\r\n        if (this.isLocked(guid)) {\r\n            this._processLock[guid] -= 1;\r\n            if (this._processLock[guid] <= 0) {\r\n                delete this._processLock[guid];\r\n            }\r\n        }\r\n    }\r\n\r\n    protected(guid: string, context: any, func: Action<any>) {\r\n        this.addLock(guid);\r\n        try {\r\n            func(context);\r\n        } catch (ex) {\r\n            console.error('protected', ex);\r\n        }\r\n        this.unLock(guid);\r\n    }\r\n\r\n    whenUnprotected(guid: string, context: any, func: Action<any>) {\r\n        if (!this.isLocked(guid)) {\r\n            try {\r\n                func(context);\r\n            } catch (ex) {\r\n                console.error('whenUnprotected ', ex);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport let LifecycleLock: foLifecycleEventLock = new foLifecycleEventLock();\r\nexport let KnowcycleLock: foLifecycleEventLock = new foLifecycleEventLock();\r\n\r\nexport class foLifecycle {\r\n    mute: boolean = false;\r\n\r\n    public observable: Observable<foLifecycleEvent>;\r\n    public emit: Subject<foLifecycleEvent>;\r\n\r\n    private debounced: Subject<foLifecycleEvent>;\r\n\r\n    constructor(debouce: number = 500) {\r\n        this.emit = new Subject<foLifecycleEvent>();\r\n        this.observable = this.emit.asObservable();\r\n\r\n        this.debounced = new Subject<foLifecycleEvent>();\r\n\r\n        this.debounced\r\n            .asObservable()\r\n            .pipe(debounceTime(debouce))\r\n            .subscribe((event) => {\r\n                event.id = counter++;\r\n                this.broadcast(event);\r\n            });\r\n    }\r\n\r\n    broadcast(obj: foLifecycleEvent) {\r\n        !this.mute && this.emit.next(obj);\r\n        return this;\r\n    }\r\n\r\n    primitive(obj: foObject, value?: any) {\r\n        this.broadcast(new foLifecycleEvent('primitive', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    defined(obj: foObject) {\r\n        this.broadcast(new foLifecycleEvent('defined', obj, counter++));\r\n        return this;\r\n    }\r\n\r\n    event(eventName: string, obj: foObject, value?: any) {\r\n        this.broadcast(new foLifecycleEvent(eventName, obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    created(obj: foObject, value?: any) {\r\n        this.broadcast(new foLifecycleEvent('created', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    destroyed(obj: foObject) {\r\n        this.broadcast(new foLifecycleEvent('destroyed', obj, counter++));\r\n        return this;\r\n    }\r\n\r\n    unparent(obj: foObject) {\r\n        this.broadcast(new foLifecycleEvent('unparent', obj, counter++));\r\n        return this;\r\n    }\r\n\r\n    reparent(obj: foObject) {\r\n        this.broadcast(new foLifecycleEvent('reparent', obj, counter++));\r\n        return this;\r\n    }\r\n\r\n    action(obj: foObject, action: string, params?: any) {\r\n        this.broadcast(\r\n            new foLifecycleEvent('run', obj, counter++, {\r\n                action: action,\r\n                params: params\r\n            })\r\n        );\r\n        return this;\r\n    }\r\n\r\n    command(obj: foObject, method: string) {\r\n        this.broadcast(new foLifecycleEvent('command', obj, counter++, method));\r\n        return this;\r\n    }\r\n\r\n    selected(obj: foObject, value: any) {\r\n        this.broadcast(new foLifecycleEvent('selected', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    pageSelections(obj: foObject, value: any) {\r\n        this.broadcast(new foLifecycleEvent('pageselections', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    layout(obj: foObject, value: any) {\r\n        this.broadcast(new foLifecycleEvent('layout', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    changed(obj: foObject, value?: any) {\r\n        this.broadcast(new foLifecycleEvent('changed', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    glued(obj: foObject, value: any) {\r\n        this.broadcast(new foLifecycleEvent('glued', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    unglued(obj: foObject, value: any) {\r\n        this.broadcast(new foLifecycleEvent('unglued', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    dropped(obj: foObject, value?: any) {\r\n        this.broadcast(new foLifecycleEvent('dropped', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    handle(obj: foObject, value?: any) {\r\n        this.debounced.next(new foLifecycleEvent('handle', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    moved(obj: foObject, value?: any) {\r\n        this.debounced.next(new foLifecycleEvent('moved', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    easeTo(obj: foObject, value?: any) {\r\n        this.broadcast(new foLifecycleEvent('easeTo', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    easeTween(obj: foObject, value?: any) {\r\n        this.broadcast(new foLifecycleEvent('easeTween', obj, counter++, value));\r\n        return this;\r\n    }\r\n\r\n    moveComplete(obj: foObject, value?: any) {\r\n        this.debounced.next(new foLifecycleEvent('moveComplete', obj, counter++, value));\r\n        return this;\r\n    }\r\n}\r\n\r\nexport let Lifecycle: foLifecycle = new foLifecycle(300);\r\nexport let Knowcycle: foLifecycle = new foLifecycle();\r\n","import { Tools, foNames } from './foTools';\r\nimport { iObject, ModelRef } from './foInterface';\r\n//import { setTimeout } from 'timers';\r\n\r\nexport interface IDisposable {\r\n    dispose(): any;\r\n}\r\n\r\nexport function using<T extends IDisposable>(resource: T, func: (resource: T) => any) {\r\n    let result: any;\r\n    try {\r\n        result = func(resource);\r\n    } finally {\r\n        resource.dispose();\r\n    }\r\n    return result;\r\n}\r\n\r\nexport class foObject implements iObject {\r\n    static beep() {\r\n        const snd = new Audio(\r\n            // tslint:disable-next-line:max-line-length\r\n            'data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU='\r\n        );\r\n        snd.play();\r\n    }\r\n\r\n    static jsonAlert(obj: any, title: string = 'JSON Alert') {\r\n        try {\r\n            alert(title + '\\r' + JSON.stringify(obj, undefined, 3));\r\n        } catch (ex) {\r\n            alert(title + '\\r' + JSON.stringify(obj.asJson, undefined, 3));\r\n            alert(ex);\r\n        }\r\n    }\r\n\r\n    private _myGuid: string;\r\n    myName: string = foNames.UNKNOWN;\r\n    myParent: ModelRef<iObject> | undefined;\r\n\r\n    private _isVisible: boolean = true;\r\n    get isVisible(): boolean {\r\n        return this._isVisible;\r\n    }\r\n    set isVisible(value: boolean) {\r\n        this._isVisible = value;\r\n    }\r\n    get isInvisible(): boolean {\r\n        return !this._isVisible;\r\n    }\r\n    set isInvisible(value: boolean) {\r\n        this._isVisible = !value;\r\n    }\r\n\r\n    private _isHitable: boolean = true;\r\n    get isHitable(): boolean {\r\n        return this._isHitable;\r\n    }\r\n    set isHitable(value: boolean) {\r\n        this._isHitable = value;\r\n    }\r\n\r\n    show(value: boolean = true) {\r\n        this._isVisible = value ? true : false;\r\n        return this;\r\n    }\r\n    hide() {\r\n        this._isVisible = false;\r\n        return this;\r\n    }\r\n\r\n    get isPublic() {\r\n        return this._isVisible;\r\n    }\r\n\r\n    constructor(properties?: any, parent?: foObject) {\r\n        if (parent) {\r\n            this.myParent = () => {\r\n                return parent;\r\n            };\r\n        }\r\n\r\n        this.override(properties);\r\n    }\r\n    myClass: string;\r\n\r\n    //https://www.npmjs.com/package/reflect-metadata\r\n    //https://stackoverflow.com/questions/13613524/get-an-objects-class-name-at-runtime-in-typescript\r\n\r\n    get myType(): string {\r\n        const comp: any = this.constructor;\r\n        return comp.name;\r\n    }\r\n    set myType(ignore: string) {}\r\n\r\n    get myGuid(): string {\r\n        if (!this._myGuid) {\r\n            this._myGuid = Tools.generateUUID();\r\n        }\r\n        return this._myGuid;\r\n    }\r\n\r\n    set myGuid(value) {\r\n        if (!this._myGuid) {\r\n            this._myGuid = value;\r\n        }\r\n    }\r\n\r\n    public generateName() {\r\n        const short = this.myGuid.slice(-6);\r\n        this.myName = `${this.myType}_${short}`;\r\n        return this;\r\n    }\r\n\r\n    public defaultName(name?: string) {\r\n        if (name) {\r\n            this.myName = name;\r\n        } else if (Tools.matches(this.myName, foNames.UNKNOWN)) {\r\n            this.generateName();\r\n        }\r\n        return this;\r\n    }\r\n\r\n    protected _displayName: string;\r\n    get displayName() {\r\n        if (this._displayName) {\r\n            return this._displayName;\r\n        }\r\n        return `${this.myName} - ${this.myType}`;\r\n    }\r\n    set displayName(value: string) {\r\n        this._displayName = value;\r\n    }\r\n\r\n    setName(name: string) {\r\n        this.myName = name;\r\n        return this;\r\n    }\r\n\r\n    is2D() {\r\n        return false;\r\n    }\r\n    is3D() {\r\n        return false;\r\n    }\r\n\r\n    asReference(): string {\r\n        const parent = this.myParent && this.myParent();\r\n        if (!parent) {\r\n            return foNames.ROOT;\r\n        }\r\n        return `${this.myName}.${parent.asReference()}`;\r\n    }\r\n\r\n    then(next: (obj: any) => void) {\r\n        next(this);\r\n        return this;\r\n    }\r\n\r\n    hasAncestor(member: iObject): boolean {\r\n        if (member === this) {\r\n            return true;\r\n        }\r\n\r\n        const parent = this.myParent && this.myParent();\r\n        if (member === parent) {\r\n            return true;\r\n        }\r\n        return Boolean(parent && parent?.hasAncestor(member));\r\n    }\r\n\r\n    get hasParent() {\r\n        const parent = this.myParent && this.myParent();\r\n        return parent ? true : false;\r\n    }\r\n\r\n    removeParent(parent: foObject) {\r\n        if (this.hasParent && this.myParent && this.myParent() === parent) {\r\n            this.myParent = undefined;\r\n        }\r\n        return this.hasParent;\r\n    }\r\n\r\n    setParent(newParent: foObject) {\r\n        const parent = this.myParent && this.myParent();\r\n        if (parent !== newParent) {\r\n            this.myParent = () => {\r\n                return newParent;\r\n            };\r\n        }\r\n        return this;\r\n    }\r\n\r\n    public wait(time: number, func: () => void) {\r\n        setTimeout(func, time);\r\n        return this;\r\n    }\r\n\r\n    public getChildAt(i: number): iObject | undefined {\r\n        return undefined;\r\n    }\r\n\r\n    public extract(keys?: string[], target?: any) {\r\n        const spec = target ? target : {};\r\n        keys &&\r\n            keys.forEach((key) => {\r\n                spec[key] = Reflect.getOwnPropertyDescriptor(this, key).value;\r\n            });\r\n        return spec;\r\n    }\r\n\r\n    public override(properties?: any) {\r\n        properties && Tools.overrideComputed(this, properties);\r\n        return this;\r\n    }\r\n\r\n    public extend(properties?: any) {\r\n        properties && Tools.extendComputed(this, properties);\r\n        return this;\r\n    }\r\n\r\n    getMethodList() {\r\n        //consider moveing this code to baseobject\r\n        function getAllMethods(object: any) {\r\n            return Object.getOwnPropertyNames(object).filter(function (property) {\r\n                return typeof object[property] === 'function';\r\n            });\r\n        }\r\n\r\n        const names = getAllMethods(this);\r\n\r\n        const self = this;\r\n        const obj1 = {};\r\n        names.forEach((item) => {\r\n            Reflect.set(obj1, item, Reflect.getOwnPropertyDescriptor(self, item).value);\r\n            // obj1[item] = self[item](); //evaluate all methods\r\n        });\r\n\r\n        return names;\r\n    }\r\n\r\n    get debug() {\r\n        return Tools.stringify(this);\r\n        //return JSON.stringify(this,undefined,3);\r\n    }\r\n\r\n    get asJsonRaw() {\r\n        const data = Tools.stringify(this);\r\n        return JSON.parse(data);\r\n    }\r\n\r\n    get asJson() {\r\n        return this.toJson();\r\n    }\r\n    protected toJson(): any {\r\n        return {\r\n            myName: this.myName,\r\n            myGuid: this.myGuid,\r\n            myType: this.myType\r\n        };\r\n    }\r\n\r\n    protected jsonMerge(source: any) {\r\n        const result = Tools.asJson(this);\r\n        if (!Tools.isEmpty(source)) {\r\n            Tools.forEachKeyValue(source, (key: string, value: any) => {\r\n                if (!result[key] && !Tools.isEmpty(value)) {\r\n                    const json = value && value.asJson;\r\n                    result[key] = json ? json : value;\r\n                }\r\n            });\r\n        }\r\n        return result;\r\n    }\r\n}\r\n","import { Tools } from './foTools';\r\nimport { Vector3 } from 'three';\r\nimport { iPoint2D, iFrame } from './foInterface';\r\n\r\nimport { foObject } from './foObject.model';\r\nimport { Matrix2D } from './foMatrix2D';\r\n\r\nimport { foGlyph2D, IfoGlyph2DProperties } from './foGlyph2D.model';\r\n\r\nimport { Lifecycle } from './foLifecycle';\r\nimport { foCollection } from './foCollection.model';\r\n\r\nexport enum shape2DNames {\r\n    left = 'left',\r\n    right = 'right',\r\n    top = 'top',\r\n    bottom = 'bottom',\r\n    center = 'center'\r\n}\r\n\r\nexport interface IfoShape2DProperties extends IfoGlyph2DProperties {\r\n    angle?: number;\r\n}\r\n\r\n//a Shape is a graphic designed to behave like a visio shape\r\n//and have all the same properties\r\nexport class foShape2D extends foGlyph2D implements IfoShape2DProperties {\r\n    protected _angle: number;\r\n    get angle(): number {\r\n        return this._angle || 0.0;\r\n    }\r\n    set angle(value: number) {\r\n        this.smash();\r\n        this._angle = value;\r\n    }\r\n\r\n    protected _subcomponents: foCollection<foShape2D>;\r\n    get subcomponents(): foCollection<foShape2D> {\r\n        if (!this._subcomponents) {\r\n            this._subcomponents = new foCollection<foShape2D>();\r\n        }\r\n        return this._subcomponents;\r\n    }\r\n\r\n    public pinX = (): number => 0.5 * this.width;\r\n    public pinY = (): number => 0.5 * this.height;\r\n    public rotationZ = (): number => this.angle;\r\n\r\n    public setPinLeft() {\r\n        this.pinX = (): number => 0.0 * this.width;\r\n        return this;\r\n    }\r\n    public setPinRight() {\r\n        this.pinX = (): number => 1.0 * this.width;\r\n        return this;\r\n    }\r\n    public setPinCenter() {\r\n        this.pinX = (): number => 0.5 * this.width;\r\n        return this;\r\n    }\r\n\r\n    public setPinTop() {\r\n        this.pinY = (): number => 0.0 * this.height;\r\n        return this;\r\n    }\r\n    public setPinMiddle() {\r\n        this.pinY = (): number => 0.5 * this.height;\r\n        return this;\r\n    }\r\n    public setPinBottom() {\r\n        this.pinY = (): number => 1.0 * this.height;\r\n        return this;\r\n    }\r\n\r\n    pinVector(): Vector3 {\r\n        return new Vector3(this.pinX(), this.pinY(), 0);\r\n    }\r\n\r\n    protected originPosition(): Vector3 {\r\n        const pin = this.pinVector();\r\n        return new Vector3(this.x - pin.x, this.y - pin.y, 0);\r\n    }\r\n\r\n    public pinLocation() {\r\n        return {\r\n            x: this.pinX(),\r\n            y: this.pinY(),\r\n            z: 0\r\n        };\r\n    }\r\n\r\n    constructor(properties?: IfoShape2DProperties, parent?: foObject) {\r\n        super(properties, parent);\r\n        this.override(properties);\r\n    }\r\n\r\n    protected toJson(): any {\r\n        return Tools.mixin(super.toJson(), {\r\n            angle: this.angle\r\n            // glue: this._glue && Tools.asArray(this.glue.asJson)\r\n        });\r\n    }\r\n\r\n    public didLocationChange(x: number = Number.NaN, y: number = Number.NaN, angle: number = Number.NaN): boolean {\r\n        let changed = super.didLocationChange(x, y, angle);\r\n        if (!Number.isNaN(angle) && this.angle !== angle) {\r\n            changed = true;\r\n            this.angle = angle;\r\n        }\r\n        return changed;\r\n    }\r\n\r\n    public move(x: number = Number.NaN, y: number = Number.NaN, angle: number = Number.NaN) {\r\n        if (this.didLocationChange(x, y, angle)) {\r\n            const point = this.getLocation();\r\n\r\n            Lifecycle.moved(this, point);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    updateContext(ctx: CanvasRenderingContext2D) {\r\n        const mtx = this.getMatrix();\r\n        ctx.transform(mtx.a, mtx.b, mtx.c, mtx.d, mtx.tx, mtx.ty);\r\n        ctx.globalAlpha *= this.opacity;\r\n    }\r\n\r\n    getMatrix() {\r\n        if (this._matrix === undefined) {\r\n            this._matrix = new Matrix2D();\r\n            this._matrix.appendTransform(this.x, this.y, 1, 1, this.rotationZ(), 0, 0, this.pinX(), this.pinY());\r\n        }\r\n        return this._matrix;\r\n    }\r\n\r\n    protected localHitTest = (hit: any): boolean => {\r\n        const { x, y } = hit as iPoint2D;\r\n        const loc = this.globalToLocal(x, y);\r\n\r\n        if (loc.x < 0) return false;\r\n        if (loc.x > this.width) return false;\r\n\r\n        if (loc.y < 0) return false;\r\n        if (loc.y > this.height) return false;\r\n\r\n        return true;\r\n    };\r\n\r\n    public hitTest = (hit: any): boolean => {\r\n        return this.isHitable && this.isVisible && this.localHitTest(hit);\r\n    };\r\n\r\n    public overlapTest = (hit: iFrame): boolean => {\r\n        const frame = this.globalToLocalFrame(hit.x1, hit.y1, hit.x2, hit.y2);\r\n\r\n        if (this.localContains(frame.x1, frame.y1)) return true;\r\n        if (this.localContains(frame.x1, frame.y2)) return true;\r\n        if (this.localContains(frame.x2, frame.y1)) return true;\r\n        if (this.localContains(frame.x2, frame.y2)) return true;\r\n        return false;\r\n    };\r\n\r\n    public render(ctx: CanvasRenderingContext2D, deep: boolean = true): foShape2D | undefined {\r\n        if (this.isInvisible) return;\r\n        ctx.save();\r\n\r\n        //this.drawOrigin(ctx);\r\n        this.updateContext(ctx);\r\n        //this.drawOriginX(ctx);\r\n\r\n        this.preDraw && this.preDraw(ctx);\r\n        this.draw(ctx);\r\n        this.drawHover && this.drawHover(ctx);\r\n        this.postDraw && this.postDraw(ctx);\r\n\r\n        this.isSelected && this.drawSelected(ctx);\r\n\r\n        deep &&\r\n            this._subcomponents?.forEach((item) => {\r\n                item.render(ctx, deep);\r\n            });\r\n        ctx.restore();\r\n        return this;\r\n    }\r\n\r\n    public drawOutline(ctx: CanvasRenderingContext2D) {\r\n        ctx.beginPath();\r\n        ctx.setLineDash([15, 5]);\r\n        ctx.rect(0, 0, this.width, this.height);\r\n        ctx.stroke();\r\n    }\r\n\r\n    public drawSelected = (ctx: CanvasRenderingContext2D): void => {\r\n        ctx.strokeStyle = 'red';\r\n        ctx.lineWidth = 4;\r\n        this.drawOutline(ctx);\r\n\r\n        this.drawPin(ctx);\r\n    };\r\n\r\n    public drawBackground = (ctx: CanvasRenderingContext2D): void => {\r\n        ctx.fillStyle = this.color;\r\n        ctx.lineWidth = 1;\r\n        ctx.globalAlpha = this.opacity;\r\n        ctx.fillRect(0, 0, this.width, this.height);\r\n    };\r\n\r\n    public draw = (ctx: CanvasRenderingContext2D): void => {\r\n        this.drawBackground(ctx);\r\n    };\r\n}\r\n","import { Tools } from './foTools';\r\nimport { cPoint2D, cFrame } from './foGeometry2D';\r\nimport { Matrix2D } from './foMatrix2D';\r\n\r\nimport { iPoint2D, iRect, iFrame } from './foInterface';\r\n\r\nimport { Lifecycle } from './foLifecycle';\r\n\r\nimport { foObject } from './foObject.model';\r\n\r\nexport interface IfoGlyph2DProperties {\r\n    opacity?: number;\r\n    isSelected?: boolean;\r\n    color?: string;\r\n\r\n    x?: number;\r\n    y?: number;\r\n    width?: number;\r\n    height?: number;\r\n    [propName: string]: any;\r\n}\r\n\r\n// a Glyph is a graphic designed to draw on a canvas in absolute coordinates\r\nexport class foGlyph2D extends foObject implements IfoGlyph2DProperties {\r\n    public opacity: number = 1.0;\r\n    public isSelected: boolean = false;\r\n    public color: any;\r\n\r\n    protected _x: number;\r\n    protected _y: number;\r\n    protected _width: number;\r\n    protected _height: number;\r\n\r\n    constructor(properties?: IfoGlyph2DProperties, parent?: foObject) {\r\n        super(properties, parent);\r\n\r\n        this.override(properties);\r\n    }\r\n\r\n    get x(): number {\r\n        return this._x || 0.0;\r\n    }\r\n    set x(value: number) {\r\n        this.smash();\r\n        this._x = value;\r\n    }\r\n    get y(): number {\r\n        return this._y || 0.0;\r\n    }\r\n    set y(value: number) {\r\n        this.smash();\r\n        this._y = value;\r\n    }\r\n\r\n    get width(): number {\r\n        return this._width || 0.0;\r\n    }\r\n    set width(value: number) {\r\n        this._width = value;\r\n    }\r\n\r\n    get height(): number {\r\n        return this._height || 0.0;\r\n    }\r\n    set height(value: number) {\r\n        this._height = value;\r\n    }\r\n\r\n    public rotationZ = (): number => {\r\n        return 0;\r\n    };\r\n\r\n    public doubleClick: (keys: any) => void;\r\n\r\n    public openEditor: () => void;\r\n    public closeEditor: () => void;\r\n    public drawHover: (ctx: CanvasRenderingContext2D) => void;\r\n    public setupHoverEnterDraw: () => void;\r\n    public setupHoverExitDraw: () => void;\r\n    public setupOverlapEnterDraw: () => void;\r\n    public setupOverlapExitDraw: () => void;\r\n\r\n    public sendKeys: (e: KeyboardEvent, keys: any) => void;\r\n    public preDraw: (ctx: CanvasRenderingContext2D) => void;\r\n    public postDraw: (ctx: CanvasRenderingContext2D) => void;\r\n\r\n    protected _matrix: Matrix2D | undefined;\r\n    protected _invMatrix: Matrix2D | undefined;\r\n    smash() {\r\n        this._matrix = undefined;\r\n        this._invMatrix = undefined;\r\n    }\r\n\r\n    computeBoundry(frame: cFrame): cFrame {\r\n        const mtx = this.getGlobalMatrix();\r\n        //this is a buffer so we create less garbage\r\n        const pt = frame.point;\r\n        frame.init(mtx.transformPoint(0, 0, pt));\r\n        frame.minmax(mtx.transformPoint(0, this.height, pt));\r\n        frame.minmax(mtx.transformPoint(this.width, 0, pt));\r\n        frame.minmax(mtx.transformPoint(this.width, this.height, pt));\r\n        return frame;\r\n    }\r\n\r\n    protected _boundry: cFrame = new cFrame(this);\r\n    get boundryFrame(): cFrame {\r\n        this.computeBoundry(this._boundry);\r\n\r\n        return this._boundry;\r\n    }\r\n\r\n    public drawBoundry(ctx: CanvasRenderingContext2D) {\r\n        ctx.beginPath();\r\n        ctx.setLineDash([5, 5]);\r\n        this.boundryFrame.draw(ctx, false);\r\n        ctx.stroke();\r\n    }\r\n\r\n    is2D() {\r\n        return true;\r\n    }\r\n\r\n    set(x: number, y: number, width: number, height: number): iRect {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.height = height;\r\n        return this;\r\n    }\r\n\r\n    contains(x: number, y: number): boolean {\r\n        return this.x <= x && x <= this.x + this.width && this.y <= y && y <= this.y + this.height;\r\n    }\r\n\r\n    localContains(x: number, y: number): boolean {\r\n        return 0 <= x && x <= this.width && 0 <= y && y <= this.height;\r\n    }\r\n\r\n    protected toJson(): any {\r\n        return Tools.mixin(super.toJson(), {\r\n            x: this.x,\r\n            y: this.y,\r\n            width: this.width,\r\n            height: this.height\r\n        });\r\n    }\r\n\r\n    public initialize(x: number = Number.NaN, y: number = Number.NaN, ang: number = Number.NaN) {\r\n        return this;\r\n    }\r\n\r\n    public didLocationChange(x: number = Number.NaN, y: number = Number.NaN, angle: number = Number.NaN): boolean {\r\n        let changed = false;\r\n        if (!Number.isNaN(x) && this.x !== x) {\r\n            changed = true;\r\n            this.x = x;\r\n        }\r\n\r\n        if (!Number.isNaN(y) && this.y !== y) {\r\n            changed = true;\r\n            this.y = y;\r\n        }\r\n\r\n        return changed;\r\n    }\r\n\r\n    public easeToNoLifecycle(x: number, y: number) {\r\n        this.initialize(x, y);\r\n        return this;\r\n    }\r\n\r\n    // public easeToNoLifecycle(\r\n    //   x: number,\r\n    //   y: number,\r\n    //   time: number = 0.5,\r\n    //   ease: any = Back.easeInOut\r\n    // ) {\r\n    //   TweenLite.to(this, time, {\r\n    //     x: x,\r\n    //     y: y,\r\n    //     ease: ease\r\n    //     // }).eventCallback(\"onUpdate\", () => {\r\n    //     //     this.drop();\r\n    //   }).eventCallback('onComplete', () => {\r\n    //     this.initialize(x, y);\r\n    //   });\r\n\r\n    //   return this;\r\n    // }\r\n\r\n    // public easeTo(x: number, y: number) {\r\n    //   this.initialize(x, y);\r\n    //   return this;\r\n    // }\r\n\r\n    // public easeTo(\r\n    //   x: number,\r\n    //   y: number,\r\n    //   time: number = 0.5,\r\n    //   ease: any = Back.easeInOut\r\n    // ) {\r\n    //   TweenLite.to(this, time, {\r\n    //     x: x,\r\n    //     y: y,\r\n    //     ease: ease\r\n    //   })\r\n    //     .eventCallback('onUpdate', () => {\r\n    //       this.move();\r\n    //     })\r\n    //     .eventCallback('onComplete', () => {\r\n    //       this.dropAt(x, y);\r\n    //       Lifecycle.easeTo(this, this.getLocation());\r\n    //     });\r\n\r\n    //   return this;\r\n    // }\r\n\r\n    public easeTween(to: any, time: number = 0.5) {\r\n        Lifecycle.easeTween(this, { time, undefined, to });\r\n        return this;\r\n    }\r\n\r\n    // public easeTween(to: any, time: number = 0.5, ease: any = 'ease') {\r\n    //   const from = Tools.union(to, { ease: Back[ease] });\r\n\r\n    //   TweenLite.to(this, time, from).eventCallback('onComplete', () =>\r\n    //     this.override(to)\r\n    //   );\r\n    //   Lifecycle.easeTween(this, { time, ease, to });\r\n    //   return this;\r\n    // }\r\n\r\n    public dropAt(x: number = Number.NaN, y: number = Number.NaN, angle: number = Number.NaN) {\r\n        if (this.didLocationChange(x, y, angle)) {\r\n            Lifecycle.dropped(this, this.getLocation());\r\n        }\r\n        return this;\r\n    }\r\n\r\n    public move(x: number = Number.NaN, y: number = Number.NaN, angle: number = Number.NaN) {\r\n        if (this.didLocationChange(x, y, angle)) {\r\n            Lifecycle.moved(this, this.getLocation());\r\n        }\r\n        return this;\r\n    }\r\n\r\n    public moveTo(loc: iPoint2D, offset?: iPoint2D) {\r\n        const x = loc.x + (offset && offset.x ? offset.x : 0);\r\n        const y = loc.y + (offset && offset.y ? offset.y : 0);\r\n        return this.move(x, y);\r\n    }\r\n\r\n    public moveBy(loc: iPoint2D, offset?: iPoint2D) {\r\n        const x = this.x + loc.x + (offset && offset.x ? offset.x : 0);\r\n        const y = this.y + loc.y + (offset && offset.y ? offset.y : 0);\r\n        return this.move(x, y);\r\n    }\r\n\r\n    updateContext(ctx: CanvasRenderingContext2D) {\r\n        const mtx = this.getMatrix();\r\n        ctx.transform(mtx.a, mtx.b, mtx.c, mtx.d, mtx.tx, mtx.ty);\r\n        ctx.globalAlpha *= this.opacity;\r\n    }\r\n\r\n    getGlobalMatrix() {\r\n        const mtx = new Matrix2D(this.getMatrix());\r\n        const parent: foGlyph2D | undefined = this.myParent && (this.myParent() as foGlyph2D | undefined);\r\n        if (parent) {\r\n            mtx.prependMatrix(parent.getGlobalMatrix());\r\n        }\r\n        return mtx;\r\n    }\r\n\r\n    getMatrix() {\r\n        if (this._matrix === undefined) {\r\n            this._matrix = new Matrix2D();\r\n            this._matrix.appendTransform(this.x, this.y, 1, 1, 0, 0, 0, 0, 0);\r\n        }\r\n        return this._matrix;\r\n    }\r\n\r\n    getInvMatrix() {\r\n        if (this._invMatrix === undefined) {\r\n            this._invMatrix = this.getMatrix().invertCopy();\r\n        }\r\n        return this._invMatrix;\r\n    }\r\n\r\n    localToGlobal(x: number, y: number, pt?: cPoint2D) {\r\n        const mtx = this.getGlobalMatrix();\r\n        return mtx.transformPoint(x, y, pt);\r\n    }\r\n\r\n    localToGlobalPoint(pt: cPoint2D): cPoint2D {\r\n        const mtx = this.getGlobalMatrix();\r\n        return mtx.transformPoint(pt.x, pt.y, pt);\r\n    }\r\n\r\n    globalToLocal(x: number, y: number, pt?: cPoint2D): cPoint2D {\r\n        const inv = this.getGlobalMatrix().invertCopy();\r\n        return inv.transformPoint(x, y, pt);\r\n    }\r\n\r\n    globalToLocalPoint(pt: cPoint2D): cPoint2D {\r\n        const inv = this.getGlobalMatrix().invertCopy();\r\n        return inv.transformPoint(pt.x, pt.y, pt);\r\n    }\r\n\r\n    globalToLocalFrame(x1: number, y1: number, x2: number, y2: number, frame?: cFrame): cFrame {\r\n        frame = frame || new cFrame();\r\n        const inv = this.getGlobalMatrix().invertCopy();\r\n\r\n        frame.init(inv.transformPoint(x1, y1, frame.point));\r\n        frame.minmax(inv.transformPoint(x1, y2, frame.point));\r\n        frame.minmax(inv.transformPoint(x2, y1, frame.point));\r\n        frame.minmax(inv.transformPoint(x2, y2, frame.point));\r\n        return frame;\r\n    }\r\n\r\n    localToLocal(x: number, y: number, target: foGlyph2D, pt?: cPoint2D): cPoint2D {\r\n        pt = this.localToGlobal(x, y, pt);\r\n        return target.globalToLocal(pt.x, pt.y, pt);\r\n    }\r\n\r\n    globalCenter(): cPoint2D {\r\n        const { x, y } = this.pinLocation();\r\n        const mtx = this.getGlobalMatrix();\r\n        return mtx.transformPoint(x, y);\r\n    }\r\n\r\n    public isDragable = (): boolean => {\r\n        return true;\r\n    };\r\n\r\n    public getOffset = (loc: iPoint2D): iPoint2D => {\r\n        const x = this.x;\r\n        const y = this.y;\r\n        return new cPoint2D(x - loc.x, y - loc.y);\r\n    };\r\n\r\n    public getLocation = (): any => {\r\n        return {\r\n            x: this.x,\r\n            y: this.y,\r\n            z: 0\r\n        };\r\n    };\r\n\r\n    public pinLocation(): any {\r\n        return {\r\n            x: 0,\r\n            y: 0,\r\n            z: 0\r\n        };\r\n    }\r\n\r\n    public setLocation = (loc?: iPoint2D) => {\r\n        this.x = loc ? loc.x : 0;\r\n        this.y = loc ? loc.y : 0;\r\n    };\r\n\r\n    protected localHitTest = (hit: iPoint2D): boolean => {\r\n        const { x, y } = hit;\r\n        const loc = this.globalToLocal(x, y);\r\n\r\n        if (loc.x < 0) return false;\r\n        if (loc.x > this.width) return false;\r\n\r\n        if (loc.y < 0) return false;\r\n        if (loc.y > this.height) return false;\r\n        return true;\r\n    };\r\n\r\n    public hitTest = (hit: iPoint2D): boolean => {\r\n        return this.isHitable && this.isVisible && this.localHitTest(hit);\r\n    };\r\n\r\n    public overlapTest = (hit: iFrame): boolean => {\r\n        const frame = this.globalToLocalFrame(hit.x1, hit.y1, hit.x2, hit.y2);\r\n\r\n        if (this.localContains(frame.x1, frame.y1)) return true;\r\n        if (this.localContains(frame.x1, frame.y2)) return true;\r\n        if (this.localContains(frame.x2, frame.y1)) return true;\r\n        if (this.localContains(frame.x2, frame.y2)) return true;\r\n        return false;\r\n    };\r\n\r\n    findObjectUnderPoint(hit: iPoint2D, deep: boolean): foGlyph2D {\r\n        let found: foGlyph2D = this.hitTest(hit) ? this : undefined;\r\n\r\n        //   if (deep) {\r\n        //     const child = this.findChildObjectUnderPoint(hit);\r\n        //     found = child ? child : found;\r\n        //   }\r\n        return found;\r\n    }\r\n\r\n    public afterRender = (ctx: CanvasRenderingContext2D, deep: boolean = true) => {\r\n        ctx.save();\r\n        ctx.lineWidth = 4;\r\n        ctx.strokeStyle = 'pink';\r\n        this.drawBoundry(ctx);\r\n        ctx.restore();\r\n\r\n        // deep &&\r\n        //   this.nodes.forEach(item => {\r\n        //     item.afterRender(ctx, deep);\r\n        //   });\r\n    };\r\n\r\n    public render(ctx: CanvasRenderingContext2D, deep: boolean = true): foGlyph2D | undefined {\r\n        if (this.isInvisible) return;\r\n        ctx.save();\r\n\r\n        //this.drawOrigin(ctx);\r\n        this.updateContext(ctx);\r\n        //this.drawOriginX(ctx);\r\n\r\n        this.preDraw && this.preDraw(ctx);\r\n        this.draw(ctx);\r\n        this.drawHover && this.drawHover(ctx);\r\n        this.postDraw && this.postDraw(ctx);\r\n\r\n        // this.isSelected && this.drawSelected(ctx);\r\n\r\n        // deep &&\r\n        //   this.nodes.forEach(item => {\r\n        //     item.render(ctx, deep);\r\n        //   });\r\n\r\n        ctx.restore();\r\n        return this;\r\n    }\r\n\r\n    public drawFont(ctx: CanvasRenderingContext2D, size: number = 20, fontFamily: string = 'Arial', align: any = 'center', base: any = 'middle') {\r\n        ctx.textAlign = align;\r\n        ctx.textBaseline = base;\r\n        ctx.font = `${size}px ${fontFamily}`;\r\n    }\r\n\r\n    //https://stackoverflow.com/questions/6061880/html5-canvas-circle-text\r\n\r\n    public drawTextCircle = (ctx: CanvasRenderingContext2D, text: string, radius: number = 100, start: number = Math.PI / 2, x: number = 0, y: number = 0): void => {\r\n        if (text) {\r\n            ctx.save();\r\n            ctx.textAlign = 'center';\r\n            ctx.textBaseline = 'middle';\r\n            ctx.translate(x, y);\r\n            ctx.rotate(start - Math.PI / 2);\r\n\r\n            let len = text.length;\r\n            for (let i = 0; i < len; i++) {\r\n                let s = text[i];\r\n                let letterAngle = 0.5 * (ctx.measureText(s).width / radius);\r\n\r\n                ctx.rotate(letterAngle);\r\n                ctx.save();\r\n\r\n                ctx.translate(0, -radius);\r\n                ctx.fillText(s, 0, 0);\r\n                ctx.restore();\r\n\r\n                ctx.rotate(letterAngle);\r\n            }\r\n            ctx.restore();\r\n        }\r\n    };\r\n\r\n    public drawText = (ctx: CanvasRenderingContext2D, text: string, x: number = 0, y: number = 0): void => {\r\n        if (text) {\r\n            ctx.fillText(text, x, y);\r\n        }\r\n    };\r\n\r\n    public drawPin(ctx: CanvasRenderingContext2D) {\r\n        const { x, y } = this.pinLocation();\r\n\r\n        ctx.save();\r\n        ctx.beginPath();\r\n\r\n        ctx.arc(x, y, 6, 0, 2 * Math.PI, false);\r\n        ctx.fillStyle = 'pink';\r\n        ctx.fill();\r\n        ctx.lineWidth = 1;\r\n        ctx.strokeStyle = '#003300';\r\n        ctx.stroke();\r\n        ctx.restore();\r\n    }\r\n\r\n    public drawOrigin(ctx: CanvasRenderingContext2D) {\r\n        const { x, y } = this.pinLocation();\r\n\r\n        ctx.save();\r\n        ctx.beginPath();\r\n        ctx.setLineDash([5, 5]);\r\n        ctx.moveTo(x - 50, y);\r\n        ctx.lineTo(x + 50, y);\r\n        ctx.moveTo(x, y - 50);\r\n        ctx.lineTo(x, y + 50);\r\n        ctx.lineWidth = 1;\r\n        ctx.strokeStyle = '#003300';\r\n        ctx.stroke();\r\n        ctx.restore();\r\n    }\r\n\r\n    public drawOriginX(ctx: CanvasRenderingContext2D) {\r\n        const { x, y } = this.pinLocation();\r\n\r\n        ctx.save();\r\n        ctx.beginPath();\r\n        ctx.setLineDash([5, 5]);\r\n        ctx.moveTo(x - 50, y - 50);\r\n        ctx.lineTo(x + 50, y + 50);\r\n        ctx.moveTo(x + 50, y - 50);\r\n        ctx.lineTo(x - 50, y + 50);\r\n        ctx.lineWidth = 1;\r\n        ctx.strokeStyle = '#003300';\r\n        ctx.stroke();\r\n        ctx.restore();\r\n    }\r\n\r\n    public drawHighlight(ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.strokeStyle = 'yellow';\r\n        ctx.lineWidth = 4;\r\n        this.drawOutline(ctx);\r\n        ctx.restore();\r\n    }\r\n\r\n    public drawHighlightOverlap(ctx: CanvasRenderingContext2D) {\r\n        ctx.strokeStyle = 'green';\r\n        ctx.lineWidth = 8;\r\n        this.drawOutline(ctx);\r\n        ctx.strokeStyle = 'yellow';\r\n        ctx.lineWidth = 4;\r\n        this.drawOutline(ctx);\r\n    }\r\n\r\n    public drawOutline(ctx: CanvasRenderingContext2D) {\r\n        ctx.beginPath();\r\n        ctx.setLineDash([15, 5]);\r\n        ctx.rect(0, 0, this.width, this.height);\r\n        ctx.stroke();\r\n    }\r\n\r\n    public drawSelected = (ctx: CanvasRenderingContext2D): void => {\r\n        ctx.strokeStyle = 'red';\r\n        ctx.lineWidth = 4;\r\n        this.drawOutline(ctx);\r\n        //this.drawHandles(ctx);\r\n        this.drawPin(ctx);\r\n    };\r\n\r\n    public draw = (ctx: CanvasRenderingContext2D): void => {\r\n        ctx.fillStyle = this.color;\r\n        ctx.lineWidth = 1;\r\n        ctx.fillRect(0, 0, this.width, this.height);\r\n    };\r\n\r\n    toggleSelected() {\r\n        this.isSelected = !this.isSelected;\r\n    }\r\n\r\n    // layoutSubcomponentsVertical(resize: boolean = true, space: number = 0) {\r\n    //   let loc = this.getLocation() as cPoint2D;\r\n    //   const self = this;\r\n\r\n    //   if (resize) {\r\n    //     self.height = self.width = 0;\r\n    //     loc.x = loc.y = 0;\r\n    //   } else {\r\n    //     loc = this.nodes.first().getLocation() as cPoint2D;\r\n    //   }\r\n\r\n    //   this.nodes.forEach(item => {\r\n    //     item.setLocation(loc);\r\n    //   });\r\n\r\n    //   this.nodes.forEach(item => {\r\n    //     const { x: pinX, y: pinY } = item.pinLocation();\r\n    //     loc.x = resize ? pinX : loc.x;\r\n    //     loc.y += pinY;\r\n    //     item.easeToNoLifecycle(loc.x, loc.y);\r\n    //     loc.y += space + item.height - pinY;\r\n\r\n    //     if (resize) {\r\n    //       self.width = Math.max(self.width, item.width);\r\n    //       self.height = loc.y;\r\n    //     }\r\n    //   });\r\n\r\n    //   Lifecycle.layout(this, {\r\n    //     method: 'layoutSubcomponentsVertical',\r\n    //     resize,\r\n    //     space\r\n    //   });\r\n    //   return this;\r\n    // }\r\n\r\n    // layoutSubcomponentsHorizontal(resize: boolean = true, space: number = 0) {\r\n    //   let loc = this.getLocation() as cPoint2D;\r\n    //   const self = this;\r\n\r\n    //   if (resize) {\r\n    //     self.height = self.width = 0;\r\n    //     loc.x = loc.y = 0;\r\n    //   } else {\r\n    //     loc = this.nodes.first().getLocation() as cPoint2D;\r\n    //   }\r\n\r\n    //   this.nodes.forEach(item => {\r\n    //     item.setLocation(loc);\r\n    //   });\r\n\r\n    //   this.nodes.forEach(item => {\r\n    //     const { x: pinX, y: pinY } = item.pinLocation();\r\n    //     loc.x += pinX;\r\n    //     loc.y = resize ? pinY : loc.y;\r\n    //     item.easeToNoLifecycle(loc.x, loc.y);\r\n    //     loc.x += space + item.width - pinX;\r\n\r\n    //     if (resize) {\r\n    //       self.width = loc.x;\r\n    //       self.height = Math.max(self.height, item.height);\r\n    //     }\r\n    //   });\r\n\r\n    //   Lifecycle.layout(this, {\r\n    //     method: 'layoutSubcomponentsHorizontal',\r\n    //     resize,\r\n    //     space\r\n    //   });\r\n    //   return this;\r\n    // }\r\n\r\n    //\r\n\r\n    // layoutMarginTop(resize: boolean = false, space: number = 0) {\r\n    //   const loc = this.getLocation() as cPoint2D;\r\n    //   const self = this;\r\n\r\n    //   loc.x = 10;\r\n    //   loc.y = space + this.height;\r\n\r\n    //   this.nodes.forEach(item => {\r\n    //     const { x: pinX, y: pinY } = item.pinLocation();\r\n    //     loc.y += pinY;\r\n    //     item.easeToNoLifecycle(loc.x + pinX, loc.y);\r\n    //     loc.y += space + item.height - pinY;\r\n\r\n    //     if (resize) {\r\n    //       self.width = Math.max(self.width, item.width);\r\n    //       self.height = loc.y;\r\n    //     }\r\n    //   });\r\n    //   Lifecycle.layout(this, { method: 'layoutMarginTop', resize, space });\r\n    //   return this;\r\n    // }\r\n}\r\n","import { foObject } from './foObject.model';\r\nimport { iObject, Action, Func } from './foInterface';\r\n\r\n//we want foCollection to be observable\r\n\r\nexport class foCollection<T extends iObject> extends foObject {\r\n    protected _members: Array<T>;\r\n\r\n    isHidden: boolean = false;\r\n    isSelectable: boolean = true;\r\n    constructor(list?: Array<T>) {\r\n        super();\r\n\r\n        this._members = new Array<T>();\r\n        list && list.forEach((item) => this.addMember(item));\r\n    }\r\n\r\n    getChildAt(i: number): T {\r\n        return this._members[i];\r\n    }\r\n\r\n    isEmpty(): boolean {\r\n        return this._members.length === 0;\r\n    }\r\n\r\n    clearAll() {\r\n        this._members = [];\r\n    }\r\n\r\n    get length() {\r\n        return this._members.length;\r\n    }\r\n\r\n    get count() {\r\n        return this._members.length;\r\n    }\r\n\r\n    get hasMembers(): boolean {\r\n        return this.length > 0;\r\n    }\r\n\r\n    map(funct: any) {\r\n        return this._members.map(funct);\r\n    }\r\n\r\n    forEach(funct: Action<T>) {\r\n        this._members.forEach(funct);\r\n    }\r\n\r\n    first() {\r\n        return this._members[0];\r\n    }\r\n\r\n    last() {\r\n        return this._members[this._members.length - 1];\r\n    }\r\n\r\n    filter(funct: Func<T, boolean>) {\r\n        return this._members.filter(funct);\r\n    }\r\n\r\n    find(funct: Func<T, boolean>) {\r\n        return this._members.find(funct);\r\n    }\r\n\r\n    findMember(name: string): any {\r\n        const found = this._members.find((item) => {\r\n            return item.myName === name || item.myGuid === name;\r\n        });\r\n        return found;\r\n    }\r\n\r\n    getMember(id: any): any {\r\n        return this._members[id];\r\n    }\r\n\r\n    copyMembers(list: foCollection<T>): foCollection<T> {\r\n        list.members.forEach((item) => {\r\n            this.addMember(item);\r\n        });\r\n        return this;\r\n    }\r\n\r\n    isMember(item: T) {\r\n        const loc = this._members.indexOf(item);\r\n        return loc !== -1;\r\n    }\r\n\r\n    push(obj: any) {\r\n        this._members.push(obj);\r\n    }\r\n    shift(): any {\r\n        return this._members.shift();\r\n    }\r\n\r\n    addMember(obj: T): T {\r\n        this._members.push(obj);\r\n        return obj;\r\n    }\r\n\r\n    removeMembers(list: foCollection<T>): foCollection<T> {\r\n        list.members.forEach((item) => {\r\n            this.removeMember(item);\r\n        });\r\n        return this;\r\n    }\r\n\r\n    removeMember(obj: T): T {\r\n        const index = this._members.indexOf(obj);\r\n        if (index > -1) {\r\n            this._members.splice(index, 1);\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    get members() {\r\n        return this._members;\r\n    }\r\n\r\n    get publicMembers() {\r\n        return this.members.filter((item) => item.isPublic);\r\n    }\r\n\r\n    moveToTop(item: T) {\r\n        const loc = this._members.indexOf(item);\r\n        if (loc !== -1) {\r\n            this._members.splice(loc, 1);\r\n            this._members.push(item);\r\n        }\r\n        return this._members;\r\n    }\r\n\r\n    moveToBottom(item: T) {\r\n        const loc = this._members.indexOf(item);\r\n        if (loc !== -1) {\r\n            this._members.splice(loc, 1);\r\n            this._members.unshift(item);\r\n        }\r\n        return this._members;\r\n    }\r\n\r\n    protected toJson(): any {\r\n        if (this.hasMembers) {\r\n            const local = super.toJson();\r\n            local.members = this._members.map((item) => item.asJson);\r\n            return local;\r\n        }\r\n        return {};\r\n    }\r\n\r\n    public isEqualTo(obj: foCollection<T>, deep: boolean = true) {\r\n        const result = true;\r\n        return result;\r\n    }\r\n}\r\n","export enum foNames {\r\n    UNKNOWN = 'unknown',\r\n    AT = '@',\r\n    THIS = 'this',\r\n    SELF = 'self',\r\n    ROOT = 'root'\r\n}\r\n\r\n// Converts numeric degrees to radians\r\n// if (typeof (Number.prototype.toRad) === \"undefined\") {\r\n//     Number.prototype.toRad = function () {\r\n//         return this * Math.PI / 180;\r\n//     }\r\n// }\r\n// if (typeof (Number.prototype.toDeg) === \"undefined\") {\r\n//     Number.prototype.toDeg = function () {\r\n//         return this * 180 / Math.PI;\r\n//     }\r\n// }\r\n\r\nexport class foTools {\r\n    // Speed up calls to hasOwnProperty\r\n    private hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\r\n    /**\r\n     * http://stackoverflow.com/questions/6588977/how-to-to-extract-a-javascript-function-from-a-javascript-file\r\n     * @param funct\r\n     */\r\n    getFunctionName(funct: string) {\r\n        let ret = funct.toString(); // do with regx\r\n        ret = ret.substr('function '.length);\r\n        ret = ret.substr(0, ret.indexOf('('));\r\n        return ret.trim();\r\n    }\r\n\r\n    // http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript\r\n    generateUUID() {\r\n        let d = new Date().getTime();\r\n        const uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n            // tslint:disable-next-line:no-bitwise\r\n            const r = (d + Math.random() * 16) % 16 | 0;\r\n            d = Math.floor(d / 16);\r\n            // tslint:disable-next-line:no-bitwise\r\n            return (c === 'x' ? r : (r & 0x7) | 0x8).toString(16);\r\n        });\r\n        return uuid;\r\n    }\r\n\r\n    asJson(target: any) {\r\n        const result = this.stringify(target);\r\n        return JSON.parse(result);\r\n    }\r\n\r\n    stringify(target: any, func: Function = undefined, deep = 3) {\r\n        function resolveReference(value: any) {\r\n            if (value && value.asReference) {\r\n                return 'resolveRef(' + value.asReference() + ',' + value.constructor.name + ')';\r\n            }\r\n            return value;\r\n        }\r\n        function resolveCircular(key: any, value: any) {\r\n            switch (key) {\r\n                case 'myParent':\r\n                    return resolveReference(value);\r\n                case 'myMembers':\r\n                    return value\r\n                        ? value.map((item: any) => {\r\n                              return resolveReference(item);\r\n                          })\r\n                        : value;\r\n                case '_lookup':\r\n                    return value;\r\n                case '_members':\r\n                    return value;\r\n                case 'gridApis':\r\n                    return '';\r\n                case 'columnApis':\r\n                    return '';\r\n            }\r\n            if (key.startsWith('_')) {\r\n                return;\r\n            }\r\n            // if (this.isCustomLinkName(key)) {\r\n            //    return resolveReference(value);\r\n            // }\r\n\r\n            return value;\r\n        }\r\n\r\n        return JSON.stringify(target, resolveCircular, deep);\r\n    }\r\n\r\n    splitNamespaceType(id: string, primitive?: string) {\r\n        const typeId = id.split('::');\r\n        let result = { namespace: '', name: id };\r\n        if (typeId.length === 2) {\r\n            result = {\r\n                namespace: typeId[0],\r\n                name: typeId[1]\r\n            };\r\n        } else if (primitive) {\r\n            result = {\r\n                namespace: typeId[0],\r\n                name: primitive\r\n            };\r\n        }\r\n        return result;\r\n    }\r\n\r\n    getNamespace(obj: any) {\r\n        let myNamespace = obj.myType ? obj.myType.split('::') : [''];\r\n        myNamespace = myNamespace[0];\r\n        return myNamespace;\r\n    }\r\n\r\n    getType(obj: any): string {\r\n        let myType = obj.myType ? obj.myType.split('::') : [''];\r\n        myType = myType.length === 2 ? myType[1] : myType[0];\r\n        return myType;\r\n    }\r\n\r\n    namespace(namespace: string, name: string) {\r\n        return `${namespace}::${name}`;\r\n    }\r\n\r\n    randomInt(low: number, high: number) {\r\n        return low + Math.floor(Math.random() * (high - low + 1));\r\n    }\r\n\r\n    random(low: number, high: number) {\r\n        return low + Math.random() * (high - low);\r\n    }\r\n\r\n    randomRGBColor() {\r\n        // tslint:disable-next-line:no-bitwise\r\n        const r = (255 * Math.random()) | 0;\r\n        // tslint:disable-next-line:no-bitwise\r\n        const g = (255 * Math.random()) | 0;\r\n        // tslint:disable-next-line:no-bitwise\r\n        const b = (255 * Math.random()) | 0;\r\n        return `rgb(${r},${g},${b})`;\r\n    }\r\n\r\n    randomName() {\r\n        const names = ['Llam', 'Noah', 'Oliver', 'Elijah', 'Lucas', 'Mason', 'Henry', 'Logan', 'Sebastian', 'Wyatt', 'Carter', 'Isaac', 'Dylan', 'Aaron'];\r\n        const index = this.randomInt(0, names.length - 1);\r\n        const result = `${names[index]}_${this.randomInt(0, names.length - 1)}`;\r\n        return result;\r\n    }\r\n\r\n    randomThing() {\r\n        const things = ['Farmhouse', 'Barn', 'Silo', 'Garage', 'Box Truck', 'Yellow House', 'School', 'Brick Building', 'Statue'];\r\n        const index = this.randomInt(0, things.length - 1);\r\n        const result = `${things[index]}_${this.randomInt(0, things.length - 1)}`;\r\n        return result;\r\n    }\r\n\r\n    matches(str1: string, str2: string) {\r\n        if (str1 === str2) {\r\n            return true;\r\n        }\r\n        return str1 && str2 && str1.toLocaleLowerCase() === str2.toLocaleLowerCase();\r\n    }\r\n\r\n    startsWith(str1: string, str2: string) {\r\n        if (str1 === str2) {\r\n            return true;\r\n        }\r\n        return str1 && str2 && str1.toLocaleLowerCase().startsWith(str2.toLocaleLowerCase());\r\n    }\r\n\r\n    capitalizeFirstLetter(str1: string) {\r\n        return str1.charAt(0).toUpperCase() + str1.slice(1);\r\n    }\r\n\r\n    capitalize(s: string) {\r\n        return Tools.isEmpty(s) ? s : Tools.capitalizeFirstLetter(s);\r\n    }\r\n\r\n    isSelf(ref: any) {\r\n        return this.matches(ref, foNames.AT) || this.matches(ref, foNames.THIS) || this.matches(ref, foNames.SELF);\r\n    }\r\n\r\n    isArray(obj: any) {\r\n        if (Array.isArray) {\r\n            return Array.isArray(obj);\r\n        }\r\n        return Object.prototype.toString.call(obj) === '[object Array]' ? true : false;\r\n    }\r\n\r\n    isFunction(obj: any) {\r\n        return typeof obj === 'function';\r\n    }\r\n\r\n    isString(obj: any) {\r\n        return typeof obj === 'string';\r\n    }\r\n\r\n    isNumber(obj: any) {\r\n        return typeof obj === 'number';\r\n    }\r\n\r\n    isDate(obj: any) {\r\n        return obj instanceof Date;\r\n    }\r\n\r\n    isObject(obj: any) {\r\n        return obj && typeof obj === 'object'; // prevents typeOf null === 'object'\r\n    }\r\n\r\n    isCustomLinkName(key: any) {\r\n        return false;\r\n    }\r\n\r\n    isTyped(obj: any) {\r\n        return obj && obj.isInstanceOf;\r\n    }\r\n\r\n    isEmpty(obj: any) {\r\n        // null and undefined are \"empty\"\r\n        if (obj == null) {\r\n            return true;\r\n        }\r\n\r\n        // Assume if it has a length property with a non-zero value\r\n        // that that property is correct.\r\n        if (obj.length > 0) {\r\n            return false;\r\n        }\r\n        if (obj.length === 0) {\r\n            return true;\r\n        }\r\n\r\n        // If it isn't an object at this point\r\n        // it is empty, but it can't be anything *but* empty\r\n        // Is it empty?  Depends on your application.\r\n        if (typeof obj !== 'object') {\r\n            return true;\r\n        }\r\n\r\n        // Otherwise, does it have any properties of its own?\r\n        // Note that this doesn't handle\r\n        // toString and valueOf enumeration bugs in IE < 9\r\n        // tslint:disable-next-line:prefer-const\r\n        for (let key in obj) {\r\n            if (this.hasOwnProperty.call(obj, key)) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    replaceSpaces(str: string) {\r\n        return str.replace(/[\\s]/g, '_');\r\n    }\r\n\r\n    removeSpaces(str: string) {\r\n        return str.replace(/[\\s]/g, '_');\r\n    }\r\n\r\n    removeSpecial(str: string) {\r\n        return str.replace(/[^a-zA-Z 0-9]+/g, '');\r\n    }\r\n\r\n    toVirtualFolder(str: string) {\r\n        let result = this.removeSpecial(str);\r\n        result = this.removeSpaces(result);\r\n        return result.toLocaleLowerCase();\r\n    }\r\n\r\n    applyTemplate(str: string, obj: any) {\r\n        let result = str || '';\r\n        const keys = Object.keys(obj);\r\n        for (const key of keys) {\r\n            const name = '{' + key + '}';\r\n            const value = obj[key];\r\n            result = result.replace(name, value);\r\n        }\r\n        // result = this.removeSpecial(result);\r\n        // result = this.removeSpaces(result);\r\n        return result;\r\n    }\r\n\r\n    removeDQ(str: string): string {\r\n        return str.replace(/^\"(.*)\"$/, '$1');\r\n    }\r\n\r\n    unwrap(str: string): string {\r\n        return str.substring(1, str.length - 1);\r\n    }\r\n\r\n    wrapDQ(str: string): string {\r\n        return `\"${str}\"`;\r\n    }\r\n\r\n    wrapSQ(str: string): string {\r\n        return `'${str}'`;\r\n    }\r\n\r\n    decomposeHostPath(filename: string) {\r\n        let string = filename.toLowerCase();\r\n        string = string.replace('http://', '');\r\n        string = string.replace('https://', '');\r\n\r\n        const host = string.split('/')[0];\r\n        const path = string.replace(host, '');\r\n        return {\r\n            fullpath: filename,\r\n            host,\r\n            path\r\n        };\r\n    }\r\n\r\n    extend(target: any, source: any) {\r\n        if (!source) {\r\n            return target;\r\n        }\r\n        // tslint:disable-next-line:prefer-const\r\n        for (let key in source) {\r\n            if (this.hasOwnProperty.call(source, key)) {\r\n                target[key] = source[key];\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n\r\n    mixin(target: any, source: any) {\r\n        if (!source) {\r\n            return target;\r\n        }\r\n        if (!target) {\r\n            return source;\r\n        }\r\n\r\n        for (const key of source) {\r\n            target[key] = source[key];\r\n        }\r\n        return target;\r\n    }\r\n\r\n    mixExact(target: any, source: any) {\r\n        if (!source) {\r\n            return target;\r\n        }\r\n        if (!target) {\r\n            return source;\r\n        }\r\n        for (const key in source) {\r\n            if (foTools.hasOwnProperty.call(target, key)) {\r\n                target[key] = source[key];\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n\r\n    mixout(target: any, source: any) {\r\n        if (!source) {\r\n            return target;\r\n        }\r\n        if (!target) {\r\n            return source;\r\n        }\r\n        for (const key in source) {\r\n            if (this.hasOwnProperty.call(target, key)) {\r\n                delete target[key];\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n\r\n    extract(target: any, keys?: string[]) {\r\n        const spec: any = {};\r\n        // tslint:disable-next-line: no-unused-expression\r\n        keys &&\r\n            keys.forEach((key) => {\r\n                spec[key] = target[key];\r\n            });\r\n        return spec;\r\n    }\r\n\r\n    mixMap(target: any, source: any) {\r\n        if (!source) {\r\n            return target;\r\n        }\r\n\r\n        const result: any = {};\r\n        for (const key of target) {\r\n            const keyMap = source[key] || key;\r\n            result[keyMap] = target[key];\r\n        }\r\n        return result;\r\n    }\r\n\r\n    intersect(target: any, source: any) {\r\n        if (!source) {\r\n            return target;\r\n        }\r\n        if (!target) {\r\n            return source;\r\n        }\r\n        const intersect: any = {};\r\n        for (const key in target) {\r\n            if (this.hasOwnProperty.call(source, key)) {\r\n                intersect[key] = source[key];\r\n            } else {\r\n                intersect[key] = target[key];\r\n            }\r\n        }\r\n        return intersect;\r\n    }\r\n\r\n    union(target: any, source: any) {\r\n        const result: any = {};\r\n        if (target) {\r\n            for (const key of target) {\r\n                result[key] = target[key];\r\n            }\r\n        }\r\n        if (source) {\r\n            for (const key of source) {\r\n                result[key] = source[key];\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    defineValueProperty(target: any, name: string, value: any) {\r\n        Object.defineProperty(target, name, {\r\n            value,\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        return target;\r\n    }\r\n\r\n    defineComputeOnlyProperty(target: any, name: string, func: () => any) {\r\n        // var self = target;\r\n        Object.defineProperty(target, name, {\r\n            enumerable: true,\r\n            configurable: true,\r\n            get: func\r\n        });\r\n        return target;\r\n    }\r\n\r\n    defineCalculatedProperty(target: any, name: string, func: () => any) {\r\n        // var self = target;\r\n        Object.defineProperty(target, name, {\r\n            enumerable: true,\r\n            configurable: true,\r\n            get: func, // .call(self, self),\r\n            set(value) {\r\n                this[`_${name}`] = value;\r\n            }\r\n        });\r\n        return target;\r\n    }\r\n\r\n    getMethods(obj: any) {\r\n        const list: any[] = [];\r\n        for (const m in obj.prototype) {\r\n            if (typeof obj[m] === 'function') {\r\n                list.push(m);\r\n            }\r\n        }\r\n        return list;\r\n    }\r\n\r\n    asArray(obj: any, funct?: any) {\r\n        if (this.isArray(obj)) {\r\n            return obj;\r\n        }\r\n        return this.mapOverKeyValue(obj, (key: any, value: any) => {\r\n            return funct ? funct(key, value) : value;\r\n        });\r\n    }\r\n\r\n    applyOverKeyValue(obj: any, mapFunc: any) {\r\n        // funct has 2 args.. key,value\r\n        const body: any = {};\r\n        const keys = obj ? Object.keys(obj) : [];\r\n        keys.forEach((key) => {\r\n            if (this.hasOwnProperty.call(obj, key)) {\r\n                const value = obj[key];\r\n                const result = mapFunc(key, value);\r\n                if (result) {\r\n                    body[key] = result;\r\n                }\r\n            }\r\n        });\r\n        return body;\r\n    }\r\n\r\n    mapOverKeyValue(obj: any, mapFunc: any): [] {\r\n        // funct has 2 args.. key,value\r\n        const list: any = [];\r\n        const keys = obj ? Object.keys(obj) : [];\r\n        keys.forEach((key) => {\r\n            if (this.hasOwnProperty.call(obj, key)) {\r\n                const value: any = obj[key];\r\n                const result: any = mapFunc(key, value);\r\n                if (result) {\r\n                    list.push(result);\r\n                }\r\n            }\r\n        });\r\n        return list;\r\n    }\r\n\r\n    forEachKeyValue(obj: any, mapFunc: any) {\r\n        // funct has 2 args.. key,value\r\n        const keys = obj ? Object.keys(obj) : [];\r\n        keys.forEach((key) => {\r\n            if (this.hasOwnProperty.call(obj, key)) {\r\n                const value = obj[key];\r\n                mapFunc(key, value);\r\n            }\r\n        });\r\n    }\r\n\r\n    findKeyForValue(obj: any, key: any) {\r\n        for (const name in obj) {\r\n            if (this.hasOwnProperty.call(obj, key)) {\r\n                if (obj[name].matches(key)) {\r\n                    return name;\r\n                }\r\n            }\r\n        }\r\n        return obj;\r\n    }\r\n    addToListByKey(target: any, key: string, value: any) {\r\n        if (!target[key]) {\r\n            target[key] = [value];\r\n        } else {\r\n            target[key].push(value);\r\n        }\r\n    }\r\n\r\n    extractReadWriteKeys(spec: any) {\r\n        const keys: string[] = [];\r\n        Tools.forEachKeyValue(spec, (k: any, v: any) => {\r\n            if (!Tools.isFunction(v)) {\r\n                keys.push(k);\r\n            }\r\n        });\r\n        return keys;\r\n    }\r\n\r\n    extractComputedKeys(spec: any) {\r\n        const keys: string[] = [];\r\n        Tools.forEachKeyValue(spec, (k: any, v: any) => {\r\n            if (Tools.isFunction(v)) {\r\n                keys.push(k);\r\n            }\r\n        });\r\n        return keys;\r\n    }\r\n\r\n    overrideComputed(obj: any, properties: any) {\r\n        Tools.forEachKeyValue(properties, (key: any, value: any) => {\r\n            try {\r\n                if (Tools.isFunction(value)) {\r\n                    Tools.defineCalculatedProperty(obj, key, value);\r\n                } else {\r\n                    obj[key] = value;\r\n                }\r\n            } catch (ex) {\r\n                console.log(ex);\r\n            }\r\n        });\r\n    }\r\n\r\n    extendComputed(obj: any, properties: any) {\r\n        Tools.forEachKeyValue(properties, (key: any, value: any) => {\r\n            try {\r\n                if (!obj[key]) {\r\n                    if (Tools.isFunction(value)) {\r\n                        Tools.defineCalculatedProperty(obj, key, value);\r\n                    } else {\r\n                        obj[key] = value;\r\n                    }\r\n                }\r\n            } catch (ex) {\r\n                console.log(ex);\r\n            }\r\n        });\r\n    }\r\n\r\n    pluck(name: string) {\r\n        return (x: any) => {\r\n            return x[name];\r\n        };\r\n    }\r\n\r\n    distinctItems(list: []) {\r\n        const distinct = {};\r\n        list.forEach((item) => {\r\n            distinct[item] = item;\r\n        });\r\n        return Object.keys(distinct);\r\n    }\r\n\r\n    groupBy(pluckBy: any, list: []) {\r\n        const dictionary: any = {};\r\n        list.forEach((item) => {\r\n            const key = pluckBy(item);\r\n            if (!dictionary[key]) {\r\n                dictionary[key] = [];\r\n            }\r\n            dictionary[key].push(item);\r\n        });\r\n        return dictionary;\r\n    }\r\n    mergeGroups(g1: any, g2: any) {\r\n        const dictionary: any = {};\r\n        Object.keys(g1).forEach((key) => {\r\n            const item1 = g1[key];\r\n            const item2 = g2[key];\r\n            if (item2) {\r\n                dictionary[key] = [...item2, ...item1];\r\n            } else {\r\n                dictionary[key] = [...item1];\r\n            }\r\n        });\r\n        return dictionary;\r\n    }\r\n\r\n    getNowIsoDate() {\r\n        return new Date().toISOString();\r\n    }\r\n\r\n    now() {\r\n        return new Date().getTime();\r\n    }\r\n\r\n    getYearYYYY() {\r\n        return new Date().getFullYear();\r\n    }\r\n\r\n    get doNothing() {\r\n        return () => {};\r\n    }\r\n\r\n    isPasteEvent(event: any): boolean {\r\n        return event?.ctrlKey && (event?.key || '').toUpperCase() === 'V';\r\n    }\r\n\r\n    getPositiveInteger(number: number): number {\r\n        const value = Math.abs(Math.round(number));\r\n        return value === 0 ? 1 : value;\r\n    }\r\n\r\n    padZero(number = 0, targetLength = 3) {\r\n        return `${number}`.padStart(targetLength, '0');\r\n    }\r\n\r\n    // add this to new service to dynamicaly load javascript,  maybe over signalR\r\n\r\n    // xmlHttpGet(url:string, onComplete, onFailure) {\r\n    //     let xmlHttp = new window.XMLHttpRequest();\r\n    //     xmlHttp.onload = function () {\r\n    //        let result = xmlHttp.responseText;\r\n    //         onComplete && onComplete(result, xmlHttp);\r\n    //     };\r\n    //     try {\r\n    //         xmlHttp.open(\"GET\", url, false);  //this may give chrome some problems\r\n    //         xmlHttp.send(null);\r\n    //     }\r\n    //     catch (ex) {\r\n    //         onFailure && onFailure(ex, xmlHttp);\r\n    //     }\r\n    // }\r\n    // loadAsScript(url:string, onComplete) {\r\n    //     this.xmlHttpGet(url, function (text, xhr) {\r\n    //         if (xhr.status == 200 || xhr.status == 304) {\r\n    //            let head = document.getElementsByTagName(\"head\")[0];\r\n    //            let script = document.createElement('script');\r\n    //             script.innerHTML = text;\r\n    //             head.appendChild(script);\r\n    //             onComplete && onComplete(script);\r\n    //         }\r\n    //     });\r\n    // }\r\n}\r\n\r\nexport let Tools: foTools = new foTools();\r\n","import { foCollection } from './foCollection.model';\r\nimport { foGlyph2D } from './foGlyph2D.model';\r\n\r\nexport class foBuffer<T extends foGlyph2D> extends foCollection<T> {}\r\n\r\nexport class foSelectionBuffer extends foBuffer<foGlyph2D> {\r\n    protected lastFound: foGlyph2D;\r\n\r\n    unselect(exclude: foGlyph2D = null) {\r\n        this.forEach((item) => {\r\n            // item.unSelect(true, exclude);\r\n            item.closeEditor && item.closeEditor();\r\n        });\r\n    }\r\n\r\n    clear(exclude: foGlyph2D = null) {\r\n        this.unselect(exclude);\r\n        this.clearAll();\r\n    }\r\n\r\n    addSelection(item: foGlyph2D, clear: boolean = true) {\r\n        //this is where hit item becomes selected\r\n        item.isSelected = true;\r\n\r\n        //delaying the clear let the shape detect if any children are selected\r\n        clear && this.clear(item);\r\n\r\n        if (!this.isMember(item)) {\r\n            this.addMember(item);\r\n        }\r\n    }\r\n\r\n    findSelected() {\r\n        return this.find((item) => {\r\n            return item.isSelected;\r\n        });\r\n    }\r\n\r\n    sendKeysToShape(e: KeyboardEvent, keys: any) {\r\n        if (this.lastFound && this.lastFound.isSelected) {\r\n            this.lastFound.sendKeys(e, keys);\r\n        } else {\r\n            const found = this.findSelected();\r\n            if (found && found.sendKeys) {\r\n                found.sendKeys(e, keys);\r\n                this.lastFound = found;\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { cPoint2D } from './foGeometry2D';\r\nimport { foGlyph2D } from './foGlyph2D.model';\r\nimport { iPoint2D } from './foInterface';\r\nimport { foObject } from './foObject.model';\r\nimport { PubSub } from './foPubSub';\r\nimport { foShape2D, IfoShape2DProperties } from './foShape2D.model';\r\nimport { foSelectionBuffer } from '../models/foBuffer';\r\nimport { Lifecycle } from './foLifecycle';\r\n\r\nexport interface IfoPageProperties extends IfoShape2DProperties {\r\n    marginX?: number;\r\n    marginY?: number;\r\n    showBoundry?: boolean;\r\n}\r\n\r\n//a Shape is a graphic designed to behave like a visio shape\r\n//and have all the same properties\r\nexport class foPage extends foShape2D implements IfoPageProperties {\r\n    private _isDirty: boolean = true;\r\n    gridSizeX: number = 50;\r\n    gridSizeY: number = 50;\r\n    showBoundry: boolean = true;\r\n    protected selections: foSelectionBuffer = new foSelectionBuffer();\r\n\r\n    constructor(properties?: IfoPageProperties, parent?: foObject) {\r\n        super(properties, parent);\r\n        this.override(properties);\r\n    }\r\n\r\n    markAsDirty(): foPage {\r\n        this._isDirty = true;\r\n        return this;\r\n    }\r\n    markAsClean(): foPage {\r\n        this._isDirty = false;\r\n        return this;\r\n    }\r\n\r\n    get isDirty() {\r\n        return this._isDirty;\r\n    }\r\n\r\n    protected _marginX: number;\r\n    get marginX(): number {\r\n        return this._marginX || 0.0;\r\n    }\r\n    set marginX(value: number) {\r\n        this.smash();\r\n        this._marginX = value;\r\n    }\r\n\r\n    protected _marginY: number;\r\n    get marginY(): number {\r\n        return this._marginY || 0.0;\r\n    }\r\n    set marginY(value: number) {\r\n        this.smash();\r\n        this._marginY = value;\r\n    }\r\n\r\n    protected _scaleX: number;\r\n    get scaleX(): number {\r\n        return this._scaleX || 1.0;\r\n    }\r\n    set scaleX(value: number) {\r\n        this.smash();\r\n        this._scaleX = value;\r\n    }\r\n\r\n    protected _scaleY: number;\r\n    get scaleY(): number {\r\n        return this._scaleY || 1.0;\r\n    }\r\n    set scaleY(value: number) {\r\n        this.smash();\r\n        this._scaleY = value;\r\n    }\r\n\r\n    mouseLoc: any = {};\r\n\r\n    findHitShape(hit: iPoint2D, deep: boolean = true, exclude: foGlyph2D = null): foShape2D {\r\n        let found: foShape2D;\r\n\r\n        for (let i: number = 0; i < this.subcomponents.length; i++) {\r\n            const shape = this.subcomponents.getMember(i);\r\n            if (shape === exclude) {\r\n                continue;\r\n            }\r\n            found = shape.findObjectUnderPoint(hit, deep);\r\n            if (found) {\r\n                return found;\r\n            }\r\n        }\r\n    }\r\n\r\n    findShapeUnder(source: foGlyph2D, deep: boolean = true, exclude: foGlyph2D = null): foGlyph2D {\r\n        // const frame = source.boundryFrame;\r\n        for (let i: number = 0; i < this.subcomponents.length; i++) {\r\n            let shape: foGlyph2D = this._subcomponents.getMember(i);\r\n            if (source.hasAncestor(shape) || shape === exclude) {\r\n                continue;\r\n            }\r\n            // if (shape.findObjectUnderFrame(source, frame, deep)) {\r\n            //   return shape;\r\n            // }\r\n            return shape;\r\n        }\r\n    }\r\n\r\n    public onItemHoverEnter = (loc: cPoint2D, shape: foGlyph2D, keys?: any): void => {};\r\n\r\n    public onItemHoverExit = (loc: cPoint2D, shape: foGlyph2D, keys?: any): void => {};\r\n\r\n    public onItemChangedPosition = (shape: foGlyph2D): void => {};\r\n\r\n    zoomToCenter(g: cPoint2D, zoom: number, e: WheelEvent) {\r\n        //you need to track this position in global space\r\n        //so you can return it to the same location on the screen\r\n        let pt1 = this.globalToLocalPoint(g);\r\n\r\n        this.zoomBy(zoom);\r\n        //page.updatePIP();\r\n\r\n        //once the zoom is applied, measure where the global point has moved to\r\n        //then pan back so it is in the center...\r\n        const pt2 = this.localToGlobal(pt1.x, pt1.y);\r\n\r\n        this.x += pt1.x - pt2.x;\r\n        this.y += pt1.y - pt2.y;\r\n        //console.log(pt2.x, pt2.y)\r\n\r\n        //page.updatePIP();\r\n    }\r\n\r\n    setupMouseEvents() {\r\n        let shape: foShape2D = null;\r\n        let shapeUnder: foGlyph2D = null;\r\n        let hovershape: foGlyph2D = null;\r\n        let offset: iPoint2D = null;\r\n\r\n        // let grab: foHandle2D = null;\r\n        // let float: foHandle2D = null;\r\n\r\n        // function debounce(func: (loc: cPoint2D, e: MouseEvent, keys: any) => void, wait = 50) {\r\n        //     let h: any;\r\n        //     return (loc: cPoint2D, e: MouseEvent, keys: any) => {\r\n        //         clearTimeout(h);\r\n        //         h = setTimeout(() => func(loc, e, keys), wait);\r\n        //     };\r\n        // }\r\n\r\n        // const command = {\r\n        //   d: this.duplicateSelected,\r\n        //   c: this.copySelected,\r\n        //   x: this.deleteSelected,\r\n        //   v: this.pasteFromBuffer\r\n        // };\r\n\r\n        // PubSub.Sub('onkeydown', (e: KeyboardEvent, keys) => {\r\n        //   if (keys.ctrl && e.key === 'd') {\r\n        //     //duplicate\r\n        //     this.duplicateSelected();\r\n        //   } else if (keys.ctrl && e.key === 'c') {\r\n        //     //copy\r\n        //     this.copySelected();\r\n        //   } else if (keys.ctrl && e.key === 'x') {\r\n        //     //cut\r\n        //     this.deleteSelected();\r\n        //   } else if (keys.ctrl && e.key === 'v') {\r\n        //     //paste\r\n        //     this.pasteFromBuffer();\r\n        //   } else if (keys.ctrl && e.key === 'l') {\r\n        //     //connect\r\n        //     this.connectSelected();\r\n        //   } else if (keys.ctrl && e.key === 'g') {\r\n        //     //group\r\n        //     this.groupSelected();\r\n        //   } else if (keys.ctrl && e.key === 'u') {\r\n        //     //un-group\r\n        //     this.unGroupSelected();\r\n        //   } else if (keys.ctrl && e.key === 'a') {\r\n        //     //select all\r\n        //     this.selectAll();\r\n        //   } else if (keys.ctrl && e.key === 's') {\r\n        //     //save\r\n        //     this.savePage();\r\n        //   } else if (keys.ctrl && e.key === 'o') {\r\n        //     //open\r\n        //     this.openPage();\r\n        //   } else {\r\n        //     this.selections.sendKeysToShape(e, keys);\r\n        //   }\r\n        // });\r\n\r\n        const mousedown = (loc: cPoint2D, e: MouseEvent, keys: any) => {\r\n            this.onMouseLocationChanged(loc, 'down', keys);\r\n\r\n            // grab = this.selections.findHandle(loc);\r\n            // if (grab) {\r\n            //     offset = grab.getOffset(loc);\r\n            //     return;\r\n            // }\r\n\r\n            const found = this.findHitShape(loc);\r\n            if (found) {\r\n                shape = found;\r\n                offset = shape.getOffset(loc);\r\n                if (shape.isDragable()) {\r\n                    this.subcomponents.moveToTop(shape);\r\n                }\r\n                this.selections.addSelection(shape, !keys.shift);\r\n            } else {\r\n                // grab = null;\r\n                this.selections.clear();\r\n            }\r\n            //Lifecycle.pageSelections(this, this.selections);\r\n        };\r\n        PubSub.Sub('mousedown', mousedown);\r\n\r\n        const mousemove = (loc: cPoint2D, e: MouseEvent, keys: any) => {\r\n            if (shape && shape.isDragable()) {\r\n                this.onMouseLocationChanged(loc, 'move', keys);\r\n                shape.moveTo(loc, offset);\r\n            } else {\r\n                this.onMouseLocationChanged(loc, 'hover', keys);\r\n\r\n                const found = this.findHitShape(loc) as foGlyph2D;\r\n                if (found && found === hovershape) {\r\n                    this.onItemHoverEnter(loc, hovershape);\r\n                } else if (found) {\r\n                    hovershape && this.onItemHoverExit(loc, hovershape);\r\n                    hovershape = found;\r\n                    this.onItemHoverEnter(loc, hovershape);\r\n                } else {\r\n                    hovershape && this.onItemHoverExit(loc, hovershape);\r\n                    hovershape = null;\r\n                }\r\n            }\r\n        };\r\n\r\n        // do not user this const debounceMouseMove = debounce(mousemove, 10);\r\n        PubSub.Sub('mousemove', mousemove);\r\n\r\n        const mouseup = (loc: cPoint2D, e: MouseEvent, keys: any) => {\r\n            // grab = null;\r\n            this.onMouseLocationChanged(loc, 'up', keys);\r\n            if (!shape) {\r\n                return;\r\n            }\r\n\r\n            if (shape.isDragable()) {\r\n                this._subcomponents.moveToTop(shape);\r\n            }\r\n\r\n            if (shapeUnder && keys.ctrl) {\r\n                // //foObject.beep();\r\n                // const { x, y } = shape.getLocation() as cPoint2D;\r\n                // // const drop = shapeUnder.globalToLocal(x, y);\r\n                // shapeUnder.addSubcomponent(shape.removeFromParent());\r\n                // // shape.easeTo(drop.x, drop.y);\r\n                // //shape.easeTo(0, 0);\r\n                // shapeUnder = null;\r\n                // this.onItemChangedParent(shape);\r\n            } else {\r\n                this.onItemChangedPosition(shape);\r\n                Lifecycle.moveComplete(shape, loc);\r\n            }\r\n\r\n            // if (shape.myParent() !== this && keys.ctrl) {\r\n            //     //foObject.beep();\r\n            //     const { x, y } = shape.pinLocation();\r\n            //     const drop = shape.localToGlobal(x, y);\r\n            //     this.addSubcomponent(shape.removeFromParent());\r\n            //     //shape.easeTo(drop.x, drop.y);\r\n            //     this.onItemChangedParent(shape);\r\n            // }\r\n\r\n            shape = shapeUnder = null;\r\n        };\r\n        PubSub.Sub('mouseup', mouseup);\r\n\r\n        PubSub.Sub('wheel', (loc: cPoint2D, g: cPoint2D, zoom: number, e: WheelEvent, keys) => {\r\n            this.onMouseLocationChanged(loc, 'wheel', keys);\r\n            if (keys.shift && keys.ctrl) {\r\n                this.zoomToCenter(g, zoom, e);\r\n            }\r\n        });\r\n    }\r\n\r\n    public onMouseLocationChanged = (loc: cPoint2D, state: string, keys?: any): void => {\r\n        this.mouseLoc = loc;\r\n        this.mouseLoc.state = state;\r\n        this.mouseLoc.keys = keys;\r\n    };\r\n\r\n    zoomBy(zoom: number) {\r\n        this.scaleX *= zoom;\r\n        this.scaleY *= zoom;\r\n    }\r\n\r\n    drawGrid(ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.beginPath();\r\n\r\n        ctx.setLineDash([5, 1]);\r\n        ctx.strokeStyle = 'gray';\r\n\r\n        const left = this.marginX - this.x;\r\n        const top = this.marginY - this.y;\r\n        const width = this.width / this.scaleX;\r\n        const height = this.height / this.scaleY;\r\n        const right = left + width;\r\n        const bottom = top + height;\r\n\r\n        //ctx.fillStyle = 'yellow';\r\n        //ctx.fillRect(left,top, width, height);\r\n\r\n        //draw vertical...\r\n        let x = this.gridSizeX; //left;\r\n        while (x < right) {\r\n            ctx.moveTo(x, top);\r\n            ctx.lineTo(x, bottom);\r\n            x += this.gridSizeX;\r\n        }\r\n        x = -this.gridSizeX; //left;\r\n        while (x > left) {\r\n            ctx.moveTo(x, top);\r\n            ctx.lineTo(x, bottom);\r\n            x -= this.gridSizeX;\r\n        }\r\n\r\n        //draw horizontal...\r\n        let y = this.gridSizeY; //top;\r\n        while (y < bottom) {\r\n            ctx.moveTo(left, y);\r\n            ctx.lineTo(right, y);\r\n            y += this.gridSizeY;\r\n        }\r\n\r\n        y = -this.gridSizeY; //top;\r\n        while (y > top) {\r\n            ctx.moveTo(left, y);\r\n            ctx.lineTo(right, y);\r\n            y -= this.gridSizeY;\r\n        }\r\n\r\n        ctx.stroke();\r\n        ctx.restore();\r\n    }\r\n\r\n    drawAxis(ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.beginPath();\r\n\r\n        ctx.strokeStyle = 'black';\r\n        ctx.lineWidth = 3;\r\n\r\n        const left = this.marginX - this.x;\r\n        const top = this.marginY - this.y;\r\n        const width = this.width / this.scaleX;\r\n        const height = this.height / this.scaleY;\r\n        const right = left + width;\r\n        const bottom = top + height;\r\n\r\n        //draw vertical...\r\n        ctx.moveTo(0, top);\r\n        ctx.lineTo(0, bottom);\r\n\r\n        //draw horizontal...\r\n\r\n        ctx.moveTo(left, 0);\r\n        ctx.lineTo(right, 0);\r\n\r\n        ctx.stroke();\r\n        ctx.restore();\r\n    }\r\n\r\n    drawPage(ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.beginPath();\r\n\r\n        ctx.strokeStyle = 'black';\r\n        ctx.lineWidth = 5;\r\n\r\n        //let left = this.marginX - this.x;\r\n        //let top = this.marginY - this.y;\r\n        //let width = this.width / this.scaleX;\r\n        //let height = this.height / this.scaleY;\r\n        //let right = left + width;\r\n        //let bottom = top + height;\r\n\r\n        //draw vertical...\r\n        ctx.rect(0, 0, this.width, this.height);\r\n\r\n        ctx.stroke();\r\n        ctx.restore();\r\n    }\r\n\r\n    drawName(ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.font = '50pt Calibri';\r\n        ctx.lineWidth = 3;\r\n        ctx.strokeStyle = 'blue';\r\n        ctx.strokeText(this.myName, 10, 50);\r\n        ctx.restore();\r\n    }\r\n\r\n    public render(ctx: CanvasRenderingContext2D, deep: boolean = true): foPage {\r\n        ctx.clearRect(0, 0, this.width, this.height);\r\n\r\n        ctx.save();\r\n\r\n        this.drawName(ctx);\r\n\r\n        this.preDraw && this.preDraw(ctx);\r\n        this.draw(ctx);\r\n        //this.drawHover && this.drawHover(ctx);\r\n        this.postDraw && this.postDraw(ctx);\r\n\r\n        deep &&\r\n            this._subcomponents?.forEach((item) => {\r\n                item.render(ctx, deep);\r\n            });\r\n        ctx.restore();\r\n\r\n        this.showBoundry && this.afterRender(ctx);\r\n\r\n        return this.markAsClean();\r\n    }\r\n\r\n    public preDraw = (ctx: CanvasRenderingContext2D): void => {\r\n        ctx.fillStyle = this.color;\r\n        ctx.fillRect(0, 0, this.width, this.height);\r\n    };\r\n\r\n    public draw = (ctx: CanvasRenderingContext2D): void => {\r\n        this.drawGrid(ctx);\r\n        this.drawAxis(ctx);\r\n        this.drawPage(ctx);\r\n        this.drawPin(ctx);\r\n    };\r\n}\r\n","import { Tools } from './foTools';\r\nimport { cMargin } from './foGeometry2D';\r\n\r\nimport { foObject } from './foObject.model';\r\n\r\nimport { foShape2D } from './foShape2D.model';\r\n\r\nexport class foImage2D extends foShape2D {\r\n    protected _loaded: boolean = false;\r\n\r\n    public margin: cMargin;\r\n\r\n    protected _image: HTMLImageElement;\r\n    protected _imageURL: string;\r\n    get imageURL(): string {\r\n        return this._imageURL;\r\n    }\r\n    set imageURL(value: string) {\r\n        this._loaded = false;\r\n\r\n        this._imageURL = value;\r\n        this._image = new Image();\r\n        this._image.onload = () => {\r\n            this._loaded = true;\r\n        };\r\n        this._image.src = this._imageURL;\r\n    }\r\n    protected _background: string;\r\n    get background(): string {\r\n        return this._background;\r\n    }\r\n    set background(value: string) {\r\n        this._background = value;\r\n    }\r\n\r\n    //\"http://backyardnaturalist.ca/wp-content/uploads/2011/06/goldfinch-feeder.jpg\";\r\n    public pinX = (): number => {\r\n        return 0.5 * this.width;\r\n    };\r\n    public pinY = (): number => {\r\n        return 0.5 * this.height;\r\n    };\r\n\r\n    constructor(properties?: any, parent?: foObject) {\r\n        super(properties, parent);\r\n        this.override(properties);\r\n    }\r\n\r\n    protected toJson(): any {\r\n        return Tools.mixin(super.toJson(), {\r\n            background: this.background,\r\n            imageURL: this.imageURL,\r\n            margin: this.margin\r\n        });\r\n    }\r\n    public override(properties?: any) {\r\n        if (properties && properties.margin) {\r\n            let m = properties.margin;\r\n            properties.margin = new cMargin(m.left, m.top, m.right, m.bottom);\r\n        }\r\n        return super.override(properties);\r\n    }\r\n\r\n    public render(ctx: CanvasRenderingContext2D, deep: boolean = true): foImage2D {\r\n        ctx.save();\r\n\r\n        //this.drawOrigin(ctx);\r\n        this.updateContext(ctx);\r\n        //this.drawOriginX(ctx);\r\n\r\n        this.preDraw && this.preDraw(ctx);\r\n        this.draw(ctx);\r\n        this.drawHover && this.drawHover(ctx);\r\n        this.postDraw && this.postDraw(ctx);\r\n\r\n        this.isSelected && this.drawSelected(ctx);\r\n\r\n        // deep &&\r\n        //     this._subcomponents.forEach((item) => {\r\n        //         item.render(ctx, deep);\r\n        //     });\r\n        ctx.restore();\r\n        return this;\r\n    }\r\n\r\n    public drawOutline(ctx: CanvasRenderingContext2D) {\r\n        let width = this.width + ((this.margin && this.margin.width) || 0);\r\n        let height = this.height + ((this.margin && this.margin.height) || 0);\r\n\r\n        ctx.beginPath();\r\n        ctx.setLineDash([15, 5]);\r\n        ctx.rect(0, 0, width, height);\r\n        ctx.stroke();\r\n    }\r\n\r\n    public drawSelected = (ctx: CanvasRenderingContext2D): void => {\r\n        ctx.strokeStyle = 'red';\r\n        ctx.lineWidth = 1;\r\n        this.drawOutline(ctx);\r\n        //this.drawHandles(ctx);\r\n        this.drawPin(ctx);\r\n    };\r\n\r\n    public drawBackground = (ctx: CanvasRenderingContext2D): void => {\r\n        let width = this.width + ((this.margin && this.margin.width) || 0);\r\n        let height = this.height + ((this.margin && this.margin.height) || 0);\r\n\r\n        ctx.fillStyle = this.background;\r\n        ctx.fillRect(0, 0, width, height);\r\n    };\r\n\r\n    public draw = (ctx: CanvasRenderingContext2D): void => {\r\n        let left = (this.margin && this.margin.left) || 0;\r\n        let top = (this.margin && this.margin.top) || 0;\r\n\r\n        ctx.save();\r\n        if (this.background) {\r\n            this.drawBackground(ctx);\r\n        }\r\n        ctx.restore();\r\n\r\n        if (this._loaded) {\r\n            ctx.drawImage(this._image, left, top, this.width, this.height);\r\n        }\r\n    };\r\n}\r\n\r\n// import { RuntimeType } from \"./foRuntimeType\";\r\n// RuntimeType.define(foImage2D);\r\n","import { foImage2D } from 'foundry/models/foImage2D.model';\r\nimport { iPoint2D } from 'foundry/models/foInterface';\r\n\r\nexport class IobtCanvasShape2D extends foImage2D {\r\n    protected localHitTest = (hit: any): boolean => {\r\n        const { x, y } = hit as iPoint2D;\r\n\r\n        const left = this.x - this.pinX();\r\n        if (x < left) return false;\r\n\r\n        const right = this.x + this.pinX();\r\n        if (x > right) return false;\r\n\r\n        const top = this.y - this.pinY();\r\n        if (y < top) return false;\r\n\r\n        const bottom = this.y + this.pinY();\r\n        if (y > bottom) return false;\r\n\r\n        return true;\r\n    };\r\n}\r\n","// import { pull, get } from 'lodash';\r\nimport { Subject } from 'rxjs';\r\nimport { Tools } from './foTools';\r\n\r\nconst _ = require('lodash');\r\nexport interface ModelBaseProperty {\r\n    getter: Function;\r\n    setter: Function;\r\n}\r\n\r\nexport interface ModelBaseListProperty extends ModelBaseProperty {\r\n    push: Function;\r\n    remove: Function;\r\n    labelForAdd: Function;\r\n    defaultDataForAdd: Function;\r\n}\r\n\r\nexport interface ModelBaseEnumProperty extends ModelBaseProperty {\r\n    push: Function;\r\n    clear: Function;\r\n    remove: Function;\r\n    getEnumValues: () => Subject<string[]>;\r\n    mutuallyExclusive: Function;\r\n    minRequiredSelections: Function;\r\n}\r\n\r\nexport class ModelBase {\r\n    [key: string]: any;\r\n    override(data: any) {\r\n        if (data) {\r\n            Object.keys(data).forEach((key) => {\r\n                Object.defineProperty(this, key, {\r\n                    value: data[key],\r\n                    configurable: true,\r\n                    enumerable: true,\r\n                    writable: true\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    getPropertyValue(object: any, dataToRetrieve: string): any {\r\n        return _.get(object, dataToRetrieve);\r\n    }\r\n\r\n    getProperty(propertyName: string, asArray?: boolean): ModelBaseProperty {\r\n        return {\r\n            getter: () => {\r\n                const result = this.getPropertyValue(this, propertyName);\r\n                return asArray && result ? result.join(' ') : result;\r\n            },\r\n            setter: (value: any): [string, any] => {\r\n                const result = asArray ? [value] : value;\r\n                Object.defineProperty(this, propertyName, {\r\n                    value: result,\r\n                    configurable: true,\r\n                    enumerable: true,\r\n                    writable: true\r\n                });\r\n\r\n                return [propertyName, this];\r\n            }\r\n        };\r\n    }\r\n\r\n    getPropertyAsList(propertyName: string, defaultData?: any, defaultLabel?: string): ModelBaseListProperty {\r\n        return {\r\n            getter: () => {\r\n                const result = this.getPropertyValue(this, propertyName);\r\n                return result ? result : [];\r\n            },\r\n            setter: (value: any) => {\r\n                const result = value;\r\n                Object.defineProperty(this, propertyName, {\r\n                    value: result,\r\n                    configurable: true,\r\n                    enumerable: true,\r\n                    writable: true\r\n                });\r\n            },\r\n            push: (value: any) => {\r\n                const result = this.getPropertyValue(this, propertyName);\r\n                result.push(value);\r\n                Object.defineProperty(this, propertyName, {\r\n                    value: result,\r\n                    configurable: true,\r\n                    enumerable: true,\r\n                    writable: true\r\n                });\r\n            },\r\n            remove: (value: any) => {\r\n                const result = this.getPropertyValue(this, propertyName);\r\n                _.pull(result, value);\r\n                Object.defineProperty(this, propertyName, {\r\n                    value: result,\r\n                    configurable: true,\r\n                    enumerable: true,\r\n                    writable: true\r\n                });\r\n            },\r\n            labelForAdd: () => {\r\n                return defaultLabel || 'Add Item';\r\n            },\r\n            defaultDataForAdd: () => {\r\n                const list = this.getPropertyValue(this, propertyName);\r\n                return defaultData || (list.length > 0 && Object.assign({}, list[0])) || {};\r\n            }\r\n        };\r\n    }\r\n\r\n    getPropertyAsEnumList(propertyName: string, list: [], isME: boolean, minReq: number, defaultData?: any, defaultLabel?: string): ModelBaseEnumProperty {\r\n        return {\r\n            getter: () => {\r\n                const result = this.getPropertyValue(this, propertyName);\r\n                return result ? result : isME ? '' : [];\r\n            },\r\n            setter: (value: any) => {\r\n                let result = value;\r\n                if (!Tools.isEmpty(value) && Tools.isArray(value) && isME) {\r\n                    result = value[0];\r\n                }\r\n                Object.defineProperty(this, propertyName, {\r\n                    value: result,\r\n                    configurable: true,\r\n                    enumerable: true,\r\n                    writable: true\r\n                });\r\n            },\r\n            push: (value: any) => {\r\n                let result = this.getPropertyValue(this, propertyName);\r\n                if (isME) {\r\n                    result = value;\r\n                } else {\r\n                    result.push(value);\r\n                }\r\n                Object.defineProperty(this, propertyName, {\r\n                    value: result,\r\n                    configurable: true,\r\n                    enumerable: true,\r\n                    writable: true\r\n                });\r\n            },\r\n            clear: () => {\r\n                const result = [] as any[];\r\n                Object.defineProperty(this, propertyName, {\r\n                    value: result,\r\n                    configurable: true,\r\n                    enumerable: true,\r\n                    writable: true\r\n                });\r\n            },\r\n            remove: (value: any) => {\r\n                const result = this.getPropertyValue(this, propertyName);\r\n                _.pull(result, value);\r\n                Object.defineProperty(this, propertyName, {\r\n                    value: result,\r\n                    configurable: true,\r\n                    enumerable: true,\r\n                    writable: true\r\n                });\r\n            },\r\n            getEnumValues: () => {\r\n                const result = new Subject<string[]>();\r\n                setTimeout(() => {\r\n                    result.next(list);\r\n                    result.complete();\r\n                }, 10);\r\n                return result;\r\n            },\r\n            mutuallyExclusive: () => {\r\n                return isME;\r\n            },\r\n            minRequiredSelections: () => {\r\n                return minReq;\r\n            }\r\n        };\r\n    }\r\n\r\n    removeUndefined() {\r\n        for (let key in this) {\r\n            if (this[key] === undefined) {\r\n                delete this[key];\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get myType(): string {\r\n        const comp: any = this.constructor;\r\n        return comp.name;\r\n    }\r\n    set myType(ignore: string) {}\r\n\r\n    toJSON(): any {\r\n        // Object.assign:  copy the values of all of the enumerable own properties from one or more source objects to a target object. Returns the target object.\r\n        return Object.assign({}, this);\r\n    }\r\n}\r\n\r\nexport interface IHashAny {\r\n    [key: string]: any;\r\n}\r\n\r\nexport interface IHashStringNumber {\r\n    readonly [key: string]: string | number;\r\n}\r\n\r\nexport interface IHashString {\r\n    readonly [key: string]: string;\r\n}\r\n\r\nexport interface IHashNumber {\r\n    readonly [key: string]: number;\r\n}\r\n\r\nexport interface IListOfValueItem {\r\n    code: string | undefined;\r\n    description: string;\r\n    other?: any;\r\n}\r\n\r\nexport class ModelBaseEnumPropertyDefault {\r\n    getter = Tools.doNothing;\r\n    setter = Tools.doNothing;\r\n    push = Tools.doNothing;\r\n    clear = Tools.doNothing;\r\n    remove = Tools.doNothing;\r\n    getEnumValues = () => new Subject<string[]>();\r\n    mutuallyExclusive = Tools.doNothing;\r\n    minRequiredSelections = Tools.doNothing;\r\n}\r\n","import { IEnvVars, IServiceOptions } from './service-locator';\r\nimport { ModelBase } from './model-base';\r\n\r\nexport interface IHashServiceOptions {\r\n    [key: string]: IServiceOptions;\r\n}\r\n\r\nclass foEnvConfig extends ModelBase {\r\n    production: boolean = false;\r\n\r\n    baseURL: string;\r\n    rootAPIPath: string;\r\n    apiVersion: string;\r\n\r\n    localMockPath: string = '/data';\r\n    version: string = '0.0.0';\r\n\r\n    envVars: IEnvVars;\r\n    services: IHashServiceOptions = {};\r\n\r\n    featureflags: any = {};\r\n\r\n    constructor(properties?: any) {\r\n        super();\r\n        this.override(properties);\r\n    }\r\n}\r\n\r\nexport const EnvConfig = new foEnvConfig();\r\n","import { LatLngTuple } from 'leaflet';\r\nimport { ModelBase } from 'shared/model-base';\r\nclass EnvironmentClass extends ModelBase {\r\n    tag: 'development';\r\n\r\n    baseURL: '';\r\n    rootAPIPath: '';\r\n\r\n    localDebug: true;\r\n\r\n    production: false;\r\n    version: '1.0.1';\r\n    mesh: [];\r\n    featureflags: {};\r\n    defaultLatLng: LatLngTuple;\r\n\r\n    constructor(properties?: any) {\r\n        super();\r\n        this.override(properties);\r\n    }\r\n}\r\n\r\nexport const Environment = new EnvironmentClass();\r\n","import { EnvConfig } from 'shared/foEnvConfig';\r\n// import { Toast } from './emitter.service';\r\nimport { ModelBase } from 'shared/model-base';\r\nimport { Environment } from 'environments/environment';\r\n\r\nexport interface IEnvVars {\r\n    baseURL: string;\r\n}\r\n\r\nexport interface IServiceOptions {\r\n    serviceKey: string;\r\n    endpoint: string;\r\n    localDataPath?: string;\r\n    localMockData?: boolean;\r\n    forceLocalMock?: boolean;\r\n}\r\n\r\nexport class ServiceLocator extends ModelBase implements IServiceOptions {\r\n    serviceKey: string; // update config-local and config when you add a new service\r\n    endpoint: string;\r\n    localDataPath: string;\r\n    localMockData = false;\r\n    forceLocalMock = false;\r\n\r\n    static baseURL = Environment.baseURL;\r\n\r\n    constructor(properties?: IServiceOptions) {\r\n        super();\r\n        this.override(properties);\r\n\r\n        const found = EnvConfig.services[this.serviceKey];\r\n        found && this.override(found);\r\n    }\r\n\r\n    public getUrl(): string {\r\n        const localMockData: boolean = this.localMockData;\r\n        const localDataPath: string = this.localDataPath;\r\n\r\n        if (localMockData) {\r\n            // Toast.info(`Using MOCK DATA for ${this.serviceKey}`);\r\n            console.log(`Using MOCK DATA for ${this.serviceKey}`);\r\n            return `${EnvConfig.localMockPath}${localDataPath}`;\r\n        } else if (this.forceLocalMock) {\r\n            // Toast.warning(`PENDING Service ${this.serviceKey}: FORCING MOCK DATA`);\r\n            console.warn(`PENDING Service ${this.serviceKey}: FORCING MOCK DATA`);\r\n            return `${EnvConfig.localMockPath}${localDataPath}`;\r\n        }\r\n\r\n        const longPath = `${ServiceLocator.baseURL}`;\r\n        const url = `${longPath}${this.endpoint}`;\r\n        return encodeURI(url);\r\n    }\r\n\r\n    public getClientHubUrl(): string {\r\n        const url = `${Environment.baseURL}${this.endpoint}`;\r\n        return encodeURI(url);\r\n    }\r\n\r\n    public getAPIUrl(): string {\r\n        const localMockData: boolean = this.localMockData;\r\n        const localDataPath: string = this.localDataPath;\r\n\r\n        if (localMockData) {\r\n            // Toast.info(`Using MOCK DATA for ${this.serviceKey}`);\r\n            console.log(`Using MOCK DATA for ${this.serviceKey}`);\r\n            return `${EnvConfig.localMockPath}${localDataPath}`;\r\n        } else if (this.forceLocalMock) {\r\n            // Toast.warning(`PENDING Service ${this.serviceKey}: FORCING MOCK DATA`);\r\n            console.warn(`PENDING Service ${this.serviceKey}: FORCING MOCK DATA`);\r\n            return `${EnvConfig.localMockPath}${localDataPath}`;\r\n        }\r\n\r\n        const longPath = `${ServiceLocator.baseURL}`;\r\n        const url = `${longPath}${Environment.rootAPIPath}${this.endpoint}`;\r\n        return encodeURI(url);\r\n    }\r\n}\r\n","import { Tools } from 'shared/foTools';\r\n\r\n// https://www.npmjs.com/package/geolib\r\n\r\nimport * as turf from '@turf/turf';\r\nimport { Feature, Point, Polygon } from '@turf/turf';\r\n\r\nexport interface IMessageView {\r\n    sourceGuid: string;\r\n    messageType: string;\r\n    user: string;\r\n    timeStamp: string;\r\n    personId: string;\r\n    uniqueGuid?: string;\r\n    lat?: string;\r\n    lng?: string;\r\n    notes?: string;\r\n}\r\n\r\nexport enum Objective {\r\n    POINT_OF_INTEREST = 'POINT_OF_INTEREST',\r\n    POSSIBLE_TARGET = 'POSSIBLE_TARGET',\r\n    CONFIRMED_TARGET = 'CONFIRMED_TARGET'\r\n}\r\n\r\ninterface IBoundingBox {\r\n    units: string;\r\n    width: number;\r\n    height: number;\r\n    depth: number;\r\n    pinX: number;\r\n    pinY: number;\r\n    pinZ: number;\r\n}\r\n\r\nexport class UDTO_Base {\r\n    sourceGuid: string;\r\n    timeStamp: string;\r\n    personId: string;\r\n\r\n    constructor(properties?: any) {\r\n        properties && this.override(properties);\r\n    }\r\n\r\n    override(data: any) {\r\n        Reflect.ownKeys(data).forEach((key) => {\r\n            Reflect.set(this, key, Reflect.get(data, key));\r\n        });\r\n    }\r\n\r\n    public static asCoord(point: Feature<Point>) {\r\n        return point.geometry.coordinates;\r\n    }\r\n\r\n    public static asLat(point: Feature<Point>) {\r\n        return point.geometry.coordinates[1];\r\n    }\r\n\r\n    public static asLng(point: Feature<Point>) {\r\n        return point.geometry.coordinates[0];\r\n    }\r\n\r\n    //This function takes in latitude and longitude of two location and returns the distance between them as the crow flies (in km)\r\n    public calcCrow(lat1: number, lon1: number, lat2: number, lon2: number) {\r\n        var R = 6371; // km\r\n        var dLat = this.toRad(lat2 - lat1);\r\n        var dLon = this.toRad(lon2 - lon1);\r\n        var lat1Rad = this.toRad(lat1);\r\n        var lat2Rad = this.toRad(lat2);\r\n\r\n        var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.sin(dLon / 2) * Math.sin(dLon / 2) * Math.cos(lat1Rad) * Math.cos(lat2Rad);\r\n\r\n        var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n        var d = R * c;\r\n        return d;\r\n    }\r\n\r\n    // Converts numeric degrees to radians\r\n    toRad(ang: number) {\r\n        return (ang * Math.PI) / 180;\r\n    }\r\n\r\n    toDeg(ang: number) {\r\n        return (ang * 180) / Math.PI;\r\n    }\r\n\r\n    //https://stackoverflow.com/questions/12219802/a-javascript-function-that-returns-the-x-y-points-of-intersection-between-two-ci\r\n\r\n    computeIntersection(x0: number, y0: number, r0: number, x1: number, y1: number, r1: number) {\r\n        var a: number, dx: number, dy: number, d: number, h: number, rx: number, ry: number;\r\n        var x2: number, y2: number;\r\n\r\n        /* dx and dy are the vertical and horizontal distances between\r\n         * the circle centers.\r\n         */\r\n        dx = x1 - x0;\r\n        dy = y1 - y0;\r\n\r\n        /* Determine the straight-line distance between the centers. */\r\n        d = Math.sqrt(dy * dy + dx * dx);\r\n\r\n        /* Check for solvability. */\r\n        if (d > r0 + r1) {\r\n            /* no solution. circles do not intersect. */\r\n            return false;\r\n        }\r\n        if (d < Math.abs(r0 - r1)) {\r\n            /* no solution. one circle is contained in the other */\r\n            return false;\r\n        }\r\n\r\n        /* 'point 2' is the point where the line through the circle\r\n         * intersection points crosses the line between the circle\r\n         * centers.\r\n         */\r\n\r\n        /* Determine the distance from point 0 to point 2. */\r\n        a = (r0 * r0 - r1 * r1 + d * d) / (2.0 * d);\r\n\r\n        /* Determine the coordinates of point 2. */\r\n        x2 = x0 + (dx * a) / d;\r\n        y2 = y0 + (dy * a) / d;\r\n\r\n        /* Determine the distance from point 2 to either of the\r\n         * intersection points.\r\n         */\r\n        h = Math.sqrt(r0 * r0 - a * a);\r\n\r\n        /* Now determine the offsets of the intersection points from\r\n         * point 2.\r\n         */\r\n        rx = -dy * (h / d);\r\n        ry = dx * (h / d);\r\n\r\n        /* Determine the absolute intersection points. */\r\n        var xi = x2 + rx;\r\n        var xi_prime = x2 - rx;\r\n        var yi = y2 + ry;\r\n        var yi_prime = y2 - ry;\r\n\r\n        return [xi, xi_prime, yi, yi_prime];\r\n    }\r\n\r\n    getDisplayInfo(): IMessageView {\r\n        return {\r\n            sourceGuid: this.sourceGuid,\r\n            messageType: 'Base',\r\n            user: this.personId,\r\n            timeStamp: this.timeStamp,\r\n            personId: this.personId\r\n        };\r\n    }\r\n}\r\n\r\nexport class BoundingBox extends UDTO_Base implements IBoundingBox {\r\n    units: string;\r\n    width: number;\r\n    height: number;\r\n    depth: number;\r\n    pinX: number;\r\n    pinY: number;\r\n    pinZ: number;\r\n}\r\n\r\nexport class UDTO_Generic extends UDTO_Base {\r\n    topic: string;\r\n    data: string;\r\n\r\n    constructor(properties?: any) {\r\n        super();\r\n        properties && this.override(properties);\r\n    }\r\n}\r\n\r\nexport class UDTO_ChatMessage extends UDTO_Base {\r\n    user: string;\r\n    message: string;\r\n\r\n    constructor(properties?: any) {\r\n        super();\r\n        properties && this.override(properties);\r\n    }\r\n}\r\n\r\nexport class UDTO_Status extends UDTO_Base {\r\n    user: string;\r\n    device: string;\r\n    ammo: number;\r\n    heartrate: number;\r\n    ip_address: string;\r\n    battery: string;\r\n    notes: string;\r\n\r\n    constructor(properties?: any) {\r\n        super();\r\n        properties && this.override(properties);\r\n    }\r\n\r\n    getDisplayInfo(): IMessageView {\r\n        return {\r\n            sourceGuid: this.sourceGuid,\r\n            messageType: 'Status',\r\n            user: this.personId,\r\n            timeStamp: this.timeStamp,\r\n            personId: this.personId,\r\n            notes: `Device: ${this.device}, Ammo: ${this.ammo}, Heartrate: ${this.heartrate}, IP: ${this.ip_address}, Battery: ${this.battery} Notes: ${this.notes}`\r\n        };\r\n    }\r\n}\r\n\r\nexport class UDTO_Command extends UDTO_Base {\r\n    targetGuid: string;\r\n    command: string;\r\n    args: Array<string>;\r\n\r\n    constructor(properties?: any) {\r\n        super();\r\n        properties && this.override(properties);\r\n    }\r\n\r\n    getDisplayInfo(): IMessageView {\r\n        return {\r\n            sourceGuid: this.sourceGuid,\r\n            uniqueGuid: this.targetGuid,\r\n            messageType: 'Command',\r\n            user: this.personId,\r\n            timeStamp: this.timeStamp,\r\n            personId: this.personId,\r\n            notes: this.args.toString()\r\n        };\r\n    }\r\n}\r\n\r\nexport interface ILocation {\r\n    lat: number;\r\n    lng: number;\r\n    alt: number;\r\n    point(): Feature<Point>;\r\n    distance(target: ILocation): number;\r\n    bearing(target: ILocation): number;\r\n    midpoint(target: ILocation): Feature<Point>;\r\n    destination(distance: number, bearing: number): Feature<Point>;\r\n    circlePolygon(radius: number): Feature<Polygon>;\r\n\r\n    circleIntersect(radius1: number, target: ILocation, radius2: number): Array<Feature<Point>>;\r\n}\r\n\r\nexport class Location extends UDTO_Base implements ILocation {\r\n    lat: number;\r\n    lng: number;\r\n    alt: number;\r\n\r\n    constructor(properties?: any) {\r\n        super();\r\n        properties && this.override(properties);\r\n    }\r\n\r\n    public point(): Feature<Point> {\r\n        return turf.point([this.lng, this.lat]);\r\n    }\r\n\r\n    distance(target: ILocation): number {\r\n        return turf.distance(this.point(), target.point());\r\n    }\r\n\r\n    bearing(target: ILocation): number {\r\n        return turf.bearing(this.point(), target.point());\r\n    }\r\n\r\n    midpoint(target: ILocation): Feature<Point> {\r\n        return turf.midpoint(this.point(), target.point());\r\n    }\r\n\r\n    destination(distance: number, bearing: number): Feature<Point> {\r\n        return turf.destination(this.point(), distance, bearing);\r\n    }\r\n\r\n    circlePolygon(radius: number): Feature<Polygon> {\r\n        const options = { steps: 30, Units: 'kilometers' };\r\n        const result = turf.circle(this.point(), radius, options);\r\n        return result;\r\n    }\r\n\r\n    boxPolygon(width: number, height: number, depth: number): Feature<Polygon> {\r\n        const w2 = width / 2.0;\r\n        const d2 = depth / 2.0;\r\n        const line = turf.lineString([\r\n            [this.lng - w2, this.lat - d2],\r\n            [this.lng + w2, this.lat - d2],\r\n            [this.lng + w2, this.lat + d2],\r\n            [this.lng - w2, this.lat + d2]\r\n        ]);\r\n        const bbox = turf.bbox(line);\r\n        const result = turf.bboxPolygon(bbox);\r\n        // const options = { steps: 30, Units: 'kilometers' };\r\n        return result;\r\n    }\r\n\r\n    // bboxPolygon(radius: number): Feature<Polygon> {\r\n    //   const options = { steps: 30, Units: 'kilometers' };\r\n    //   const result = turf.circle(this.point(), radius, options);\r\n    //   return result;\r\n    // }\r\n\r\n    circleIntersect(radius1: number, target: ILocation, radius2: number): Array<Feature<Point>> {\r\n        const list: Array<Feature<Point>> = new Array<Feature<Point>>();\r\n\r\n        //const result = this.computeIntersection(this.lng, this.lat, radius1, target.lng, target.lat, radius2);\r\n        //list.push(turf.point([result[0], result[2]]));\r\n        //list.push(turf.point([result[1], result[3]]));\r\n        return list;\r\n    }\r\n}\r\n\r\nexport class UDTO_Position extends Location {\r\n    user: string;\r\n\r\n    speed: number;\r\n    heading: number;\r\n\r\n    constructor(properties?: any) {\r\n        super();\r\n        properties && this.override(properties);\r\n    }\r\n\r\n    getDisplayInfo(): IMessageView {\r\n        return {\r\n            sourceGuid: this.sourceGuid,\r\n            messageType: 'Position',\r\n            lat: `${this.lat}`,\r\n            lng: `${this.lng}`,\r\n            user: this.personId,\r\n            timeStamp: this.timeStamp,\r\n            personId: this.personId\r\n        };\r\n    }\r\n}\r\n\r\nexport type units = 'ft' | 'm';\r\n\r\nexport class UDTO_HighResPosition extends UDTO_Base {\r\n    xLoc: number;\r\n    yLoc: number;\r\n    zLoc: number;\r\n\r\n    xAng: number;\r\n    yAng: number;\r\n    zAng: number;\r\n}\r\n\r\nexport class UDTO_Body extends UDTO_Base {\r\n    platformName: string;\r\n    uniqueGuid: string;\r\n    bodyName: string;\r\n    position: UDTO_HighResPosition;\r\n    boundingBox: BoundingBox;\r\n\r\n    constructor(properties?: any) {\r\n        super();\r\n        properties && this.override(properties);\r\n    }\r\n}\r\nexport class UDTO_Platform extends Location {\r\n    uniqueGuid: string;\r\n    platformName: string;\r\n    boundingBox: BoundingBox;\r\n\r\n    members: Array<UDTO_Body> = new Array<UDTO_Body>();\r\n\r\n    constructor(properties?: any) {\r\n        super();\r\n        properties && this.override(properties);\r\n        // this.uniqueGuid = Tools.generateUUID();\r\n        this.uniqueGuid = 'ea5be290-6314-4f72-ecf7-68ca15e386a3';\r\n        // this.platformName = 'ParkTheatre';\r\n    }\r\n\r\n    establishBody(body: UDTO_Body) {\r\n        let found = this.members.find((item) => {\r\n            return item.uniqueGuid === body.uniqueGuid;\r\n        });\r\n        if (found) {\r\n            found.override(body);\r\n        } else {\r\n            found = body;\r\n            this.members.push(found);\r\n        }\r\n    }\r\n\r\n    // public box(): Feature<Polygon> {\r\n    //     return this.boxPolygon(this.width, this.height, this.depth);\r\n    // }\r\n\r\n    getDisplayInfo(): any {\r\n        return {\r\n            sourceGuid: this.sourceGuid,\r\n            messageType: 'Platform',\r\n            lat: `${this.lat}`,\r\n            lng: `${this.lng}`,\r\n            platformName: this.platformName,\r\n            timeStamp: this.timeStamp,\r\n            personId: this.personId\r\n        };\r\n    }\r\n}\r\n\r\nexport class UDTO_Objective extends Location {\r\n    uniqueGuid: string;\r\n    name: string;\r\n    type: Objective;\r\n    note: string;\r\n\r\n    constructor(properties?: any) {\r\n        super();\r\n        this.uniqueGuid = Tools.generateUUID();\r\n        properties && this.override(properties);\r\n    }\r\n\r\n    getDisplayInfo(): IMessageView {\r\n        return {\r\n            sourceGuid: this.sourceGuid,\r\n            uniqueGuid: this.uniqueGuid,\r\n            messageType: 'Objective',\r\n            lat: `${this.lat}`,\r\n            lng: `${this.lng}`,\r\n            user: this.personId,\r\n            timeStamp: this.timeStamp,\r\n            personId: this.personId,\r\n            notes: `${this.type} - ${this.note || ''}`\r\n        };\r\n    }\r\n}\r\n\r\nexport class UDTO_Observation extends Location {\r\n    uniqueGuid: string;\r\n    user: string;\r\n    target: string;\r\n    isTarget: boolean;\r\n\r\n    range: number;\r\n\r\n    constructor(properties?: any) {\r\n        super();\r\n        this.uniqueGuid = Tools.generateUUID();\r\n        properties && this.override(properties);\r\n    }\r\n\r\n    public circle(): Feature<Polygon> {\r\n        const radius = this.range;\r\n        return this.circlePolygon(radius);\r\n    }\r\n\r\n    intersection(target: UDTO_Observation): Array<Feature<Point>> {\r\n        const list: Array<Feature<Point>> = new Array<Feature<Point>>();\r\n\r\n        // https://www.mathsisfun.com/algebra/trig-cosine-law.html\r\n\r\n        // c2 = a2 + b2 − 2ab cos(C)\r\n\r\n        const d = this.distance(target);\r\n        const r1 = target.range;\r\n        const r2 = this.range;\r\n\r\n        if (d > r1 + r2) {\r\n            return list;\r\n        }\r\n\r\n        const cosang = (r1 * r1 - r2 * r2 - d * d) / (-2.0 * r2 * d);\r\n        const ang = this.toDeg(Math.acos(cosang));\r\n\r\n        // 1  is right in KM\r\n        //console.log(d);\r\n\r\n        const brg = this.bearing(target);\r\n\r\n        const b1 = brg + ang;\r\n        const pt1 = this.destination(r2, b1);\r\n        list.push(pt1);\r\n\r\n        const b2 = brg - ang;\r\n        const pt2 = this.destination(r2, b2);\r\n        list.push(pt2);\r\n\r\n        return list;\r\n    }\r\n\r\n    getDisplayInfo(): IMessageView {\r\n        return {\r\n            sourceGuid: this.sourceGuid,\r\n            uniqueGuid: this.uniqueGuid,\r\n            messageType: 'Observation',\r\n            lat: `${this.lat}`,\r\n            lng: `${this.lng}`,\r\n            user: this.user || this.personId,\r\n            timeStamp: this.timeStamp,\r\n            personId: this.personId,\r\n            notes: `${this.target} (${this.range}km)`\r\n        };\r\n    }\r\n}\r\n\r\nexport class ServerHub {\r\n    ChatMessage = UDTO_ChatMessage;\r\n    Command = UDTO_Command;\r\n    Status = UDTO_Status;\r\n}\r\n\r\nexport class ClientHub {\r\n    ChatMessage = UDTO_ChatMessage;\r\n    Command = UDTO_Command;\r\n    Generic = UDTO_Generic;\r\n    Objective = UDTO_Objective;\r\n    Observation = UDTO_Observation;\r\n    Position = UDTO_Position;\r\n    Platform = UDTO_Platform;\r\n    Status = UDTO_Status;\r\n    Body = UDTO_Body;\r\n}\r\n","import { Content, DivIcon, LatLngTuple, LeafletMouseEvent, Map, PopupOptions } from 'leaflet';\r\nimport { IMessageView, UDTO_Objective, UDTO_Observation, UDTO_Platform } from './UDTO-message';\r\nimport { BBox } from '@turf/turf';\r\nimport { Tools } from 'shared/foTools';\r\n\r\nexport class GeolocationHelper {\r\n    static cloneCoords(position: GeolocationPosition): GeolocationCoordinates {\r\n        const coords = position.coords;\r\n        return Object.assign(\r\n            {},\r\n            {\r\n                latitude: coords.latitude,\r\n                longitude: coords.longitude,\r\n                altitude: coords.altitude,\r\n                heading: coords.heading,\r\n                accuracy: coords.accuracy,\r\n                altitudeAccuracy: coords.altitudeAccuracy,\r\n                speed: coords.speed\r\n            }\r\n        );\r\n    }\r\n}\r\n\r\nexport class MapviewHelper {\r\n    static mapLayerColors = ['red', 'orange', 'green', 'blue', 'purple'];\r\n\r\n    static getColor(index: number) {\r\n        if (MapviewHelper.mapLayerColors[index]) {\r\n            return MapviewHelper.mapLayerColors[index];\r\n        } else {\r\n            return MapviewHelper.mapLayerColors[0];\r\n        }\r\n    }\r\n\r\n    static videoSpec: { content: Content; options: PopupOptions } = {\r\n        content:\r\n            '<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/Lu56xVlZ40M\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>',\r\n        options: {\r\n            minWidth: 580,\r\n            maxHeight: 350,\r\n            className: 'iobt'\r\n        }\r\n    };\r\n\r\n    static getCallSignIcon(personId: string): DivIcon {\r\n        return new DivIcon({\r\n            html: `<div class=\"call-sign-icon\">${personId}</div>`\r\n        });\r\n    }\r\n\r\n    static getObjectiveIcon(objective: UDTO_Objective): DivIcon {\r\n        return new DivIcon({\r\n            html: `<div class=\"objective-container\"><img src=\"${objective.name}\" class=\"objective-container-img\" data-type=\"${objective.type}\" /></div>`,\r\n            className: 'non-existent-class-to-prevent-label-box'\r\n        });\r\n    }\r\n\r\n    static getMoveObjective(objective: UDTO_Objective, evt: LeafletMouseEvent): UDTO_Objective {\r\n        objective.lat = evt.target.getLatLng().lat;\r\n        objective.lng = evt.target.getLatLng().lng;\r\n        return objective;\r\n    }\r\n\r\n    static getMoveObservation(observation: UDTO_Observation, evt: LeafletMouseEvent): UDTO_Observation {\r\n        observation.lat = evt.target.getLatLng().lat;\r\n        observation.lng = evt.target.getLatLng().lng;\r\n        return observation;\r\n    }\r\n\r\n    static getMovePlatform(platform: UDTO_Platform, evt: LeafletMouseEvent): UDTO_Platform {\r\n        platform.lat = evt.target.getLatLng().lat;\r\n        platform.lng = evt.target.getLatLng().lng;\r\n        return platform;\r\n    }\r\n\r\n    static getPlatformIconBBox(map: Map, platform: UDTO_Platform, bbox: BBox): DivIcon {\r\n        return MapviewHelper.getScalableRectangleBBox(map, platform.platformName, bbox);\r\n    }\r\n\r\n    static getObservationIconBBox(map: Map, observation: UDTO_Observation, bbox: BBox): DivIcon {\r\n        return MapviewHelper.getScalableCircleBBox(map, observation.target, bbox);\r\n    }\r\n\r\n    static getScalableCircleBBox(map: Map, name: string, bbox: BBox): DivIcon {\r\n        const startPoint = [bbox[3], bbox[2]] as LatLngTuple;\r\n        const endPoint = [bbox[1], bbox[0]] as LatLngTuple;\r\n        console.log('getScalableCircleBBox startPoint, bbox=', startPoint, bbox);\r\n\r\n        const zoom = map.getZoom();\r\n        const startPixelPoint = map.project(startPoint, zoom);\r\n        const endPixelPoint = map.project(endPoint, zoom);\r\n\r\n        const pxW = Number(Number(endPixelPoint.y - startPixelPoint.y).toFixed(2));\r\n        const pxH = pxW;\r\n        const fontSize = Math.min(pxW / 8, 12);\r\n\r\n        const containerStyles = [`width: ${pxW}px`, `height: ${pxH}px`].join(';');\r\n        const textStyles = [`font-size: ${fontSize}pt`].join(';');\r\n\r\n        return new DivIcon({\r\n            html: `<div style=\"${containerStyles}\" class=\"observation-container\"><div style=\"${textStyles}\" class=\"observation-text\">${name}</div></div>`,\r\n            iconAnchor: [pxW / 2, pxH / 2],\r\n            className: 'non-existent-class-to-prevent-label-box'\r\n        });\r\n    }\r\n\r\n    static getScalableRectangleBBox(map: Map, name: string, bbox: BBox): DivIcon {\r\n        const startPoint = [bbox[3], bbox[2]] as LatLngTuple;\r\n        const endPoint = [bbox[1], bbox[0]] as LatLngTuple;\r\n        console.log('getScalableRectangleBBox startPoint, bbox=', startPoint, bbox);\r\n\r\n        const zoom = map.getZoom();\r\n        const startPixelPoint = map.project(startPoint, zoom);\r\n        const endPixelPoint = map.project(endPoint, zoom);\r\n\r\n        const pxW = Number(Number(endPixelPoint.x - startPixelPoint.x).toFixed(2));\r\n        const pxH = Number(Number(endPixelPoint.y - startPixelPoint.y).toFixed(2));\r\n        const fontSize = Math.min(pxW / 8, 12);\r\n\r\n        const containerStyles = [`width: ${pxW}px`, `height: ${pxH}px`].join(';');\r\n        const textStyles = [`font-size: ${fontSize}pt`].join(';');\r\n\r\n        return new DivIcon({\r\n            html: `<div style=\"${containerStyles}\" class=\"platform-container\"><div style=\"${textStyles}\" class=\"observation-text\">${name}</div></div>`,\r\n            iconAnchor: [pxW / 2, pxH / 2],\r\n            className: 'non-existent-class-to-prevent-label-box'\r\n        });\r\n    }\r\n\r\n    static getRandomPositionMove(): [number, number] {\r\n        const randomMoves: Array<[number, number]> = [\r\n            [0.0001, 0],\r\n            [-0.0001, 0],\r\n            [0, 0.0001],\r\n            // [0, -0.0001],\r\n            [0.00015, 0],\r\n            [-0.00015, 0],\r\n            [0, 0.00015],\r\n            // [0, -0.0001],\r\n            [0.000175, 0],\r\n            [-0.000175, 0],\r\n            [0, 0.000175]\r\n            // [0, -0.0001]\r\n        ];\r\n        return randomMoves[Tools.randomInt(0, randomMoves.length - 1)];\r\n    }\r\n}\r\n\r\nexport class MapMessageDisplayer {\r\n    messages: IMessageView[] = [];\r\n\r\n    appendDisplayMessage(data: any) {\r\n        this.messages.unshift(data.getDisplayInfo());\r\n    }\r\n}\r\n","import { Observable, Subject, BehaviorSubject } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\n\r\nexport enum Topic {\r\n    DEFAULT,\r\n    SIGNAL_R_CONNECTION_ESTABLISHED,\r\n    SIGNAL_R_CONNECTION_UNAVAILABLE,\r\n    RECEIVED_COP_UPDATE,\r\n    RECEIVED_CHAT_MESSAGE,\r\n    RECEIVED_ZOOM_IN_COMMAND,\r\n    RECEIVED_ZOOM_OUT_COMMAND,\r\n    RECEIVED_HIDE_MAP_COMMAND,\r\n    RECEIVED_SHOW_MAP_COMMAND,\r\n    DISPLAY_OVERLAY_PAGE,\r\n    MOVE_COMPLETE\r\n}\r\n\r\n// use tuple\r\n// https://www.tutorialsteacher.com/typescript/typescript-tuple\r\n\r\nclass K2PubSub<T extends Topic> {\r\n    private _behaviorSubject = new BehaviorSubject<Topic>(Topic.DEFAULT);\r\n    private _subject = new Subject<T>();\r\n    private _subjectPayload = new Subject<[T, any]>();\r\n\r\n    pubSub$(id: Topic): Observable<T> {\r\n        return this._subject.pipe(filter((x) => x === id));\r\n    }\r\n\r\n    pubSubLateObserver$(id: Topic): Observable<Topic> {\r\n        return this._behaviorSubject.pipe(filter((x) => x === id));\r\n    }\r\n\r\n    pubSubRaw$(): Observable<T> {\r\n        return this._subject;\r\n    }\r\n\r\n    pubSubCase$(ids: Topic[]): Observable<T> {\r\n        return this._subject.pipe(filter((x) => ids.indexOf(x) !== -1));\r\n    }\r\n\r\n    broadcast(topic: T) {\r\n        this._subject.next(topic);\r\n    }\r\n\r\n    broadcastToLateObservers(topic: T) {\r\n        this._behaviorSubject.next(topic);\r\n    }\r\n\r\n    pubSubPayload$(id: Topic): Observable<[T, any]> {\r\n        return this._subjectPayload.pipe(filter((obj) => obj[0] === id));\r\n    }\r\n\r\n    pubSubCasePayload$(ids: Topic[]): Observable<[T, any]> {\r\n        return this._subjectPayload.pipe(filter((obj) => ids.indexOf(obj[0]) !== -1));\r\n    }\r\n\r\n    broadcastPayload(topic: T, payload: any) {\r\n        this._subjectPayload.next([topic, payload]);\r\n    }\r\n}\r\n\r\nexport let PubSub: K2PubSub<Topic> = new K2PubSub<Topic>();\r\n","import { toast } from 'react-toastify';\r\nexport const Toast = toast;\r\n","import * as signalR from '@microsoft/signalr';\r\nimport { Subject } from 'rxjs';\r\nimport { ServiceLocator } from 'shared/service-locator';\r\nimport { Environment } from 'environments/environment';\r\n\r\nimport {\r\n    ClientHub,\r\n    UDTO_Base,\r\n    UDTO_Body,\r\n    UDTO_ChatMessage,\r\n    UDTO_Command,\r\n    UDTO_Generic,\r\n    UDTO_Objective,\r\n    UDTO_Observation,\r\n    UDTO_Platform,\r\n    UDTO_Position,\r\n    UDTO_Status\r\n} from '../models/UDTO-message';\r\nimport { Tools } from '../shared/foTools';\r\n\r\nimport { GeolocationHelper } from 'models/mapview-entity';\r\nimport { Toast } from 'k2-core/Toast';\r\n\r\nexport class TopicService {\r\n    connection: signalR.HubConnection;\r\n    sourceGUID: string;\r\n    personId: string;\r\n\r\n    lastLat: number;\r\n    lastLng: number;\r\n\r\n    pongSubject: Subject<any>;\r\n    subjects: Map<keyof ClientHub, Subject<any>> = new Map<keyof ClientHub, Subject<any>>();\r\n\r\n    get summary(): any {\r\n        return {\r\n            personId: this.personId,\r\n            sourceGUID: this.sourceGUID,\r\n            lat: this.lastLat,\r\n            lng: this.lastLng\r\n        };\r\n    }\r\n\r\n    constructor() {\r\n        this.sourceGUID = Tools.generateUUID();\r\n        this.personId = Tools.randomName();\r\n\r\n        this.resetPosition(() => {});\r\n    }\r\n\r\n    resetPosition(done: () => void) {\r\n        navigator.geolocation.getCurrentPosition(\r\n            (position: GeolocationPosition) => {\r\n                this.lastLat = position.coords.latitude;\r\n                this.lastLng = position.coords.longitude;\r\n                done();\r\n            },\r\n            () => {\r\n                // Use default lat/lng if cannot get current position\r\n                Toast.warning('getCurrentPosition() and watchPosition() only work with secure origins. Use https');\r\n\r\n                [this.lastLat, this.lastLng] = Environment.defaultLatLng;\r\n\r\n                done();\r\n            }\r\n        );\r\n    }\r\n\r\n    movePosition(deltaLat: number, deltaLng: number) {\r\n        this.lastLat += deltaLat;\r\n        this.lastLng += deltaLng;\r\n    }\r\n\r\n    getClientHubUrl(): string {\r\n        const serviceOptions = new ServiceLocator({\r\n            serviceKey: 'clientHub$',\r\n            endpoint: `/clientHub`\r\n        });\r\n\r\n        const url = serviceOptions.getClientHubUrl();\r\n        return url;\r\n    }\r\n\r\n    establishHubConnection() {\r\n        if (this.connection) {\r\n            return this.connection;\r\n        }\r\n\r\n        const serviceOptions = new ServiceLocator({\r\n            serviceKey: 'chatService$',\r\n            endpoint: `/clientHub`\r\n        });\r\n\r\n        const url = serviceOptions.getClientHubUrl();\r\n        Toast.info(`Hub Connection URL= ${url}`);\r\n\r\n        this.connection = new signalR.HubConnectionBuilder()\r\n            .withUrl(url, {\r\n                withCredentials: false,\r\n                skipNegotiation: true,\r\n                transport: signalR.HttpTransportType.WebSockets\r\n            })\r\n            .configureLogging(signalR.LogLevel.Debug)\r\n            .build();\r\n\r\n        return this.connection;\r\n    }\r\n\r\n    doStart(success: () => void, failure: () => void) {\r\n        if (this.connection) {\r\n            Toast.warn('reuse connection');\r\n            success();\r\n            return;\r\n        }\r\n\r\n        //https://docs.microsoft.com/en-us/aspnet/core/tutorials/signalr?tabs=visual-studio&view=aspnetcore-5.0\r\n\r\n        this.establishHubConnection()\r\n            .start()\r\n            .then(() => {\r\n                // Toast.success('topic hub is ready');\r\n                success();\r\n            })\r\n            .catch((error) => {\r\n                Toast.error(`${error.message} topic hub has failed`);\r\n                console.log(error.stack);\r\n                failure();\r\n            });\r\n        // .finally(() => {\r\n        // Toast.info('topic connection complete');\r\n        // });\r\n    }\r\n\r\n    doStop(success: () => void) {\r\n        if (this.connection) {\r\n            this.connection.stop();\r\n            this.connection.onclose(success);\r\n            this.connection = undefined;\r\n        }\r\n    }\r\n\r\n    public Estabish$<T extends UDTO_Base>(topic: keyof ClientHub): Subject<T> {\r\n        if (!this.subjects.has(topic)) {\r\n            const s = new Subject<UDTO_Base>();\r\n            this.subjects.set(topic, s);\r\n            this.connection.on(topic, (data) => {\r\n                const MessageType = new ClientHub()[topic];\r\n                s.next(new MessageType(data));\r\n            });\r\n        }\r\n        return this.subjects.get(topic);\r\n    }\r\n\r\n    public Pong$(): Subject<any> {\r\n        if (!this.pongSubject) {\r\n            this.pongSubject = new Subject<any>();\r\n            this.connection.on('Pong', (data) => {\r\n                this.pongSubject.next(data);\r\n            });\r\n        }\r\n\r\n        return this.pongSubject;\r\n    }\r\n\r\n    doPing() {\r\n        const msg = `Everybody play ping pong ${Tools.getNowIsoDate()}`;\r\n        this.connection.invoke('Ping', msg);\r\n    }\r\n\r\n    doPingPong() {\r\n        const msg = `Others play ping pong ${Tools.getNowIsoDate()}`;\r\n        this.connection.invoke('PingPong', msg);\r\n    }\r\n\r\n    private getBaseData() {\r\n        return {\r\n            sourceGuid: this.sourceGUID,\r\n            timeStamp: Tools.getNowIsoDate(),\r\n            personId: this.personId\r\n        };\r\n    }\r\n\r\n    public Generic$(): Subject<UDTO_Generic> {\r\n        return this.Estabish$<UDTO_Generic>('Generic');\r\n    }\r\n\r\n    public sendGeneric(data: UDTO_Generic) {\r\n        data.override(this.getBaseData());\r\n        this.connection.invoke('Generic', data);\r\n    }\r\n\r\n    public ChatMessage$(): Subject<UDTO_ChatMessage> {\r\n        return this.Estabish$<UDTO_ChatMessage>('ChatMessage');\r\n    }\r\n\r\n    // public sendChatMessage(data: UDTO_ChatMessage) {\r\n    //     data.override(this.getBaseData());\r\n    //     this.connection.invoke('ChatMessage', data);\r\n    // }\r\n\r\n    public sendChatMessageMesh(data: UDTO_ChatMessage) {\r\n        data.override(this.getBaseData());\r\n        this.connection.invoke('ChatMessageMesh', data, true);\r\n    }\r\n\r\n    public Position$(): Subject<UDTO_Position> {\r\n        return this.Estabish$<UDTO_Position>('Position');\r\n    }\r\n\r\n    public sendPosition(data: UDTO_Position) {\r\n        data.override(this.getBaseData());\r\n        data.user = this.personId;\r\n        this.connection.invoke('Position', data);\r\n    }\r\n\r\n    public Objective$(): Subject<UDTO_Objective> {\r\n        return this.Estabish$<UDTO_Objective>('Objective');\r\n    }\r\n\r\n    public sendObjective(data: UDTO_Objective) {\r\n        data.override(this.getBaseData());\r\n        this.connection.invoke('Objective', data);\r\n    }\r\n\r\n    public Observation$(): Subject<UDTO_Observation> {\r\n        return this.Estabish$<UDTO_Observation>('Observation');\r\n    }\r\n\r\n    public sendObservation(data: UDTO_Observation): UDTO_Observation {\r\n        data.override(this.getBaseData());\r\n        data.lat = Boolean(data.lat) ? data.lat : this.lastLat;\r\n        data.lng = Boolean(data.lng) ? data.lng : this.lastLng;\r\n        this.connection.invoke('Observation', data);\r\n        return data;\r\n    }\r\n\r\n    public Platform$(): Subject<UDTO_Platform> {\r\n        return this.Estabish$<UDTO_Platform>('Platform');\r\n    }\r\n\r\n    public Body$(): Subject<UDTO_Body> {\r\n        return this.Estabish$<UDTO_Body>('Body');\r\n    }\r\n\r\n    public sendPlatform(data: UDTO_Platform): UDTO_Platform {\r\n        data.override(this.getBaseData());\r\n        data.lat = Boolean(data.lat) ? data.lat : this.lastLat;\r\n        data.lng = Boolean(data.lng) ? data.lng : this.lastLng;\r\n        this.connection.invoke('Platform', data);\r\n        return data;\r\n    }\r\n\r\n    public sendBody(data: UDTO_Body): UDTO_Body {\r\n        data.override(this.getBaseData());\r\n        this.connection.invoke('Body', data);\r\n        return data;\r\n    }\r\n\r\n    public Status$(): Subject<UDTO_Status> {\r\n        return this.Estabish$<UDTO_Status>('Status');\r\n    }\r\n\r\n    public sendStatus(data: UDTO_Status) {\r\n        data.override(this.getBaseData());\r\n        this.connection.invoke('Status', data);\r\n    }\r\n\r\n    public Command$(): Subject<UDTO_Command> {\r\n        return this.Estabish$<UDTO_Command>('Command');\r\n    }\r\n\r\n    public sendCommand(data: UDTO_Command) {\r\n        data.override(this.getBaseData());\r\n        this.connection.invoke('Command', data);\r\n    }\r\n\r\n    doUpdatePosition(position: GeolocationPosition) {\r\n        const data = new UDTO_Position(GeolocationHelper.cloneCoords(position));\r\n        this.sendPosition(data);\r\n    }\r\n}\r\n","import { ModelBase } from 'shared/model-base';\r\nimport { Observable, of, Subject } from 'rxjs';\r\nimport { switchMap, catchError } from 'rxjs/operators';\r\nimport { AjaxResponse, ajax } from 'rxjs/ajax';\r\nimport { Constructable, FuncAny } from 'shared/types';\r\nimport { ServiceLocator } from './service-locator';\r\n// import { Toast } from './emitter.service';\r\n\r\nexport interface IResponse<T> {\r\n    dateTime: string;\r\n    hasError: boolean;\r\n    status: string;\r\n    length: number;\r\n    message: string;\r\n    payload: Array<T>;\r\n    payloadType: string;\r\n    metadata: any;\r\n    error: any;\r\n}\r\n\r\n//TODO: see what rxjs error response returns\r\nexport interface HttpErrorResponse {\r\n    message: string;\r\n    error: string;\r\n    status: number;\r\n    statusText: string;\r\n}\r\n\r\nexport class payloadHandler {\r\n    static success<T>(type: Constructable<T>, successResponse: AjaxResponse<any>, mapFunc?: FuncAny): Observable<IResponse<T>> {\r\n        const res: IResponse<T> = successResponse.response;\r\n        res.payload = AppHttpService.mapToModel(type, res.payload, mapFunc);\r\n        if (res.status === 'pending') {\r\n            const warningMessage = `${res.status} ${res.message} ${successResponse.request.url}`;\r\n            // Toast.warning(warningMessage);\r\n            console.warn(warningMessage);\r\n        }\r\n        return of<IResponse<T>>(res);\r\n    }\r\n\r\n    static getAnySuccess(successResponse: AjaxResponse<any>): Observable<IResponse<any>> {\r\n        const res: IResponse<any> = successResponse.response;\r\n        if (res.status === 'pending') {\r\n            const warningMessage = `${res.status} ${res.message} ${successResponse.request.url}`;\r\n            // Toast.warning(warningMessage);\r\n            console.warn(warningMessage);\r\n        }\r\n        return of<IResponse<any>>(res);\r\n    }\r\n\r\n    static error<T>(errorResponse: Readonly<HttpErrorResponse>): Observable<IResponse<T>> {\r\n        return of<IResponse<T>>({ ...AppHttpService.mapErrorResponse(errorResponse) });\r\n    }\r\n}\r\n\r\nexport class AppHttpServiceClass {\r\n    static makeHeaders(additionalHeaders: any, contentType?: any) {\r\n        const token: any = null; //CurrentUser?.Token.accessToken;\r\n        if (token) {\r\n            const bearerToken = { Authorization: `Bearer ${token}` };\r\n            return { ...bearerToken, ...additionalHeaders, ...contentType };\r\n        } else {\r\n            return { ...additionalHeaders, ...contentType };\r\n        }\r\n    }\r\n\r\n    mapToModel<T>(type: Constructable<T>, payload: Array<any>, func?: FuncAny): Array<T> {\r\n        const list = payload.map<T>((item) => {\r\n            const data = func ? func(item) : item;\r\n            return new type(data);\r\n        });\r\n        return list;\r\n    }\r\n\r\n    // mapErrorResponse prevents consumers of http services from directly handling HttpErrorResponses\r\n    mapErrorResponse<T>(error: HttpErrorResponse): IResponse<T> {\r\n        const formattedError: IResponse<T> = {\r\n            dateTime: new Date().toISOString(),\r\n            hasError: true,\r\n            status: 'error',\r\n            length: -1,\r\n            payload: [],\r\n            payloadType: '',\r\n            metadata: {},\r\n            message: error.message,\r\n            error\r\n        };\r\n        return formattedError;\r\n    }\r\n\r\n    public post$<T extends ModelBase>(type: Constructable<T>, serviceOptions: ServiceLocator, data: T, additionalHeaders?: any, func?: FuncAny): Subject<IResponse<T>> {\r\n        const subject = new Subject<IResponse<T>>();\r\n        const url = serviceOptions.getAPIUrl();\r\n\r\n        const headers = AppHttpServiceClass.makeHeaders(additionalHeaders, { 'Content-Type': 'application/json' });\r\n\r\n        console.log('post$ url=', url);\r\n        ajax.post(url, data, headers)\r\n            .pipe(\r\n                switchMap((ajaxRes: AjaxResponse<any>) => {\r\n                    return payloadHandler.success(type, ajaxRes, func);\r\n                }),\r\n                catchError((error: HttpErrorResponse) => {\r\n                    console.log(JSON.stringify(data, undefined, 3));\r\n                    return payloadHandler.error<T>(error);\r\n                })\r\n            )\r\n            .subscribe(subject);\r\n\r\n        return subject;\r\n    }\r\n\r\n    public postAny$<A extends ModelBase, B>(type: Constructable<A>, serviceOptions: ServiceLocator, data: B, additionalHeaders?: any, func?: FuncAny): Subject<IResponse<A>> {\r\n        const subject = new Subject<IResponse<A>>();\r\n        let first = true;\r\n        let url = serviceOptions.getAPIUrl();\r\n        const headers = AppHttpServiceClass.makeHeaders(additionalHeaders, { 'Content-Type': 'application/json' });\r\n\r\n        for (const name in data) {\r\n            const value = data[name];\r\n            if (value instanceof Array) {\r\n                for (let aValue of value) {\r\n                    url += (first ? '?' : '&') + encodeURIComponent(name.trim()) + '=' + encodeURIComponent(typeof aValue == 'string' ? aValue.trim() : JSON.stringify(aValue));\r\n                    first = false;\r\n                }\r\n            } else {\r\n                url += (first ? '?' : '&') + encodeURIComponent(name.trim()) + '=' + encodeURIComponent(typeof value == 'string' ? value.trim() : JSON.stringify(value));\r\n                first = false;\r\n            }\r\n        }\r\n\r\n        console.log('postAny$ url=', url);\r\n        ajax.post(url, null, headers)\r\n            .pipe(\r\n                switchMap((ajaxRes: AjaxResponse<any>) => {\r\n                    return payloadHandler.success(type, ajaxRes, func);\r\n                }),\r\n                catchError((error: HttpErrorResponse) => {\r\n                    console.log(JSON.stringify(data, undefined, 3));\r\n                    return payloadHandler.error<A>(error);\r\n                })\r\n            )\r\n            .subscribe(subject);\r\n\r\n        return subject;\r\n    }\r\n\r\n    public postAnyData$<A extends ModelBase, B>(type: Constructable<A>, serviceOptions: ServiceLocator, data: B, additionalHeaders?: any, func?: FuncAny): Subject<IResponse<A>> {\r\n        const subject = new Subject<IResponse<A>>();\r\n        let url = serviceOptions.getUrl();\r\n        const headers = AppHttpServiceClass.makeHeaders(additionalHeaders, { 'Content-Type': 'application/json' });\r\n\r\n        console.log('postAny$ url=', url);\r\n        ajax.post(url, data, headers)\r\n            .pipe(\r\n                switchMap((ajaxRes: AjaxResponse<any>) => {\r\n                    return payloadHandler.success(type, ajaxRes, func);\r\n                }),\r\n                catchError((error: HttpErrorResponse) => {\r\n                    console.log(JSON.stringify(data, undefined, 3));\r\n                    return payloadHandler.error<A>(error);\r\n                })\r\n            )\r\n            .subscribe(subject);\r\n\r\n        return subject;\r\n    }\r\n\r\n    public put$<T extends ModelBase>(type: Constructable<T>, serviceOptions: ServiceLocator, data: T, additionalHeaders?: any, func?: FuncAny): Subject<IResponse<T>> {\r\n        const subject = new Subject<IResponse<T>>();\r\n        const url = serviceOptions.getUrl();\r\n        console.log('put$ url=', url);\r\n\r\n        const headers = AppHttpServiceClass.makeHeaders(additionalHeaders);\r\n\r\n        ajax.put(url, JSON.stringify(data), headers)\r\n            .pipe(\r\n                switchMap((ajaxRes: AjaxResponse<any>) => {\r\n                    return payloadHandler.success(type, ajaxRes, func);\r\n                }),\r\n                catchError((error: HttpErrorResponse) => {\r\n                    return payloadHandler.error<T>(error);\r\n                })\r\n            )\r\n            .subscribe(subject);\r\n\r\n        return subject;\r\n    }\r\n\r\n    public get$<T extends ModelBase>(type: Constructable<T>, serviceOptions: ServiceLocator, additionalHeaders?: any, func?: FuncAny): Subject<IResponse<T>> {\r\n        const subject = new Subject<IResponse<T>>();\r\n        const url = serviceOptions.getAPIUrl();\r\n\r\n        const headers = AppHttpServiceClass.makeHeaders(additionalHeaders);\r\n\r\n        console.log('getAPIUrl', url);\r\n\r\n        ajax.get(url, headers)\r\n            .pipe(\r\n                switchMap((ajaxRes: AjaxResponse<any>) => {\r\n                    const responce = ajaxRes.response;\r\n                    // This if statement will re-run the query, but for mock data, if a path is supplied for mock data and the response has the pending status\r\n                    if (responce.status === 'pending') {\r\n                        if (responce.length <= 0 && serviceOptions.localDataPath) {\r\n                            let options = new ServiceLocator({\r\n                                ...serviceOptions,\r\n                                forceLocalMock: true\r\n                            });\r\n                            return this.get$<T>(type, options, func);\r\n                        } else {\r\n                            // Toast.warning(`${responce.length} records found: PENDING status may not be necessary`);\r\n                            console.warn(`${responce.length} records found: PENDING status may not be necessary`);\r\n                            return payloadHandler.success(type, ajaxRes, func);\r\n                        }\r\n                    }\r\n                    return payloadHandler.success(type, ajaxRes, func);\r\n                }),\r\n                catchError((error: HttpErrorResponse) => {\r\n                    //Toast.error(url, 'HTTP Issue');\r\n                    console.error(url, 'HTTP Issue');\r\n\r\n                    return payloadHandler.error<T>(error);\r\n                })\r\n            )\r\n            .subscribe(subject);\r\n\r\n        return subject;\r\n    }\r\n\r\n    public getAny$(serviceOptions: ServiceLocator, additionalHeaders?: any): Observable<IResponse<any>> {\r\n        const url = serviceOptions.getAPIUrl();\r\n\r\n        console.log('getAny$ url', url);\r\n\r\n        const headers = AppHttpServiceClass.makeHeaders(additionalHeaders);\r\n\r\n        return ajax.get(url, headers).pipe(\r\n            switchMap((ajaxRes: AjaxResponse<any>) => {\r\n                return payloadHandler.getAnySuccess(ajaxRes);\r\n            }),\r\n            catchError((error: HttpErrorResponse) => {\r\n                // Toast.error(url, 'HTTP Issue');\r\n                console.error(url, 'HTTP Issue');\r\n                return payloadHandler.error<any>(error);\r\n            })\r\n        );\r\n    }\r\n\r\n    public rawFetch$(url: string, additionalHeaders?: any): Observable<any> {\r\n        const headers = AppHttpServiceClass.makeHeaders(additionalHeaders);\r\n\r\n        return ajax.get(url, headers).pipe(\r\n            switchMap((ajaxRes: AjaxResponse<any>) => {\r\n                return of(ajaxRes.response);\r\n            }),\r\n            catchError((error: HttpErrorResponse) => {\r\n                // Toast.error(url, 'HTTP Issue');\r\n                console.error(url, 'HTTP Issue');\r\n                return of(error);\r\n            })\r\n        );\r\n    }\r\n}\r\n\r\nexport const AppHttpService = new AppHttpServiceClass();\r\n","// import { Toast } from './shared/emitter.service';\r\nimport { ServiceLocator } from 'shared/service-locator';\r\nimport { TopicService } from 'services/topic.service';\r\n\r\nimport { Tools } from 'shared/foTools';\r\nimport {\r\n    UDTO_Base,\r\n    UDTO_ChatMessage,\r\n    UDTO_Command,\r\n    UDTO_Generic,\r\n    UDTO_Objective,\r\n    UDTO_Observation,\r\n    UDTO_Position,\r\n    UDTO_Status,\r\n    Objective,\r\n    UDTO_Platform,\r\n    UDTO_Body\r\n} from 'models/UDTO-message';\r\nimport { PubSub, Topic } from 'shared/K2PubSub';\r\nimport { LatLngTuple } from 'leaflet';\r\nimport { AppHttpService } from 'shared/app-http.service';\r\nimport { Feature, Point } from '@turf/turf';\r\nimport { Toast } from 'k2-core/Toast';\r\n\r\nexport class CentralModelServiceClass {\r\n    http = AppHttpService;\r\n    sharedModel: any = {};\r\n    personModel: any = {};\r\n    refreshedModel: any = {};\r\n    isDisplayChatToast: boolean = true;\r\n    private tService: TopicService;\r\n\r\n    get summary(): any {\r\n        return this.tService.summary;\r\n    }\r\n\r\n    addPropertyToTarget(target: any, name: string, value: any) {\r\n        if (!target[name]) {\r\n            target[name] = [];\r\n        }\r\n        target[name].unshift(value);\r\n        return target[name];\r\n    }\r\n\r\n    addProperty(name: string, value: any) {\r\n        return this.addPropertyToTarget(this.sharedModel, name, value);\r\n    }\r\n\r\n    removeSource(target: any, sourceGuid: string, personId: string) {\r\n        const key = 'sources';\r\n        const source = sourceGuid;\r\n\r\n        if (this.personModel[personId]) {\r\n            delete this.personModel[personId];\r\n        }\r\n\r\n        if (target[key] && target[key][source]) {\r\n            delete target[key][source];\r\n        }\r\n    }\r\n\r\n    establishSource(target: any, topic: string, data: UDTO_Base) {\r\n        const key = 'sources';\r\n        const source = data.sourceGuid;\r\n        const personId = data.personId;\r\n\r\n        if (!this.personModel[personId]) {\r\n            this.personModel[personId] = source;\r\n        }\r\n\r\n        if (!target[key]) {\r\n            target[key] = {};\r\n        }\r\n        if (!target[key][source]) {\r\n            target[key][source] = {};\r\n        }\r\n        const root = target[key][source];\r\n        if (!root[topic]) {\r\n            root[topic] = {};\r\n        }\r\n        root[topic] = data;\r\n        return root;\r\n    }\r\n\r\n    removeObservation(target: any, uniqueGuid: string) {\r\n        const key = 'sources';\r\n        const objectiveKey = 'observations';\r\n\r\n        Reflect.ownKeys(target[key]).forEach((currentGuid) => {\r\n            const observations = target[key][currentGuid][objectiveKey];\r\n            if (observations) {\r\n                target[key][currentGuid][objectiveKey] = observations.filter((objective: UDTO_Observation) => {\r\n                    return objective.uniqueGuid !== uniqueGuid;\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    establishObservation(target: any, topic: string, data: UDTO_Observation) {\r\n        const key = 'sources';\r\n        const source = data.sourceGuid;\r\n\r\n        if (!target[key]) {\r\n            target[key] = {};\r\n        }\r\n        if (!target[key][source]) {\r\n            target[key][source] = {};\r\n        }\r\n        const root = target[key][source];\r\n        if (!root[topic]) {\r\n            root[topic] = [];\r\n        }\r\n        const found = root[topic].find((item: UDTO_Observation) => {\r\n            return item.uniqueGuid === data.uniqueGuid;\r\n        });\r\n\r\n        if (found) {\r\n            found.override(data);\r\n        } else {\r\n            root[topic].unshift(data);\r\n        }\r\n\r\n        return root;\r\n    }\r\n\r\n    establishPlatform(target: any, name: string, data: UDTO_Platform) {\r\n        const key = 'platforms';\r\n\r\n        if (!target[key]) {\r\n            target[key] = {};\r\n        }\r\n        const root = target[key];\r\n        root[name] = data;\r\n\r\n        return root;\r\n    }\r\n\r\n    retrievePlatform(target: any, name: string): UDTO_Platform {\r\n        const key = 'platforms';\r\n\r\n        if (!target[key]) {\r\n            target[key] = {};\r\n        }\r\n        const root = target[key];\r\n        return root[name] || {};\r\n    }\r\n\r\n    addObservation(topic: string, data: UDTO_Observation) {\r\n        return this.establishObservation(this.sharedModel, topic, data);\r\n    }\r\n\r\n    addPlatform(data: UDTO_Platform) {\r\n        return this.establishPlatform(this.sharedModel, data.platformName, data);\r\n    }\r\n\r\n    removeObjective(target: any, uniqueGuid: string) {\r\n        const key = 'sources';\r\n        const objectiveKey = 'objectives';\r\n\r\n        Reflect.ownKeys(target[key]).forEach((currentGuid) => {\r\n            const objectives = target[key][currentGuid][objectiveKey];\r\n            if (objectives) {\r\n                target[key][currentGuid][objectiveKey] = objectives.filter((objective: UDTO_Objective) => {\r\n                    return objective.uniqueGuid !== uniqueGuid;\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    establishObjective(target: any, topic: string, data: UDTO_Objective) {\r\n        const key = 'sources';\r\n        const source = data.sourceGuid;\r\n\r\n        if (!target[key]) {\r\n            target[key] = {};\r\n        }\r\n        if (!target[key][source]) {\r\n            target[key][source] = {};\r\n        }\r\n        const root = target[key][source];\r\n        if (!root[topic]) {\r\n            root[topic] = [];\r\n        }\r\n        const found = root[topic].find((item: UDTO_Observation) => {\r\n            return item.uniqueGuid === data.uniqueGuid;\r\n        });\r\n\r\n        if (found) {\r\n            found.override(data);\r\n        } else {\r\n            root[topic].unshift(data);\r\n        }\r\n\r\n        return root;\r\n    }\r\n\r\n    addToSource(topic: string, data: UDTO_Base) {\r\n        return this.establishSource(this.sharedModel, topic, data);\r\n    }\r\n\r\n    addObjective(topic: string, data: UDTO_Objective) {\r\n        const obj = new UDTO_Objective(data);\r\n        return this.establishObjective(this.sharedModel, topic, obj);\r\n    }\r\n\r\n    processAllSourceData(data: any) {\r\n        const sources = data['sources'];\r\n        Tools.forEachKeyValue(sources, (key: string, value: any) => {\r\n            // Toast.warning(key, 'adding source');\r\n            console.log('adding source key=', key);\r\n\r\n            const position = value['position'];\r\n            position && this.addToSource('position', new UDTO_Position(position));\r\n\r\n            const objectives = value['objectives'];\r\n            if (objectives) {\r\n                this.sharedModel['sources'][key]['objectives'] = [];\r\n                Tools.forEachKeyValue(objectives, (objKey: any, objValue: any) => {\r\n                    this.addObjective('objectives', new UDTO_Objective(objValue));\r\n                });\r\n            }\r\n\r\n            const observations = value['observations'];\r\n            if (observations) {\r\n                this.sharedModel['sources'][key]['observations'] = [];\r\n                Tools.forEachKeyValue(observations, (objKey: any, objValue: any) => {\r\n                    this.addObservation('observations', new UDTO_Observation(objValue));\r\n                });\r\n            }\r\n        });\r\n\r\n        PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n    }\r\n\r\n    constructor() {\r\n        this.tService = new TopicService();\r\n    }\r\n\r\n    init(): void {\r\n        this.tService.doStart(\r\n            () => {\r\n                // Toast.info('after tService.doStart');\r\n                console.log('after tService.doStart');\r\n                this.tService.Pong$().subscribe((result) => {\r\n                    this.receivePing(result);\r\n                    //Toast.success('CentralModel Pong', result);\r\n                });\r\n\r\n                this.tService.Generic$().subscribe((result) => {\r\n                    this.receiveGeneric(result);\r\n                    //Toast.success('CentralModel Generic', Tools.stringify(result));\r\n                });\r\n\r\n                this.tService.ChatMessage$().subscribe((result) => {\r\n                    this.receiveChatMessage(result);\r\n                    // this.isDisplayChatToast && Toast.success('CentralModel ChatMessage', Tools.stringify(result));\r\n                    this.isDisplayChatToast && console.log('CentralModel ChatMessage', Tools.stringify(result));\r\n                });\r\n\r\n                this.tService.Position$().subscribe((result) => {\r\n                    this.receivePosition(result);\r\n                    // Toast.success('CentralModel Position', Tools.stringify(result));\r\n                });\r\n\r\n                this.tService.Objective$().subscribe((result) => {\r\n                    this.receiveObjective(result);\r\n                    // Toast.success('CentralModel Objective', Tools.stringify(result));\r\n                });\r\n\r\n                this.tService.Observation$().subscribe((result) => {\r\n                    this.receiveObservation(result);\r\n                    // Toast.success('CentralModel Objective', Tools.stringify(result));\r\n                });\r\n\r\n                this.tService.Platform$().subscribe((result) => {\r\n                    this.receivePlatform(result);\r\n                    // Toast.success('CentralModel Platform', Tools.stringify(result));\r\n                });\r\n\r\n                this.tService.Body$().subscribe((result) => {\r\n                    this.receiveBody(result);\r\n                    // Toast.success('CentralModel Platform', Tools.stringify(result));\r\n                });\r\n\r\n                this.tService.Status$().subscribe((result) => {\r\n                    this.receiveStatus(result);\r\n                    // Toast.success('CentralModel Status', Tools.stringify(result));\r\n                });\r\n\r\n                this.tService.Command$().subscribe((result) => {\r\n                    this.receiveCommand(result);\r\n                    this.processCommand(result);\r\n                    // Toast.success('CentralModel Command', Tools.stringify(result));\r\n                });\r\n\r\n                PubSub.broadcastToLateObservers(Topic.SIGNAL_R_CONNECTION_ESTABLISHED);\r\n                this.register();\r\n            },\r\n\r\n            () => {\r\n                // Toast.error('SignalR server did not start');\r\n                console.error('SignalR server did not start');\r\n                PubSub.broadcastToLateObservers(Topic.SIGNAL_R_CONNECTION_UNAVAILABLE);\r\n            }\r\n        );\r\n    }\r\n\r\n    public restartEvents() {\r\n        this.init();\r\n    }\r\n\r\n    public stopEvents() {\r\n        this.tService.doStop(() => {\r\n            // Toast.error('Service stopped');\r\n            console.error('Service stopped');\r\n        });\r\n    }\r\n\r\n    public register() {\r\n        this.sendStatus();\r\n        this.sendPosition();\r\n    }\r\n\r\n    public unRegister() {\r\n        this.unregisterSource(this.tService.sourceGUID, this.tService.personId);\r\n    }\r\n\r\n    public unregisterSource(guid: string, personId: string) {\r\n        const cmd = new UDTO_Command({\r\n            targetGuid: guid,\r\n            command: 'UNREGISTER',\r\n            args: [personId, guid]\r\n        });\r\n        this.processCommand(cmd);\r\n        this.tService.sendCommand(cmd);\r\n    }\r\n\r\n    public deleteObservation(uniqueGuid: string) {\r\n        const cmd = new UDTO_Command({\r\n            targetGuid: uniqueGuid,\r\n            command: 'DELETE_OBSERVATION'\r\n        });\r\n        this.processCommand(cmd);\r\n        this.tService.sendCommand(cmd);\r\n    }\r\n\r\n    public deleteObjective(uniqueGuid: string) {\r\n        const cmd = new UDTO_Command({\r\n            targetGuid: uniqueGuid,\r\n            command: 'DELETE_OBJECTIVE'\r\n        });\r\n        this.processCommand(cmd);\r\n        this.tService.sendCommand(cmd);\r\n    }\r\n\r\n    public deleteObjectivePossibleTargets() {\r\n        Tools.forEachKeyValue(this.sharedModel.sources, (sourceGuid: string, context: any) => {\r\n            const keepObjectives = context.objectives?.filter((observation: UDTO_Objective) => {\r\n                return observation.type !== Objective.POSSIBLE_TARGET;\r\n            });\r\n            context.objectives = keepObjectives;\r\n        });\r\n        PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n    }\r\n\r\n    public zoomInMap(uniqueGuid: string) {\r\n        const cmd = new UDTO_Command({\r\n            targetGuid: uniqueGuid,\r\n            command: 'ZOOM_IN'\r\n        });\r\n        this.tService.sendCommand(cmd);\r\n    }\r\n\r\n    public zoomOutMap(uniqueGuid: string) {\r\n        const cmd = new UDTO_Command({\r\n            targetGuid: uniqueGuid,\r\n            command: 'ZOOM_OUT'\r\n        });\r\n        this.tService.sendCommand(cmd);\r\n    }\r\n\r\n    public hideMap(uniqueGuid: string) {\r\n        const cmd = new UDTO_Command({\r\n            targetGuid: uniqueGuid,\r\n            command: 'HIDE_MAP'\r\n        });\r\n        this.tService.sendCommand(cmd);\r\n    }\r\n\r\n    public showMap(uniqueGuid: string) {\r\n        const cmd = new UDTO_Command({\r\n            targetGuid: uniqueGuid,\r\n            command: 'SHOW_MAP'\r\n        });\r\n        this.tService.sendCommand(cmd);\r\n    }\r\n\r\n    processCommand(data: UDTO_Command) {\r\n        if (Tools.matches(data.command, 'UNREGISTER')) {\r\n            const guid = data.targetGuid;\r\n            const personId = data.args[0];\r\n            this.removeSource(this.sharedModel, guid, personId);\r\n            PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n        }\r\n\r\n        if (Tools.matches(data.command, 'FLUSH')) {\r\n            this.sharedModel = {};\r\n            this.personModel = {};\r\n            this.refreshedModel = {};\r\n            PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n        }\r\n\r\n        if (Tools.matches(data.command, 'DELETE_OBJECTIVE')) {\r\n            const uniqueGuid = data.targetGuid;\r\n            this.removeObjective(this.sharedModel, uniqueGuid);\r\n            PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n        }\r\n\r\n        if (Tools.matches(data.command, 'DELETE_OBSERVATION')) {\r\n            const uniqueGuid = data.targetGuid;\r\n            this.removeObservation(this.sharedModel, uniqueGuid);\r\n            PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n        }\r\n\r\n        if (Tools.matches(data.command, 'ZOOM_IN')) {\r\n            PubSub.broadcast(Topic.RECEIVED_ZOOM_IN_COMMAND);\r\n        }\r\n\r\n        if (Tools.matches(data.command, 'ZOOM_OUT')) {\r\n            PubSub.broadcast(Topic.RECEIVED_ZOOM_OUT_COMMAND);\r\n        }\r\n\r\n        if (Tools.matches(data.command, 'HIDE_MAP')) {\r\n            PubSub.broadcast(Topic.RECEIVED_HIDE_MAP_COMMAND);\r\n        }\r\n\r\n        if (Tools.matches(data.command, 'SHOW_MAP')) {\r\n            PubSub.broadcast(Topic.RECEIVED_SHOW_MAP_COMMAND);\r\n        }\r\n    }\r\n\r\n    public refreshFromServer(done?: () => void) {\r\n        const serviceOptions = new ServiceLocator({\r\n            serviceKey: 'refreshFromServer$',\r\n            endpoint: `/ClientHub/CentralModel`\r\n        });\r\n\r\n        const httpSubject = this.http.getAny$(serviceOptions);\r\n\r\n        httpSubject.subscribe(\r\n            (result) => {\r\n                if (result.hasError) {\r\n                    // Toast.error(result.message);\r\n                    console.error(result.message);\r\n                } else {\r\n                    this.refreshedModel = result.payload[0];\r\n                    this.processAllSourceData(this.refreshedModel);\r\n                    // Toast.success('refreshing');\r\n                    console.log('refreshing');\r\n                }\r\n                done && done();\r\n            },\r\n            (error) => {\r\n                // Toast.error(error);\r\n                console.error(error);\r\n            }\r\n        );\r\n    }\r\n\r\n    public flushCentralModel(done?: () => void) {\r\n        const serviceOptions = new ServiceLocator({\r\n            serviceKey: 'refreshFromServer$',\r\n            endpoint: `/ClientHub/flushCentralModel`\r\n        });\r\n\r\n        const httpSubject = this.http.getAny$(serviceOptions);\r\n\r\n        httpSubject.subscribe(\r\n            (result) => {\r\n                if (result.hasError) {\r\n                    Toast.error(result.message);\r\n                } else {\r\n                    this.sharedModel = {};\r\n                    this.personModel = {};\r\n                    this.refreshedModel = {};\r\n                    PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n                }\r\n                done && done();\r\n            },\r\n            (error) => {\r\n                Toast.error(error);\r\n                console.error(error);\r\n            }\r\n        );\r\n    }\r\n\r\n    sendPing() {\r\n        this.tService.doPing();\r\n    }\r\n\r\n    receivePing(data: any) {\r\n        console.log('received ping data=', data);\r\n        this.addProperty('ping', data);\r\n    }\r\n\r\n    sendPingPong() {\r\n        this.tService.doPingPong();\r\n    }\r\n\r\n    sendGeneric() {\r\n        this.tService.sendGeneric(new UDTO_Generic({}));\r\n    }\r\n\r\n    receiveGeneric(data: UDTO_Base) {\r\n        this.addToSource('generic', data);\r\n    }\r\n\r\n    sendChatMessageMesh(data: UDTO_ChatMessage = new UDTO_ChatMessage({})) {\r\n        this.tService.sendChatMessageMesh(data);\r\n    }\r\n\r\n    receiveChatMessage(data: UDTO_ChatMessage) {\r\n        this.addToSource('last_message', data);\r\n        PubSub.broadcastPayload(Topic.RECEIVED_CHAT_MESSAGE, data);\r\n    }\r\n\r\n    sendPosition() {\r\n        this.tService.sendPosition(\r\n            new UDTO_Position({\r\n                lat: this.tService.lastLat,\r\n                lng: this.tService.lastLng\r\n            })\r\n        );\r\n    }\r\n\r\n    receivePosition(data: UDTO_Base) {\r\n        this.addToSource('position', data);\r\n        PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n    }\r\n\r\n    sendObjective(data: UDTO_Objective) {\r\n        this.tService.sendObjective(data);\r\n    }\r\n\r\n    receiveObjective(data: UDTO_Objective) {\r\n        this.addObjective('objectives', data);\r\n        PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n    }\r\n\r\n    sendObservation(data: UDTO_Observation): UDTO_Observation {\r\n        // return this.tService.sendObservation(new UDTO_Observation(data));\r\n        return this.tService.sendObservation(data);\r\n    }\r\n\r\n    receiveObservation(data: UDTO_Observation) {\r\n        this.addObservation('observations', data);\r\n        PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n    }\r\n\r\n    sendPlatform(data: UDTO_Platform): UDTO_Platform {\r\n        return this.tService.sendPlatform(data);\r\n    }\r\n\r\n    receivePlatform(data: UDTO_Platform) {\r\n        this.addPlatform(data);\r\n        PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n    }\r\n\r\n    sendBody(data: UDTO_Body): UDTO_Body {\r\n        return this.tService.sendBody(data);\r\n    }\r\n\r\n    receiveBody(data: UDTO_Body) {\r\n        const platform = this.retrievePlatform(this.sharedModel, data.platformName);\r\n        platform.establishBody(data);\r\n        PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n    }\r\n\r\n    computeTargetsFromObservations() {\r\n        const list: Array<UDTO_Observation> = [];\r\n\r\n        Reflect.ownKeys(this.sharedModel.sources || {})\r\n            .sort()\r\n            .forEach((sourceGuid) => {\r\n                const sourceContext = this.sharedModel.sources[sourceGuid];\r\n\r\n                sourceContext.observations?.forEach((observation: UDTO_Observation) => {\r\n                    list.push(observation);\r\n                });\r\n            });\r\n\r\n        for (var i = 0; i < list.length; i++) {\r\n            const obs1: UDTO_Observation = list[i];\r\n            for (var j = 0; j < list.length; j++) {\r\n                if (i === j) {\r\n                    continue;\r\n                }\r\n\r\n                const obs2: UDTO_Observation = list[j];\r\n                this.computeObjective(obs1, obs2, 'target');\r\n            }\r\n        }\r\n\r\n        PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n    }\r\n\r\n    createPossableTarget(point: Feature<Point>, objName: string) {\r\n        const target = new UDTO_Objective({\r\n            lat: UDTO_Base.asLat(point),\r\n            lng: UDTO_Base.asLng(point),\r\n            uniqueGuid: Tools.generateUUID(),\r\n            name: 'assets/images/ICON_Enemy.png',\r\n            type: Objective.POSSIBLE_TARGET,\r\n            note: `${objName} Computed from Observations`\r\n        });\r\n\r\n        this.tService.sendObjective(target);\r\n        return target;\r\n    }\r\n\r\n    computeObjective(obj1: UDTO_Observation, obj2: UDTO_Observation, objName: string) {\r\n        const pts = obj1.intersection(obj2);\r\n        if (pts.length === 0) {\r\n            return false;\r\n        }\r\n\r\n        const p1 = pts[0];\r\n        if (p1) {\r\n            this.createPossableTarget(p1, objName);\r\n        }\r\n\r\n        const p2 = pts[1];\r\n        if (p2) {\r\n            this.createPossableTarget(p1, objName);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    resetPosition(done?: (position: LatLngTuple) => void) {\r\n        this.tService.resetPosition(() => {\r\n            this.sendPosition();\r\n            done && done([this.tService.lastLat, this.tService.lastLng]);\r\n        });\r\n    }\r\n\r\n    moveAndSendPosition(deltaLat: number, deltaLng: number) {\r\n        this.tService.movePosition(deltaLat, deltaLng);\r\n        this.sendPosition();\r\n    }\r\n\r\n    sendStatus() {\r\n        this.tService.sendStatus(\r\n            new UDTO_Status({\r\n                user: this.tService.personId,\r\n                device: 'Squire',\r\n                ammo: 100,\r\n                heartrate: 62,\r\n                ip_address: '0.0.0.0',\r\n                battery: 'full',\r\n                notes: 'Ready'\r\n            })\r\n        );\r\n    }\r\n\r\n    receiveStatus(data: UDTO_Base) {\r\n        this.addToSource('status', data);\r\n    }\r\n\r\n    sendCommand(data?: any) {\r\n        this.tService.sendCommand(new UDTO_Command(data));\r\n    }\r\n\r\n    receiveCommand(data: UDTO_Base) {\r\n        this.addToSource('command', data);\r\n    }\r\n}\r\n\r\nexport const CentralModelService = new CentralModelServiceClass();\r\n","import { UDTO_Body, UDTO_Platform } from 'models/UDTO-message';\r\nimport { CentralModelService } from 'services/central-model.service';\r\n\r\nexport class ParkTheatreMessage {\r\n    sendPlatformMessage(message: UDTO_Platform) {\r\n        console.log('send platform message');\r\n        CentralModelService.sendPlatform(message);\r\n    }\r\n    sendBody(message: UDTO_Body) {\r\n        console.log('send body message');\r\n        CentralModelService.sendBody(message);\r\n    }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/theatre-floor-plan.745fed31.png\";","export default __webpack_public_path__ + \"static/media/air-force-logo.94550adb.jpg\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/marines-logo.059ab0c3.png\";","export default __webpack_public_path__ + \"static/media/nasa-logo.c6d44475.png\";","export default __webpack_public_path__ + \"static/media/space-force-logo.a89f540a.png\";","export default __webpack_public_path__ + \"static/media/faa-logo.d12ad911.png\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAb1BMVEX///8AAACWlpbT09Pp6en7+/uGhoabm5t6enq7u7thYWFdXV1+fn7s7Ozv7+/Pz8+lpaUsLCzZ2dkjIyPj4+MXFxc2NjYdHR0pKSn29vbAwMBtbW2ampqjo6MwMDAUFBRBQUFxcXFVVVWMjIw9PT14vebLAAAExUlEQVR4nO2da1fiMBCGK4J4BxEvoOJt//9v3JWzKnTeSaZpajKe9/m4LZ552AyTJk3SNIQQQgghhBBCCCGEEEIIIYQQQggh9XA5m09HdTKdzy776o1Htwd1c/s47uG3PCsdv4nTZargeenQzRyl/Qdel467A5uEpjorHXRHDrsKHpaOuDOLboIXpeNNoFvhqL1GIF66CE5LR5vE3C54WTrWRFZmw6PSoSYyMhuWjjQZq+C6dKDJzIyGr6UDTcbae/PUXdvn1ia4Kh1nDyYmw2XpMHtg69csSofZA9uTor9O9ze2Jwwa1gwNaVg/NKRh/dCQhvVDQxrWDw1pWD80VA3Pm0mL5ljctJE3nXxdXLYvogGvI/EXIKvFKLvhnbzrRNx0LG/6fhNAzkKPkaGZp8yGBxfiLjmHeiL/1P1ghkoupRuC6MXIePBbyG6IZ1fSDc/lbe13UW7kLTstOb9h85DVcBMMf0swDYcwRCPXPaqFHC5vTxSHG/IAhmias4dh8Gdki0zD3e9gCEPQTHsYgkTcr4hX8obddjyE4XtWw+uwQPS3aAjDx6yG0YoImvHVwIbgnZg+hsDgbve6/Cna+wYcGEZa4bO8vNeKHRhGfkliXQIHhpGKCBrxjTdD4LD5vhquhj4MgxXxXl7cLyYeDIMS0Z65B8NgRQw34R6Gy9l/wCvA2Q2BxfPntWjHPNXw9fPa2w8YBlpitE+XbPiV6qc/YBhIxPCzoRvDQFOMVUMvhnrnOj5Q5cNQTcRoNfRiqHZNDeNUPgzVrlm0Grox1CpifJjKi6HSGiMPVp4MlUFfQxp6MVSGKmIDHJ4M8aipZdrGiyFsj6apNy+G8DclOljsyRDWhchIqTNDYGOpho4MQYt8l/8k07D/E/DZDxmCigiWNYKF/KmG66f5lifQegYxBJUBAJaGuRiJ2gK+SgFaCO7HECSiAKShI0MwoS9A+2n4MbSsf0MrNB0ZxhMRrnV3ZBhPRJSGngxBP7sF3NbGkWG8It6jT3kyjCUi3hZlCEPwDmYWw1giwjQcxBCkQxZD8Iy4h3w2HMoQbDGT5y3oSEV8hh8awBBVpTyG4URUdicawBDtwJLHMJyIOA0HMIQbI+QxBNOhO+A0zG+4upGfz7YaIVgR5RDNIIaHUDCXYSgRtU3CshpOZugN6IyGoURU0jDZcPp21uYNdpqyGoYSUdtrsfdYm41cq4ICFRFXQ3eGeiKqe/U5M9QTUUtDb4Z611QNyJmhXhGVaujPUEtEfctMb4ZaIqpp6M4QvLceiceboVYRxfS9X0OciCBot4Y4EfU09GeIK2IgHHeGOBEDnX5/higRQxtI+zNEiRhIQ4eGYEI/GI0/w38hix0UQju7Ju6pUNKwTmhIw/qhIQ3rh4Y0rB8a0rB+aEjD+qEhDevHZvj7zyjxeG7eJ6YFL67PCjKevKZOVVePZTXIB35OWG1jWdHzgd9z19ZGw99/dh7actEF9vMPvf6a2s+w1HZarpwO55A2zZ/S0Sbw0kXQ5VmrHdroB/46p50PWPemmHCC/K8/W73xdCww2PXAxvi0dOgmHmzPTIrjqPa68fKY1kB3mCzW81GdzNdgR0xCCCGEEEIIIYQQQgghhBBCCCGEkHL8BXPWdtUAPxKnAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,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\"","import { foPage } from 'foundry/models/foPage.model';\r\nimport { foImage2D } from 'foundry/models/foImage2D.model';\r\nimport { foGlyph2D } from 'foundry/models/foGlyph2D.model';\r\nimport { cPoint2D } from 'foundry/models/foGeometry2D';\r\nimport { foObject } from 'foundry/models/foObject.model';\r\nimport { IobtCanvasShape2D as IobtCanvasImage2D } from 'models/iobt-canvas-shape2D';\r\nimport { foPubSub } from 'foundry/models/foPubSub';\r\nimport { ParkTheatreMessage } from './park-theatre-message.model';\r\nimport { BoundingBox, UDTO_Body, UDTO_HighResPosition, UDTO_Platform } from 'models/UDTO-message';\r\nimport { PubSub as K2PubSub, Topic } from 'shared/K2PubSub';\r\nimport { Tools } from 'shared/foTools';\r\nimport stageImg from 'assets/images/park-theatre/theatre-floor-plan.png';\r\nimport airForceLogoImg from 'assets/images/air-force-logo.jpg';\r\nimport armyLogoImg from 'assets/images/army-logo.png';\r\nimport navyLogoImg from 'assets/images/navy-logo.png';\r\nimport marinesLogoImg from 'assets/images/marines-logo.png';\r\nimport nasaLogoImg from 'assets/images/nasa-logo.png';\r\nimport spaceForceLogoImg from 'assets/images/space-force-logo.png';\r\nimport faaLogoImg from 'assets/images/faa-logo.png';\r\nimport vipLogoImg from 'assets/images/vip-logo.png';\r\nimport contractorLogoImg from 'assets/images/contractor.png';\r\n\r\nimport { Lifecycle } from '../foundry/models/foLifecycle';\r\n\r\nexport class Logo extends IobtCanvasImage2D {\r\n    imagePath = 'images';\r\n    scale: number;\r\n    name: string;\r\n    code: string;\r\n    filename: string;\r\n    uniqueGuid: string;\r\n\r\n    xLoc(): number {\r\n        const parentPinX = (this.myParent() as foPage).pinX();\r\n        return this.x - parentPinX;\r\n    }\r\n\r\n    yLoc(): number {\r\n        return 5;\r\n    }\r\n\r\n    zLoc(): number {\r\n        const parentPinY = (this.myParent() as foPage).pinY();\r\n        return this.y - parentPinY;\r\n    }\r\n\r\n    asBody(): UDTO_Body {\r\n        const parent = this.myParent() as typeof ParkTheatreCanvasPage;\r\n\r\n        const bBox = new BoundingBox();\r\n        bBox.override({\r\n            units: 'm',\r\n            width: 0.25,\r\n            height: 1,\r\n            depth: 0.25\r\n        });\r\n\r\n        const hiresPos = new UDTO_HighResPosition();\r\n        hiresPos.override({\r\n            xLoc: parent.scaleStageHorizontally(this.xLoc()),\r\n            yLoc: this.yLoc(),\r\n            zLoc: parent.scaleStageVertically(this.zLoc())\r\n        });\r\n\r\n        const body = new UDTO_Body();\r\n        body.override({\r\n            uniqueGuid: this.uniqueGuid,\r\n            bodyName: this.code,\r\n            position: hiresPos,\r\n            boundingBox: bBox,\r\n            platformName: parent.myName\r\n        });\r\n\r\n        return body;\r\n    }\r\n\r\n    finalize() {\r\n        // this.imageURL = `${this.imagePath}/${this.filename}`;\r\n        this.imageURL = `${this.filename}`;\r\n    }\r\n\r\n    constructor(properties?: any, parent?: foObject) {\r\n        super(properties, parent);\r\n        this.uniqueGuid = Tools.generateUUID();\r\n        // this.override({\r\n        //     width: properties.width * properties.scale,\r\n        //     height: properties.height * properties.scale,\r\n        //     scale: properties.scale\r\n        // });\r\n    }\r\n}\r\n\r\nexport class AirForce extends Logo {\r\n    get width() {\r\n        return this.scale * 198;\r\n    }\r\n    get height() {\r\n        return this.scale * 254;\r\n    }\r\n    scale = 0.3;\r\n    code = 'airForce';\r\n    name = 'Air Force';\r\n    filename = airForceLogoImg;\r\n}\r\nexport class Army extends Logo {\r\n    get width() {\r\n        return this.scale * 198;\r\n    }\r\n    get height() {\r\n        return this.scale * 254;\r\n    }\r\n    scale = 0.3;\r\n    code = 'army';\r\n    name = 'Army';\r\n    filename = armyLogoImg;\r\n}\r\n\r\nexport class Navy extends Logo {\r\n    get width() {\r\n        return this.scale * 255;\r\n    }\r\n    get height() {\r\n        return this.scale * 255;\r\n    }\r\n    scale = 0.3;\r\n    code = 'navy';\r\n    name = 'Navy';\r\n    filename = 'navy-logo.png';\r\n}\r\n\r\nexport class Marines extends Logo {\r\n    get width() {\r\n        return this.scale * 512;\r\n    }\r\n    get height() {\r\n        return this.scale * 512;\r\n    }\r\n    scale = 0.125;\r\n    code = 'marines';\r\n    name = 'Marines';\r\n    filename = marinesLogoImg;\r\n}\r\n\r\nexport class NASA extends Logo {\r\n    get width() {\r\n        return this.scale * 3400;\r\n    }\r\n    get height() {\r\n        return this.scale * 1700;\r\n    }\r\n    scale = 0.05;\r\n    code = 'nasa';\r\n    name = 'NASA';\r\n    filename = nasaLogoImg;\r\n}\r\n\r\nexport class SpaceForce extends Logo {\r\n    get width() {\r\n        return this.scale * 1755;\r\n    }\r\n    get height() {\r\n        return this.scale * 2047;\r\n    }\r\n    scale = 0.04;\r\n    code = 'spaceForce';\r\n    name = 'Space Force';\r\n    filename = spaceForceLogoImg;\r\n}\r\n\r\nexport class FAA extends Logo {\r\n    get width() {\r\n        return this.scale * 255;\r\n    }\r\n    get height() {\r\n        return this.scale * 255;\r\n    }\r\n    scale = 0.3;\r\n    code = 'faa';\r\n    name = 'FAA';\r\n    filename = faaLogoImg;\r\n}\r\n\r\nexport class VIP extends Logo {\r\n    get width() {\r\n        return this.scale * 255;\r\n    }\r\n    get height() {\r\n        return this.scale * 255;\r\n    }\r\n    scale = 0.3;\r\n    code = 'vip';\r\n    name = 'VIP';\r\n    filename = vipLogoImg;\r\n}\r\n\r\nexport class Contractor extends Logo {\r\n    get width() {\r\n        return this.scale * 272;\r\n    }\r\n    get height() {\r\n        return this.scale * 185;\r\n    }\r\n    scale = 0.4;\r\n    code = 'contractor';\r\n    name = 'Contractor';\r\n    filename = contractorLogoImg;\r\n}\r\nexport class ParkTheatreCanvasPageClass extends foPage {\r\n    private messageHandler: ParkTheatreMessage;\r\n    private setEventSubscriptions() {\r\n        Lifecycle.observable.subscribe((canvasLifecycleEvent) => {\r\n            console.log(canvasLifecycleEvent);\r\n            if (canvasLifecycleEvent.cmd === 'dropped') {\r\n                const logo = canvasLifecycleEvent.object as Logo;\r\n                this.messageHandler.sendBody(logo.asBody());\r\n                K2PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n            } else if (canvasLifecycleEvent.cmd === 'moveComplete') {\r\n                const logo = canvasLifecycleEvent.object as Logo;\r\n                this.messageHandler.sendBody(logo.asBody());\r\n                K2PubSub.broadcast(Topic.RECEIVED_COP_UPDATE);\r\n            } else if (canvasLifecycleEvent.cmd === 'pageCreated') {\r\n                this.messageHandler.sendPlatformMessage(this.asPlatform());\r\n            }\r\n        });\r\n    }\r\n\r\n    // stageImageURL = '/iobt-client-canvas/images/park-theatre/theatre-floor-plan.png';\r\n    stageImageURL = stageImg;\r\n    stageImageWidth = 1338;\r\n    stageImageHeight = 1039;\r\n\r\n    logoTypes: typeof Logo[] = [AirForce, Army, Navy, Marines, NASA, SpaceForce, FAA, VIP, Contractor];\r\n\r\n    logos: Logo[] = [];\r\n\r\n    showBoundry: false;\r\n\r\n    theatreWidth = 48.4;\r\n    theatreHeight = 100;\r\n    theatreDepth = 37.58415;\r\n\r\n    subHandle: foPubSub;\r\n\r\n    get canvas2Params(): any {\r\n        return {\r\n            width: this.width,\r\n            height: this.height,\r\n            draw: (ctx: CanvasRenderingContext2D, count: number) => {\r\n                this.render(ctx);\r\n            }\r\n        };\r\n    }\r\n\r\n    public scaleStageHorizontally(v: number): number {\r\n        // assume stage is 48.4 m wide\r\n        const retVal = this.theatreWidth * (v / this.width);\r\n        return retVal;\r\n    }\r\n\r\n    public scaleStageVertically(v: number): number {\r\n        // assume theatre is 37.5+ m deep\r\n        return this.theatreDepth * (v / this.height);\r\n    }\r\n\r\n    public asPlatform(isIncludeBodies: boolean = false): UDTO_Platform {\r\n        const bBox = new BoundingBox();\r\n        bBox.override({\r\n            units: 'm',\r\n            width: this.theatreWidth,\r\n            height: this.theatreHeight,\r\n            depth: this.theatreDepth\r\n        });\r\n\r\n        const platform = new UDTO_Platform();\r\n        platform.override({ uniqueGuid: platform.uniqueGuid, platformName: this.myName, boundingBox: bBox });\r\n\r\n        if (isIncludeBodies) {\r\n            platform.members = this.subcomponents.members.map((item) => {\r\n                return (item as Logo).asBody();\r\n            });\r\n        }\r\n\r\n        return platform;\r\n    }\r\n\r\n    public onItemHoverEnter = (loc: cPoint2D, shape: foGlyph2D, keys?: any): void => {\r\n        shape.drawHover = shape.drawHighlight;\r\n    };\r\n\r\n    public onItemHoverExit = (loc: cPoint2D, shape: foGlyph2D, keys?: any): void => {\r\n        shape.drawHover = undefined;\r\n    };\r\n\r\n    // Pin the page in the middle of the \"A\" in the word \"STAGE\"\r\n    public pinX = (): number => 0.496 * this.width;\r\n    public pinY = (): number => 0.217 * this.height;\r\n\r\n    private createLogos() {\r\n        this.logos = [];\r\n        Object.values(this.logoTypes).forEach((item) => {\r\n            const logo = new item(undefined, this);\r\n            logo.scale = logo.scale * this.width * 0.001;\r\n            // Do this to avoid \"timing issue\" with subclass instantiation\r\n            logo.finalize();\r\n            this.logos.push(logo);\r\n        });\r\n    }\r\n\r\n    public init(getAvailableScreenWidth: () => number) {\r\n        const stageImageScale = getAvailableScreenWidth() / this.stageImageWidth;\r\n        this.width = this.stageImageWidth * stageImageScale;\r\n        this.height = this.stageImageHeight * stageImageScale;\r\n\r\n        const stage = new foImage2D({\r\n            imageURL: this.stageImageURL,\r\n            width: this.width,\r\n            height: this.height\r\n        });\r\n\r\n        this.createLogos();\r\n\r\n        this.postDraw = (ctx: CanvasRenderingContext2D) => {\r\n            stage.draw(ctx);\r\n            this.drawPin(ctx);\r\n        };\r\n    }\r\n\r\n    public draw = (ctx: CanvasRenderingContext2D): void => {\r\n        this.drawPage(ctx);\r\n    };\r\n\r\n    public dropLogo(logo: Logo) {\r\n        logo.dropAt(this.width / 2, this.height / 2);\r\n        this.subcomponents.addMember(logo);\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n        this.setName('ParkTheatre');\r\n        this.messageHandler = new ParkTheatreMessage();\r\n        this.setupMouseEvents();\r\n        this.setEventSubscriptions();\r\n    }\r\n}\r\n\r\nexport const ParkTheatreCanvasPage = new ParkTheatreCanvasPageClass();\r\n","import React, { forwardRef, FunctionComponent, ReactElement, useMemo, MouseEvent } from 'react';\r\nimport { Box, Tooltip, createStyles, makeStyles, MenuProps, useTheme } from '@material-ui/core';\r\nimport { K2Render } from 'k2-core/K2Render';\r\nimport { ICommandListOption, ICommandListComponent } from 'shared/command';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport clsx from 'classnames';\r\nimport { indigo } from '@material-ui/core/colors';\r\n\r\ninterface K2TextButtonItemProps extends MenuProps {\r\n    label: string;\r\n}\r\n\r\nexport interface TextButtonItemComponents extends ICommandListComponent {}\r\n\r\nexport const K2TextButtonItem: FunctionComponent<K2TextButtonItemProps> = (props): ReactElement => {\r\n    return useMemo(() => new K2TextButtonItemClass(), []).display(props);\r\n};\r\n\r\nconst useStyles = makeStyles((theme) =>\r\n    createStyles({\r\n        iconButton: {\r\n            border: '1px solid #e6e6e6',\r\n            padding: theme.spacing(0.5),\r\n            borderRadius: theme.spacing(0.5),\r\n            cursor: 'pointer',\r\n            display: 'flex',\r\n            alignItems: 'center'\r\n        },\r\n        buttonWithLabel: {\r\n            ...theme.typography.button,\r\n            backgroundColor: indigo[500],\r\n            paddingRight: theme.spacing(2),\r\n            color: theme.palette.common.white\r\n        },\r\n        disabledIconButton: {\r\n            opacity: '0.25',\r\n            cursor: 'default'\r\n        }\r\n    })\r\n);\r\n\r\nexport class K2TextButtonItemClass<T extends K2TextButtonItemProps> extends K2Render<T> {\r\n    Component: FunctionComponent<T> = (props): ReactElement => {\r\n        return (\r\n            <Box key={`option-${props.id}`} onClick={() => props.onClick} component=\"div\" display=\"inline-block\">\r\n                {props.label}\r\n            </Box>\r\n        );\r\n    };\r\n}\r\n\r\nexport class K2TextButtonItemComponents implements TextButtonItemComponents {\r\n    default = forwardRef((option: ICommandListOption, ref): ReactElement => {\r\n        const theme = useTheme();\r\n        const classes = useStyles();\r\n        const MuiIcon = option.director.spec.muiIcon;\r\n        const FaIcon = option.director.spec.faIcon;\r\n        const label = option.director.label;\r\n        return (\r\n            <Box\r\n                key={`option-${option.id}`}\r\n                className={clsx(classes.iconButton, { [classes.buttonWithLabel]: Boolean(label) })}\r\n                color=\"primary\"\r\n                onClick={() => option.director.start()}\r\n            >\r\n                {MuiIcon && <MuiIcon color=\"inherit\" fontSize=\"small\" />}\r\n                {FaIcon && <FontAwesomeIcon icon={FaIcon} size=\"1x\" color={theme.palette.common.white} />}\r\n                <Box ml={0.5}>{label}</Box>\r\n            </Box>\r\n        );\r\n    });\r\n    tooltip = forwardRef((option: ICommandListOption, ref): ReactElement => {\r\n        const theme = useTheme();\r\n        const classes = useStyles();\r\n        const MuiIcon = option.director.spec.muiIcon;\r\n        const FaIcon = option.director.spec.faIcon;\r\n        return (\r\n            <Tooltip arrow title={option.director.label} placement=\"top\">\r\n                <Box key={`option-${option.id}`} className={clsx(classes.iconButton)} color=\"primary\" onClick={() => option.director.start()}>\r\n                    {MuiIcon && <MuiIcon color=\"inherit\" fontSize=\"small\" />}\r\n                    {FaIcon && <FontAwesomeIcon icon={FaIcon} size=\"1x\" color={theme.palette.common.white} />}\r\n                </Box>\r\n            </Tooltip>\r\n        );\r\n    });\r\n    disabled = forwardRef((option: ICommandListOption, ref): ReactElement => {\r\n        const theme = useTheme();\r\n        const classes = useStyles();\r\n        const MuiIcon = option.director.spec.muiIcon;\r\n        const FaIcon = option.director.spec.faIcon;\r\n        const label = option.director.label;\r\n\r\n        return (\r\n            <Box\r\n                key={`option-${option.id}`}\r\n                color=\"lightgrey\"\r\n                className={clsx('disabled', classes.iconButton, classes.disabledIconButton, { [classes.buttonWithLabel]: Boolean(label) })}\r\n                onClick={(evt: MouseEvent<HTMLElement>) => {\r\n                    evt.preventDefault();\r\n                    evt.stopPropagation();\r\n                }}\r\n            >\r\n                {MuiIcon && <MuiIcon color=\"inherit\" fontSize=\"small\" />}\r\n                {FaIcon && <FontAwesomeIcon icon={FaIcon} size=\"1x\" color={theme.palette.common.white} />}\r\n\r\n                <Box ml={0.5}>{label}</Box>\r\n            </Box>\r\n        );\r\n    });\r\n}\r\n","import { ForwardRefExoticComponent, RefAttributes } from 'react';\r\nimport { PubSub, Topic } from 'shared/K2PubSub';\r\nimport { OverridableComponent } from '@material-ui/core/OverridableComponent';\r\nimport { SvgIconTypeMap } from '@material-ui/core';\r\nimport { IconName } from '@fortawesome/fontawesome-svg-core';\r\nimport { SaveAndClose } from 'k2-core/icons/SaveAndClose';\r\nimport { K2MenuItemComponents } from 'k2-mui-core/K2MenuItem';\r\nimport { K2IconButtonItemComponents } from 'k2-mui-core/K2IconButtonItem';\r\nimport { K2TextButtonItemComponents } from 'k2-mui-core/K2TextButtonItem';\r\n\r\nexport type RenderComponent = ForwardRefExoticComponent<ICommandListOption & RefAttributes<unknown>>;\r\n\r\nexport interface ICommandItemComponentContainer {\r\n    itemComponents: ICommandListComponent;\r\n}\r\n\r\nexport type ApplicationItemComponentContainer = K2MenuItemComponents & K2IconButtonItemComponents & K2TextButtonItemComponents;\r\nexport type ApplicationItemComponents = K2MenuItemComponents & K2IconButtonItemComponents & K2TextButtonItemComponents;\r\n\r\nexport interface ICommandListComponent {\r\n    default: RenderComponent;\r\n    disabled: RenderComponent;\r\n}\r\n\r\nexport interface ICommandListOption {\r\n    id: string;\r\n    director: CommandListDirector;\r\n}\r\n\r\nexport type CommandListDirectorSpec = {\r\n    label: string;\r\n    muiIcon?: OverridableComponent<SvgIconTypeMap<{}, 'svg'>> | typeof SaveAndClose;\r\n    faIcon?: IconName;\r\n    isLog?: boolean;\r\n};\r\n\r\ntype DirectorGenerator = Generator<unknown, string, string>;\r\nabstract class CommandItem {\r\n    director: CommandListDirector;\r\n    name: string = 'Unnamed';\r\n    abstract execute: () => void;\r\n}\r\n\r\nexport interface IDialogPageCommand {\r\n    pathname: string;\r\n    dialogProps: any;\r\n    onOk?: Function;\r\n    onCancel?: Function;\r\n    name?: string;\r\n}\r\n\r\nclass DialogPageCommand extends CommandItem implements IDialogPageCommand {\r\n    pathname: string;\r\n    dialogProps: any;\r\n    onOk: Function;\r\n    onCancel: Function;\r\n    execute = () => {\r\n        const ok = () => {\r\n            this.onOk && this.onOk();\r\n            this.director.next('OK');\r\n        };\r\n        const cancel = () => {\r\n            this.onCancel && this.onCancel();\r\n        };\r\n        PubSub.broadcastPayload(Topic.DISPLAY_OVERLAY_PAGE, {\r\n            pathname: this.pathname,\r\n            props: { ok, cancel, dialogProps: this.dialogProps, director: this.director }\r\n        });\r\n    };\r\n\r\n    static default: IDialogPageCommand = {\r\n        pathname: '/confirm-info-add-offering-page',\r\n        dialogProps: {},\r\n        name: 'defaultDialogPageCommand'\r\n    };\r\n\r\n    constructor(properties: IDialogPageCommand) {\r\n        super();\r\n        Object.assign(this, { ...properties });\r\n    }\r\n}\r\n\r\nexport interface ISynchronousCommand {\r\n    action: Function;\r\n    name?: string;\r\n}\r\n\r\nexport type IASynchronousCommand = ISynchronousCommand;\r\n\r\nclass SynchronousCommand extends CommandItem implements ISynchronousCommand {\r\n    action: (director: CommandListDirector) => any;\r\n    execute = () => {\r\n        this.action && this.action(this.director);\r\n        window.setTimeout(() => {\r\n            this.director.next('SYNC COMMAND');\r\n        }, 0);\r\n    };\r\n    constructor(properties: ISynchronousCommand) {\r\n        super();\r\n        Object.assign(this, { ...properties });\r\n    }\r\n}\r\n\r\nclass ASynchronousCommand extends CommandItem implements ISynchronousCommand {\r\n    action: (director: CommandListDirector) => any;\r\n    execute = () => {\r\n        this.action && this.action(this.director);\r\n    };\r\n    constructor(properties: ISynchronousCommand) {\r\n        super();\r\n        Object.assign(this, { ...properties });\r\n    }\r\n}\r\n\r\nclass TimeoutCommand extends CommandItem implements ISynchronousCommand {\r\n    action: (director: CommandListDirector) => any;\r\n    delayMs: number = 0;\r\n    execute = () => {\r\n        window.setTimeout(() => {\r\n            this.action && this.action(this.director);\r\n        }, this.delayMs);\r\n    };\r\n    constructor(properties: ISynchronousCommand) {\r\n        super();\r\n        Object.assign(this, { ...properties });\r\n    }\r\n}\r\n\r\n/**\r\n * Roughly based on Builder Pattern (hence the suffix \"Director\")\r\n * https://refactoring.guru/design-patterns/builder\r\n *\r\n */\r\nexport class CommandListDirector {\r\n    label: string;\r\n    isLog = false;\r\n    spec: CommandListDirectorSpec;\r\n    [key: string]: any;\r\n    private commands: CommandItem[] = [];\r\n    private iterator: DirectorGenerator;\r\n\r\n    private add<T extends CommandItem>(command: T) {\r\n        command.director = this;\r\n        this.commands.push(command);\r\n        return this;\r\n    }\r\n\r\n    private addTimeout(spec: IASynchronousCommand, delayMs: number = 0) {\r\n        const command = new TimeoutCommand(spec);\r\n        command.delayMs = delayMs;\r\n        return this.add(command);\r\n    }\r\n\r\n    private *coroutine(director: CommandListDirector): DirectorGenerator {\r\n        for (const command of director.commands) {\r\n            director.isLog && console.log(`CommandListDirector before execute command name=\"${command.name}\"`);\r\n            command.execute();\r\n\r\n            const yieldValue = yield `Command name: ${command.name}`;\r\n            director.isLog && console.log('CommandListDirector yieldValue=', yieldValue);\r\n        }\r\n        return 'START';\r\n    }\r\n\r\n    /**\r\n     * Display a dialog page as part of the command list chain.\r\n     */\r\n    addDialogPage(spec: IDialogPageCommand = DialogPageCommand.default, conditionalRender: boolean = true) {\r\n        if (conditionalRender) {\r\n            const command = new DialogPageCommand(spec);\r\n            return this.add(command);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Sync commands execute and upon completion, director.next is automatically executed by the director.\r\n     */\r\n    addSync(spec: ISynchronousCommand) {\r\n        const command = new SynchronousCommand(spec);\r\n        return this.add(command);\r\n    }\r\n\r\n    /**\r\n     * Async commands must execute director.next at the time you deem appropriate.\r\n     */\r\n    addASync(spec: IASynchronousCommand) {\r\n        const command = new ASynchronousCommand(spec);\r\n        return this.add(command);\r\n    }\r\n\r\n    /**\r\n     * Decide whether or not to execute the next command.  The command chain will stop of you do not execute next.\r\n     */\r\n    addConditional(spec: ISynchronousCommand) {\r\n        return this.addTimeout(spec, 0);\r\n    }\r\n\r\n    /**\r\n     * Primary purpose is to wait a bit between sequential dialog commands.  You may, of course, sleep for any reason you can think of.\r\n     */\r\n    addSleep(delayMs: number = 250, name: string = 'sleepBetweenDialogs') {\r\n        const spec: IASynchronousCommand = {\r\n            action: (director: CommandListDirector) => {\r\n                director.next('SLEEP');\r\n            },\r\n            name\r\n        };\r\n        this.addTimeout(spec, delayMs);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Your custom function with logic to determine which component type to render.\r\n     */\r\n    getRender: (render: any) => RenderComponent = (render: ApplicationItemComponents) => {\r\n        return render.default;\r\n    };\r\n\r\n    /**\r\n     * Determine which component type to render.\r\n     */\r\n    renderRule(func: (render: ApplicationItemComponents) => RenderComponent) {\r\n        this.getRender = func;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Your custom function with logic to determine whether or not the command belongs in the chain.\r\n     */\r\n    existsWhenFunc: () => boolean = () => {\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Determine whether or not this command is added to the command chain during command list construction.\r\n     * @default true\r\n     */\r\n    existsWhenRule(existsWhenFunc: () => boolean) {\r\n        this.existsWhenFunc = existsWhenFunc;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Perform any action you wish before going on to next command.\r\n     *\r\n     * This is effectively a Sync command, but the intent is to perform actions that are outside of the intent of the command list.\r\n     *\r\n     * Examples of things to \"do\" are unsubscribe from a previously executed Async command or compute values (and writeCustomProperty) for the next command.\r\n     */\r\n    do(func: (director: CommandListDirector) => any) {\r\n        const spec: IASynchronousCommand = {\r\n            action: (actionDirector: CommandListDirector) => {\r\n                func(this);\r\n                actionDirector.next('DO');\r\n            },\r\n            name: 'DO FUNC'\r\n        };\r\n        this.addTimeout(spec);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Create a new property/value for use within commands that come later in the chain.\r\n     * @throws Unable to Define Property Eror\r\n     */\r\n    writeCustomProperty(propertyName: string, propertyValue: any): CommandListDirector {\r\n        if (Reflect.set(this, propertyName, propertyValue)) {\r\n            return this;\r\n        } else {\r\n            throw new Error(`${propertyName} was not able to be created.`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Return value for requested property\r\n     * @throws Unknown Property Error\r\n     */\r\n    readCustomProperty(propertyName: string): any {\r\n        if (Reflect.getOwnPropertyDescriptor(this, propertyName)) {\r\n            return this[propertyName];\r\n        } else {\r\n            throw new Error(`${propertyName} is not a known custom property on this command list.  You may need to set a property with writeCustomProperty.`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Return boolean based on if property is present\r\n     * @throws Unknown Property Error\r\n     */\r\n    hasCustomProperty(propertyName: string): any {\r\n        return Reflect.getOwnPropertyDescriptor(this, propertyName);\r\n    }\r\n\r\n    /**\r\n     * Need to execute start to initialize the command chain.\r\n     */\r\n    start() {\r\n        this.iterator = this.coroutine(this);\r\n        this.iterator.next('START_ITERATOR');\r\n    }\r\n\r\n    /**\r\n     * Execute the next command in the chain.\r\n     */\r\n    next(value: string) {\r\n        const yieldValue = this.iterator.next(value);\r\n        this.isLog && console.log('next method yieldValue=', yieldValue);\r\n    }\r\n\r\n    /**\r\n     * Stop the command chain.\r\n     */\r\n    end(value?: string) {\r\n        const endVal = value ? value : 'END';\r\n        this.iterator.return(endVal);\r\n    }\r\n\r\n    /**\r\n     * @deprecated - is this needed?\r\n     */\r\n    construct() {\r\n        return this;\r\n    }\r\n\r\n    constructor(properties: CommandListDirectorSpec) {\r\n        Object.assign(this, { ...properties });\r\n        this.spec = properties;\r\n    }\r\n\r\n    static getInstance(properties: CommandListDirectorSpec) {\r\n        const director = new CommandListDirector(properties);\r\n        return director;\r\n    }\r\n}\r\n","import { createElement, ReactElement } from 'react';\r\nimport { Logo, ParkTheatreCanvasPage } from './park-theatre-canvas.model';\r\nimport { K2TextButtonItemComponents } from 'k2-mui-core/K2TextButtonItem';\r\nimport { ApplicationItemComponents, CommandListDirector, CommandListDirectorSpec, ICommandListOption } from 'shared/command';\r\n\r\nexport class ParkTheatreCommand {\r\n    maxAllowedLogoCount = 3;\r\n    private currentLogoCount = 0;\r\n\r\n    private directDropLogo(logo: Logo): CommandListDirector {\r\n        const spec: CommandListDirectorSpec = {\r\n            label: ` + ${logo.name}`\r\n        };\r\n\r\n        return CommandListDirector.getInstance(spec)\r\n            .renderRule((componentsContainer: ApplicationItemComponents) => {\r\n                return this.currentLogoCount < this.maxAllowedLogoCount ? componentsContainer.default : componentsContainer.disabled;\r\n            })\r\n            .addSync({\r\n                action: () => {\r\n                    this.currentLogoCount++;\r\n                    this.page.dropLogo(logo);\r\n                }\r\n            });\r\n    }\r\n\r\n    private createElement(render: any, props: ICommandListOption): ReactElement {\r\n        return createElement(render, { key: props.id, ...props });\r\n    }\r\n\r\n    private generateOptions(commandListDirectors: CommandListDirector[], itemComponents: K2TextButtonItemComponents) {\r\n        const options: ReactElement[] = commandListDirectors\r\n            .filter((director) => {\r\n                return director.existsWhenFunc();\r\n            })\r\n            .map((director, index) => {\r\n                return this.createElement(director.getRender(itemComponents), {\r\n                    id: `${director.label}`,\r\n                    director\r\n                });\r\n            });\r\n        return options;\r\n    }\r\n\r\n    private generateTextButtonActions(commandListDirectors: CommandListDirector[]): ReactElement[] {\r\n        const itemComponents = new K2TextButtonItemComponents();\r\n        return this.generateOptions(commandListDirectors, itemComponents);\r\n    }\r\n\r\n    public getTextButtons(force: boolean = false): ReactElement[] {\r\n        let directors: CommandListDirector[];\r\n\r\n        directors = this.page.logos.map((logo) => {\r\n            return this.directDropLogo(logo);\r\n        });\r\n\r\n        return this.generateTextButtonActions(directors);\r\n    }\r\n\r\n    constructor(private page: typeof ParkTheatreCanvasPage) {}\r\n}\r\n","import { FunctionComponent, ReactElement, useState, useEffect, useMemo } from 'react';\r\nimport { useTheme } from '@material-ui/core/styles';\r\nimport { ParkTheatreRender } from './park-theatre.render';\r\nimport { ParkTheatreCanvasPage } from './park-theatre-canvas.model';\r\nimport { ParkTheatreCommand } from './park-theatre-command.model';\r\nimport { CentralModelService } from 'services/central-model.service';\r\nimport { PubSub, Topic } from 'shared/K2PubSub';\r\nimport { BreakpointValues } from '@material-ui/core/styles/createBreakpoints';\r\nimport { Size, useWindowSize } from 'shared/WindowResizeHook';\r\nimport { Lifecycle } from 'foundry/models/foLifecycle';\r\n\r\nclass ViewProps {\r\n    containerMaxWidthBreakpoint: keyof BreakpointValues;\r\n}\r\n\r\n// NOTE: I did not use a Component Class because React 17 does not allow us to use hooks inside of Typescript Classes.\r\nexport const ParkTheatre: FunctionComponent<ViewProps> = (props): ReactElement => {\r\n    const theme = useTheme();\r\n    const windowSize: Size = useWindowSize();\r\n    const setRefreshMs = useState<number>(0)[1];\r\n\r\n    const Render = useMemo((): ParkTheatreRender<any> => new ParkTheatreRender(), []);\r\n    Render.model = ParkTheatreCanvasPage;\r\n\r\n    const command = useMemo((): ParkTheatreCommand => new ParkTheatreCommand(Render.model), [Render.model]);\r\n    Render.actionButtons = command.getTextButtons();\r\n\r\n    useEffect(() => {\r\n        window.setTimeout(() => {\r\n            CentralModelService.sendPing();\r\n            Lifecycle.event('pageCreated', Render.model);\r\n        }, 1000);\r\n    }, [Render.model]);\r\n\r\n    useEffect(() => {\r\n        const getAvailableScreenWidth = (): number => {\r\n            return Math.min(theme.breakpoints.values[props.containerMaxWidthBreakpoint], windowSize.width);\r\n        };\r\n        ParkTheatreCanvasPage.init(getAvailableScreenWidth);\r\n    }, [windowSize, theme, props.containerMaxWidthBreakpoint]);\r\n\r\n    useEffect(() => {\r\n        // Only need this to display updated JSON on screen; don't need this in \"production\"\r\n        PubSub.pubSub$(Topic.RECEIVED_COP_UPDATE).subscribe(() => {\r\n            setRefreshMs(new Date().getTime());\r\n        });\r\n    }, [setRefreshMs]);\r\n\r\n    return Render.display();\r\n};\r\n","import { useState, useEffect } from 'react';\r\n\r\nexport interface Size {\r\n    width: number | undefined;\r\n    height: number | undefined;\r\n}\r\n\r\nexport function useWindowSize(): Size {\r\n    // Initialize state with undefined width/height so server and client renders match\r\n    // Learn more here: https://joshwcomeau.com/react/the-perils-of-rehydration/\r\n    const [windowSize, setWindowSize] = useState<Size>({\r\n        width: window.innerWidth,\r\n        height: window.innerHeight\r\n    });\r\n    useEffect(() => {\r\n        // Handler to call on window resize\r\n        function handleResize() {\r\n            // Set window width/height to state\r\n            setWindowSize({\r\n                width: window.innerWidth,\r\n                height: window.innerHeight\r\n            });\r\n        }\r\n        // Add event listener\r\n        window.addEventListener('resize', handleResize);\r\n        // Call handler right away so state gets updated with initial window size\r\n        handleResize();\r\n        // Remove event listener on cleanup\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []); // Empty array ensures that effect is only run on mount\r\n    return windowSize;\r\n}\r\n","import { Fragment, FunctionComponent, ReactElement } from 'react';\r\nimport { K2Render } from 'k2-core/K2Render';\r\nimport { CentralModelService } from 'services/central-model.service';\r\nimport Hidden from '@material-ui/core/Hidden';\r\nimport { ToJSON } from 'core/foRenderer';\r\n\r\nclass ViewModel {}\r\nexport class DisplayLogosRender<T extends ViewModel> extends K2Render<T> {\r\n    cService: typeof CentralModelService;\r\n    Component: FunctionComponent<T> = (props): ReactElement => {\r\n        return (\r\n            <Fragment>\r\n                <div>Display Logos</div>\r\n                <Hidden only=\"xs\">\r\n                    <ToJSON>{CentralModelService.sharedModel}</ToJSON>\r\n                </Hidden>\r\n            </Fragment>\r\n        );\r\n    };\r\n}\r\n// export class DisplayLogosRender<T extends ViewModel> extends K2Render<T> {\r\n//     model: typeof DisplayLogosCanvasPage;\r\n//     actionButtons: ReactElement[];\r\n//     Component: FunctionComponent<T> = (props): ReactElement => {\r\n//         return (\r\n//             <Fragment>\r\n//                 <div>Display Logos</div>\r\n//                 <Box display=\"flex\" flexWrap=\"wrap\">\r\n//                     {this.actionButtons}\r\n//                 </Box>\r\n//                 <Canvas {...this.model.canvas2Params} />\r\n\r\n//                 <Hidden only=\"xs\">\r\n//                     <ToJSON>{this.model.asPlatform()}</ToJSON>\r\n//                 </Hidden>\r\n//             </Fragment>\r\n//         );\r\n//     };\r\n// }\r\n","import { FunctionComponent, ReactElement, useState, useEffect, useMemo } from 'react';\r\nimport { DisplayLogosRender } from './display-logos.render';\r\nimport { PubSub, Topic } from 'shared/K2PubSub';\r\nimport { BreakpointValues } from '@material-ui/core/styles/createBreakpoints';\r\n\r\nclass ViewProps {\r\n    containerMaxWidthBreakpoint: keyof BreakpointValues;\r\n}\r\n\r\n// NOTE: I did not use a Component Class because React 17 does not allow us to use hooks inside of Typescript Classes.\r\nexport const DisplayLogos: FunctionComponent<ViewProps> = (props): ReactElement => {\r\n    // const theme = useTheme();\r\n    // const windowSize: Size = useWindowSize();\r\n    const setRefreshMs = useState<number>(0)[1];\r\n\r\n    const Render = useMemo((): DisplayLogosRender<any> => new DisplayLogosRender(), []);\r\n    // Render.model = DisplayLogosCanvasPage;\r\n\r\n    // const command = useMemo((): DisplayLogosCommand => new DisplayLogosCommand(Render.model), [Render.model]);\r\n    // Render.actionButtons = command.getTextButtons();\r\n\r\n    // useEffect(() => {\r\n    //     const cService = CentralModelService;\r\n\r\n    //     Render.cService = cService;\r\n    // }, [Render.cService]);\r\n\r\n    useEffect(() => {\r\n        // Only need this to display updated JSON on screen; don't need this in \"production\"\r\n        PubSub.pubSub$(Topic.RECEIVED_COP_UPDATE).subscribe(() => {\r\n            setRefreshMs(new Date().getTime());\r\n        });\r\n    }, [setRefreshMs]);\r\n\r\n    // useEffect(() => {\r\n    //     const getAvailableScreenWidth = (): number => {\r\n    //         return Math.min(theme.breakpoints.values[props.containerMaxWidthBreakpoint], windowSize.width);\r\n    //     };\r\n    //     DisplayLogosCanvasPage.init(getAvailableScreenWidth);\r\n    // }, [windowSize, theme, props.containerMaxWidthBreakpoint]);\r\n\r\n    // useEffect(() => {\r\n    //     // Only need this to display updated JSON on screen; don't need this in \"production\"\r\n    //     PubSub.pubSub$(Topic.DROPPED_LOGO).subscribe(() => {\r\n    //         setRefreshMs(new Date().getTime());\r\n    //     });\r\n    // }, [setRefreshMs]);\r\n\r\n    return Render.display();\r\n};\r\n","import { FunctionComponent, ReactElement } from 'react';\r\nimport { BrowserRouter as Router, Switch, Route, Link } from 'react-router-dom';\r\nimport { AppBar, Toolbar, Typography, Container } from '@material-ui/core';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\nimport { K2AppbarButton } from 'k2-mui-core/K2AppbarButton';\r\nimport { ParkTheatre } from 'park-theatre-page/park-theatre.container';\r\nimport { DisplayLogos } from 'display-logos-page/display-logos.container';\r\nimport { BreakpointValues } from '@material-ui/core/styles/createBreakpoints';\r\n\r\n// import { PaintTest1 } from 'PaintTest1';\r\n// import { PaintTest2 } from 'PaintTest2';\r\n// import { PaintTest3 } from 'PaintTest3';\r\n// import { PaintTest4 } from 'PaintTest4';\r\n// import { PaintTest5 } from 'PaintTest5';\r\n// import { PaintTest6 } from 'PaintTest6';\r\n// import { PaintTest7 } from 'PaintTest7';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        root: {\r\n            // flexGrow: 1\r\n        },\r\n        menuButton: {\r\n            marginRight: theme.spacing(2)\r\n        },\r\n        title: {\r\n            flexGrow: 1\r\n        },\r\n        page: {\r\n            marginTop: theme.spacing(8),\r\n            paddingLeft: 0,\r\n            paddingRight: 0\r\n        }\r\n    })\r\n);\r\n\r\nconst containerMaxWidthBreakpoint: keyof BreakpointValues = 'md';\r\n\r\nexport const DefaultLayout: FunctionComponent<any> = (props: any): ReactElement => {\r\n    const classes = useStyles();\r\n    return (\r\n        <Router>\r\n            <div className={classes.root}>\r\n                <AppBar position=\"fixed\">\r\n                    <Toolbar variant=\"dense\">\r\n                        <Typography variant=\"h6\" className={classes.title}>\r\n                            <Link to=\"/\">IoBT Client Canvas</Link>\r\n                        </Typography>\r\n                        <div>\r\n                            <K2AppbarButton>\r\n                                <Link to=\"/\">Park Theater</Link>\r\n                            </K2AppbarButton>\r\n                            <K2AppbarButton>\r\n                                <Link to=\"/display-logos\">Display Logos</Link>\r\n                            </K2AppbarButton>\r\n                            {/* <K2AppbarButton>\r\n                                <Link to=\"/paint-test-1\">Paint Test 1</Link>\r\n                            </K2AppbarButton>\r\n                            <K2AppbarButton>\r\n                                <Link to=\"/paint-test-2\">Paint Test 2</Link>\r\n                            </K2AppbarButton>\r\n                            <K2AppbarButton>\r\n                                <Link to=\"/paint-test-3\">Paint Test 3</Link>\r\n                            </K2AppbarButton>\r\n                            <K2AppbarButton>\r\n                                <Link to=\"/paint-test-4\">Paint Test 4</Link>\r\n                            </K2AppbarButton>\r\n                            <K2AppbarButton>\r\n                                <Link to=\"/paint-test-5\">Paint Test 5</Link>\r\n                            </K2AppbarButton>\r\n                            <K2AppbarButton>\r\n                                <Link to=\"/paint-test-6\">Paint Test 6</Link>\r\n                            </K2AppbarButton>\r\n                            <K2AppbarButton>\r\n                                <Link to=\"/paint-test-7\">Paint Test 7</Link>\r\n                            </K2AppbarButton> */}\r\n                        </div>\r\n                    </Toolbar>\r\n                </AppBar>\r\n            </div>\r\n            <Container className={classes.page} maxWidth={containerMaxWidthBreakpoint}>\r\n                <Switch>\r\n                    {/* <Route path=\"/paint-test-1\">\r\n                        <PaintTest1 />\r\n                    </Route>\r\n                    <Route path=\"/paint-test-2\">\r\n                        <PaintTest2 />\r\n                    </Route>\r\n                    <Route path=\"/paint-test-3\">\r\n                        <PaintTest3 />\r\n                    </Route>\r\n                    <Route path=\"/paint-test-4\">\r\n                        <PaintTest4 />\r\n                    </Route>\r\n                    <Route path=\"/paint-test-5\">\r\n                        <PaintTest5 />\r\n                    </Route>\r\n                    <Route path=\"/paint-test-6\">\r\n                        <PaintTest6 />\r\n                    </Route>\r\n                    <Route path=\"/paint-test-7\">\r\n                        <PaintTest7 />\r\n                    </Route> */}\r\n                    <Route path=\"/display-logos\">\r\n                        <DisplayLogos containerMaxWidthBreakpoint={containerMaxWidthBreakpoint} />\r\n                    </Route>\r\n                    <Route path=\"/\">\r\n                        <ParkTheatre containerMaxWidthBreakpoint={containerMaxWidthBreakpoint} />\r\n                    </Route>\r\n                </Switch>\r\n            </Container>\r\n        </Router>\r\n    );\r\n};\r\n","import { ModelBase } from 'shared/model-base';\r\nimport configDevelopment from 'assets/config-local.json';\r\nimport configProduction from 'assets/config.json';\r\nimport { ServiceLocator } from 'shared/service-locator';\r\nimport { AppHttpService } from 'shared/app-http.service';\r\nimport { Environment } from 'environments/environment';\r\nimport { Subject } from 'rxjs';\r\nimport { CentralModelService } from './central-model.service';\r\n\r\nexport class AppService {\r\n    static pingServer$(): Subject<boolean> {\r\n        const localSubject = new Subject<boolean>();\r\n\r\n        const serviceOptions = new ServiceLocator({\r\n            serviceKey: 'pingServer$',\r\n            endpoint: `/ping`\r\n        });\r\n\r\n        const http = AppHttpService.get$<ModelBase>(ModelBase, serviceOptions).subscribe(\r\n            ({ message, error }) => {\r\n                error && console.log(error);\r\n\r\n                let health = !!message && message.toLowerCase().indexOf('up') >= 0;\r\n\r\n                http.unsubscribe();\r\n                localSubject.next(health);\r\n                localSubject.complete();\r\n            },\r\n            (error) => {\r\n                localSubject.error(error);\r\n            }\r\n        );\r\n\r\n        return localSubject;\r\n    }\r\n\r\n    static loadConfiguration$(): Subject<boolean> {\r\n        const localSubject = new Subject<boolean>();\r\n        const env = process.env.NODE_ENV;\r\n\r\n        // Decide which config file to use; assume development\r\n        // let config: any = configProduction;\r\n\r\n        let config: any = configDevelopment;\r\n        if (env === 'production') {\r\n            config = configProduction;\r\n        }\r\n        Environment.override(config);\r\n        CentralModelService.init();\r\n\r\n        window.setTimeout(() => {\r\n            localSubject.next(true);\r\n        }, 10);\r\n\r\n        return localSubject;\r\n    }\r\n}\r\n","import { StrictMode } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { ThemeProvider } from '@material-ui/core';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport { createMuiTheme } from '@material-ui/core/styles';\r\nimport { DefaultLayout } from 'layout/DefaultLayout';\r\nimport { ToastContainer, ToastPosition } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport 'index.scss';\r\nimport { AppService } from 'services/app.service';\r\n\r\nconst theme = createMuiTheme({\r\n    palette: {}\r\n});\r\n\r\nconst toastPosition: ToastPosition = 'bottom-right';\r\n\r\nAppService.loadConfiguration$().subscribe((result) => {\r\n    ReactDOM.render(\r\n        <StrictMode>\r\n            <CssBaseline />\r\n            <ToastContainer position={toastPosition} autoClose={2500} />\r\n            <ThemeProvider theme={theme}>\r\n                <DefaultLayout />\r\n            </ThemeProvider>\r\n        </StrictMode>,\r\n        document.getElementById('root')\r\n    );\r\n});\r\n"],"sourceRoot":""}